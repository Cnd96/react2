{"version":3,"file":"field-editor-reference.cjs.development.js","sources":["../src/components/LinkActions/redesignStyles.ts","../src/components/CreateEntryLinkButton/useGlobalMouseUp.ts","../src/components/CreateEntryLinkButton/CreateEntryMenuTrigger.tsx","../src/components/CreateEntryLinkButton/CreateEntryLinkButton.tsx","../src/components/LinkActions/styles.ts","../src/components/LinkActions/NoLinkPermissionsInfo.tsx","../src/components/LinkActions/LinkActions.tsx","../src/components/LinkActions/CombinedLinkActions.tsx","../src/components/MissingEntityCard/styles.ts","../src/components/MissingEntityCard/MissingEntityCard.tsx","../../../node_modules/regenerator-runtime/runtime.js","../src/components/LinkActions/helpers.ts","../src/components/LinkActions/LinkEntityActions.tsx","../src/components/ScheduledIconWithTooltip/formatDateAndTime.ts","../src/components/ScheduledIconWithTooltip/ScheduleTooltip.tsx","../src/components/ScheduledIconWithTooltip/ScheduledIconWithTooltip.tsx","../src/components/AssetThumbnail/AssetThumbnail.tsx","../src/common/EntityStore.ts","../src/common/ReferenceEditor.tsx","../src/common/useAccessApi.ts","../src/common/useContentTypePermissions.ts","../src/utils/fromFieldValidations.ts","../src/common/useEditorPermissions.ts","../src/common/SingleReferenceEditor.tsx","../src/entries/WrappedEntryCard/WrappedEntryCard.tsx","../src/entries/WrappedEntryCard/FetchingWrappedEntryCard.tsx","../src/entries/SingleEntryReferenceEditor.tsx","../src/common/MultipleReferenceEditor.tsx","../src/entries/SortableElements.tsx","../src/entries/MultipleEntryReferenceEditor.tsx","../src/assets/WrappedAssetCard/AssetCardActions.tsx","../src/assets/WrappedAssetCard/WrappedAssetCard.tsx","../src/assets/WrappedAssetCard/WrappedAssetLink.tsx","../src/assets/WrappedAssetCard/FetchingWrappedAssetCard.tsx","../src/assets/SingleMediaEditor.tsx","../src/assets/SortableElements.tsx","../src/assets/MultipleMediaEditor.tsx"],"sourcesContent":["import { css } from 'emotion';\nimport tokens from '@contentful/forma-36-tokens';\n\nexport const container = css({\n  display: 'flex',\n  border: `1px dashed ${tokens.gray500}`,\n  borderRadius: tokens.borderRadiusMedium,\n  justifyContent: 'center',\n  padding: tokens.spacingXl,\n});\n\nexport const action = css({\n  textDecoration: 'none',\n  fontWeight: 'bold',\n});\n\nexport const chevronIcon = css({\n  float: 'right',\n  marginLeft: tokens.spacingXs,\n  marginRight: -tokens.spacing2Xs,\n});\n","import { useEffect } from 'react';\n\nexport const useGlobalMouseUp = (handler: (this: Document, ev: MouseEvent) => unknown) => {\n  useEffect(() => {\n    document.addEventListener('mouseup', handler);\n    return () => document.removeEventListener('mouseup', handler);\n  }, [handler]);\n};\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport React, { useState, useRef, useCallback, useEffect } from 'react';\nimport { css } from 'emotion';\nimport get from 'lodash/get';\nimport tokens from '@contentful/forma-36-tokens';\nimport { ContentType } from '../../types';\nimport {\n  Dropdown,\n  DropdownList,\n  Icon,\n  DropdownListItem,\n  TextInput,\n} from '@contentful/forma-36-react-components';\nimport { useGlobalMouseUp } from './useGlobalMouseUp';\n\nconst MAX_ITEMS_WITHOUT_SEARCH = 20;\n\nconst styles = {\n  wrapper: css({\n    position: 'relative',\n  }),\n  searchInput: (parentHasDropdown: boolean) =>\n    css({\n      '& > input': {\n        borderColor: 'transparent',\n        borderRadius: parentHasDropdown ? 0 : undefined,\n        borderLeft: parentHasDropdown ? 'none' : undefined,\n        borderRight: parentHasDropdown ? 'none' : undefined,\n        paddingRight: tokens.spacing2Xl,\n        '::placeholder': {\n          color: tokens.gray600,\n        },\n      },\n    }),\n  searchIcon: css({\n    position: 'absolute',\n    right: tokens.spacingM,\n    top: tokens.spacingS,\n    zIndex: Number(tokens.zIndexDefault),\n    fill: tokens.gray600,\n  }),\n  separator: css({\n    background: tokens.gray200,\n    margin: '10px 0',\n  }),\n  dropdownList: css({\n    borderColor: tokens.gray200,\n  }),\n};\n\ntype CreateEntryMenuTriggerChildProps = {\n  isOpen: boolean;\n  isSelecting: boolean;\n  openMenu: Function;\n};\nexport type CreateEntryMenuTriggerChild = (\n  props: CreateEntryMenuTriggerChildProps\n) => React.ReactElement;\nexport type CreateCustomEntryMenuItems = ({\n  closeMenu,\n}: {\n  closeMenu: Function;\n}) => React.ReactElement;\n\ninterface CreateEntryMenuTrigger {\n  contentTypes: ContentType[];\n  suggestedContentTypeId?: string;\n  contentTypesLabel?: string;\n  onSelect: (contentTypeId: string) => Promise<unknown>;\n  testId?: string;\n  dropdownSettings?: {\n    isAutoalignmentEnabled?: boolean;\n    position: 'bottom-left' | 'bottom-right';\n  };\n  renderCustomDropdownItems?: CreateCustomEntryMenuItems;\n  children: CreateEntryMenuTriggerChild;\n}\n\nexport const CreateEntryMenuTrigger = ({\n  contentTypes,\n  suggestedContentTypeId,\n  contentTypesLabel,\n  onSelect,\n  testId,\n  dropdownSettings = {\n    position: 'bottom-left',\n  },\n  renderCustomDropdownItems,\n  children,\n}: CreateEntryMenuTrigger) => {\n  const [isOpen, setOpen] = useState(false);\n  const [isSelecting, setSelecting] = useState(false);\n  const [searchInput, setSearchInput] = useState('');\n  const wrapper = useRef<any | null>(null);\n  const textField = useRef<any | null>(null);\n  const dropdownRef = useRef<any | null>(null);\n  /*\n    By default, dropdown wraps it's content, so it's width = the width of the widest item\n    During search, menu items change, and so the widest menu item can change\n    This leads to menu always changing it's width\n    To prevent this, we get the width of the menu item after the first mount of a dropdown (when all the content is displayed)\n    And hardcode it through the class name. This way we ensure that even during search the menu will keep that max width\n    That it had on initial mount and that fits any menu item in has\n  */\n  const [dropdownWidth, setDropdownWidth] = useState(0);\n\n  const hasDropdown = contentTypes.length > 1 || !!renderCustomDropdownItems;\n\n  const closeMenu = () => setOpen(false);\n\n  useEffect(() => {\n    if (isOpen) {\n      setTimeout(() => {\n        textField?.current?.querySelector('input')?.focus();\n      }, 200);\n    }\n  }, [isOpen]);\n\n  const handleSelect = (item: ContentType) => {\n    closeMenu();\n    const res = onSelect(item.sys.id);\n\n    // TODO: Convert to controllable component.\n    if (res && typeof res.then === 'function') {\n      setSelecting(true);\n      res.then(\n        () => setSelecting(false),\n        () => setSelecting(false)\n      );\n    }\n  };\n\n  const toggleMenu = () => {\n    if (hasDropdown) {\n      setOpen(!isOpen);\n    } else {\n      handleSelect(contentTypes[0]);\n    }\n  };\n\n  const mouseUpHandler = useCallback(\n    (event) => {\n      if (\n        wrapper &&\n        wrapper.current &&\n        dropdownRef &&\n        dropdownRef.current &&\n        !wrapper.current.contains(event.target) &&\n        !dropdownRef.current.contains(event.target)\n      ) {\n        closeMenu();\n      }\n    },\n    [wrapper]\n  );\n\n  useGlobalMouseUp(mouseUpHandler);\n\n  useEffect(() => {\n    if (!isOpen) {\n      setSearchInput('');\n    }\n  }, [isOpen]);\n\n  const renderSearchResultsCount = (resultsLength: number) =>\n    resultsLength ? (\n      <DropdownListItem isTitle testId=\"add-entru-menu-search-results\">\n        {resultsLength} result{resultsLength > 1 ? 's' : ''}\n      </DropdownListItem>\n    ) : null;\n\n  const isSearchable = contentTypes.length > MAX_ITEMS_WITHOUT_SEARCH;\n  const maxDropdownHeight = suggestedContentTypeId ? 300 : 250;\n  const suggestedContentType = contentTypes.find((ct) => ct.sys.id === suggestedContentTypeId);\n  const filteredContentTypes = contentTypes.filter(\n    (ct) =>\n      !searchInput || get(ct, 'name', 'Untitled').toLowerCase().includes(searchInput.toLowerCase())\n  );\n\n  return (\n    <span className={styles.wrapper} ref={wrapper} data-test-id={testId}>\n      <Dropdown\n        focusContainerOnOpen={false}\n        position={dropdownSettings.position}\n        isAutoalignmentEnabled={dropdownSettings.isAutoalignmentEnabled}\n        isOpen={isOpen && hasDropdown}\n        toggleElement={children({ isOpen, isSelecting, openMenu: toggleMenu })}\n        testId=\"add-entry-menu\"\n        getContainerRef={(ref) => {\n          dropdownRef.current = ref;\n          if (!dropdownWidth && ref) {\n            setDropdownWidth(ref.clientWidth);\n          }\n        }}>\n        {renderCustomDropdownItems && (\n          <DropdownList className={styles.dropdownList} border=\"top\">\n            {renderCustomDropdownItems({ closeMenu })}\n          </DropdownList>\n        )}\n        {isSearchable && (\n          <div ref={textField} className={styles.wrapper}>\n            <TextInput\n              className={styles.searchInput(hasDropdown)}\n              placeholder=\"Search all content types\"\n              testId=\"add-entry-menu-search\"\n              value={searchInput}\n              onChange={(e) => setSearchInput(e.target.value)}\n            />\n            <Icon icon=\"Search\" className={styles.searchIcon} />\n          </div>\n        )}\n        <DropdownList\n          className={styles.dropdownList}\n          border=\"top\"\n          styles={{\n            width: dropdownWidth || '',\n            maxHeight: maxDropdownHeight,\n          }}\n          maxHeight={maxDropdownHeight}>\n          {searchInput && renderSearchResultsCount(filteredContentTypes.length)}\n          {suggestedContentType && !searchInput && (\n            <>\n              <DropdownListItem isTitle>Suggested Content Type</DropdownListItem>\n              <DropdownListItem\n                testId=\"suggested\"\n                onClick={() => handleSelect(suggestedContentType)}>\n                {get(suggestedContentType, 'name')}\n              </DropdownListItem>\n              <hr className={styles.separator} />\n            </>\n          )}\n          {!searchInput && <DropdownListItem isTitle>{contentTypesLabel}</DropdownListItem>}\n          {filteredContentTypes.length ? (\n            filteredContentTypes.map((contentType, i) => (\n              <DropdownListItem\n                testId=\"contentType\"\n                key={`${get(contentType, 'name')}-${i}`}\n                onClick={() => handleSelect(contentType)}>\n                {get(contentType, 'name', 'Untitled')}\n              </DropdownListItem>\n            ))\n          ) : (\n            <DropdownListItem testId=\"add-entru-menu-search-results\">\n              No results found\n            </DropdownListItem>\n          )}\n        </DropdownList>\n      </Dropdown>\n    </span>\n  );\n};\n\nCreateEntryMenuTrigger.defaultProps = {\n  testId: 'create-entry-button-menu-trigger',\n  contentTypesLabel: 'All Content Types',\n};\n","import React from 'react';\nimport get from 'lodash/get';\nimport { css } from 'emotion';\nimport { ContentType } from '../../types';\nimport { Button, Spinner } from '@contentful/forma-36-react-components';\nimport tokens from '@contentful/forma-36-tokens';\nimport { CreateEntryMenuTrigger, CreateCustomEntryMenuItems } from './CreateEntryMenuTrigger';\n\nconst standardStyles = {\n  spinnerMargin: css({\n    marginRight: tokens.spacingXs,\n  }),\n  action: undefined,\n};\nconst redesignStyles = {\n  ...standardStyles,\n  action: css({\n    textDecoration: 'none',\n    fontWeight: 'bold',\n  }),\n};\n\ninterface CreateEntryLinkButtonProps {\n  contentTypes: ContentType[];\n  suggestedContentTypeId?: string;\n  onSelect: (contentTypeId: string) => Promise<unknown>;\n  renderCustomDropdownItems?: CreateCustomEntryMenuItems;\n  disabled?: boolean;\n  hasPlusIcon?: boolean;\n  useExperimentalStyles?: boolean;\n  text?: string | React.ReactElement;\n  testId?: string;\n  dropdownSettings?: {\n    isAutoalignmentEnabled?: boolean;\n    position: 'bottom-left' | 'bottom-right';\n  };\n}\n\nexport const CreateEntryLinkButton = ({\n  contentTypes,\n  onSelect,\n  renderCustomDropdownItems,\n  text,\n  testId,\n  hasPlusIcon = false,\n  useExperimentalStyles,\n  suggestedContentTypeId,\n  dropdownSettings,\n  disabled = false,\n}: CreateEntryLinkButtonProps) => {\n  const suggestedContentType = contentTypes.find((ct) => ct.sys.id === suggestedContentTypeId);\n  const buttonText =\n    text ||\n    `Add ${get(\n      suggestedContentType || (contentTypes.length === 1 ? contentTypes[0] : {}),\n      'name',\n      'entry'\n    )}`;\n  const hasDropdown = contentTypes.length > 1 || renderCustomDropdownItems;\n\n  // TODO: Introduce `icon: string` and remove `hasPlusIcon` or remove \"Plus\" if we keep new layout.\n  const plusIcon = hasPlusIcon ? 'Plus' : undefined;\n  // TODO: Always use \"New content\" here if we fully switch to new layout.\n  const contentTypesLabel = useExperimentalStyles ? 'New content' : undefined;\n  const styles = useExperimentalStyles ? redesignStyles : standardStyles;\n\n  return (\n    <CreateEntryMenuTrigger\n      contentTypes={contentTypes}\n      suggestedContentTypeId={suggestedContentTypeId}\n      contentTypesLabel={contentTypesLabel}\n      onSelect={onSelect}\n      testId={testId}\n      dropdownSettings={dropdownSettings}\n      renderCustomDropdownItems={renderCustomDropdownItems}>\n      {({ openMenu, isSelecting }) => (\n        <>\n          {isSelecting && <Spinner size=\"small\" key=\"spinner\" className={styles.spinnerMargin} />}\n          <Button\n            buttonType=\"muted\"\n            onClick={() => {\n              openMenu();\n            }}\n            className={styles.action}\n            disabled={disabled || isSelecting || (contentTypes && contentTypes.length === 0)}\n            icon={isSelecting ? undefined : plusIcon}\n            indicateDropdown={Boolean(hasDropdown)}\n            size=\"small\"\n            testId=\"create-entry-link-button\">\n            {buttonText}\n          </Button>\n        </>\n      )}\n    </CreateEntryMenuTrigger>\n  );\n};\n","import { css } from 'emotion';\nimport tokens from '@contentful/forma-36-tokens';\n\nexport const container = css({\n  display: 'flex',\n  width: '100%',\n  marginTop: tokens.spacingS,\n});\n\nexport const separator = css({\n  marginRight: tokens.spacingXl,\n});\n","import React from 'react';\n\nimport { Paragraph } from '@contentful/forma-36-react-components';\n\nexport function NoLinkPermissionsInfo() {\n  return (\n    <Paragraph>\n      You don&apos;t have permission to view this content or this field is not correctly configured.\n      Contact your administrator for help.\n    </Paragraph>\n  );\n}\n","import * as React from 'react';\nimport { Button } from '@contentful/forma-36-react-components';\nimport * as styles from './styles';\nimport {\n  ContentEntityType,\n  ContentType,\n  ActionLabels,\n  Entry,\n  Asset,\n  NavigatorSlideInfo,\n} from '../../types';\nimport { CreateEntryLinkButton } from '../CreateEntryLinkButton/CreateEntryLinkButton';\nimport { NoLinkPermissionsInfo } from './NoLinkPermissionsInfo';\n\nexport interface LinkActionsProps {\n  entityType: ContentEntityType;\n  contentTypes: ContentType[];\n  canCreateEntity: boolean;\n  canLinkEntity: boolean;\n  canLinkMultiple: boolean;\n  isDisabled: boolean;\n  isFull: boolean;\n  isEmpty: boolean;\n  onCreate: (contentType?: string, index?: number) => Promise<unknown>;\n  onCreated: (entity: Entry | Asset, index?: number, slide?: NavigatorSlideInfo) => void;\n  onLinkExisting: (index?: number) => void;\n  onLinkedExisting: (entities: Array<Entry | Asset>, index?: number) => void;\n  actionLabels?: Partial<ActionLabels>;\n  combinedActionsLabel?: string | React.ReactElement;\n  itemsLength?: number;\n}\n\nconst defaultEntryLabels: ActionLabels = {\n  createNew: (props) =>\n    props?.contentType ? `Create new ${props.contentType} and link` : 'Create new entry and link',\n  linkExisting: (props) =>\n    props?.canLinkMultiple ? 'Link existing entries' : 'Link existing entry',\n};\n\nconst defaultAssetLabels: ActionLabels = {\n  createNew: () => `Create new asset and link`,\n  linkExisting: (props) =>\n    props?.canLinkMultiple ? 'Link existing assets' : 'Link existing asset',\n};\n\nexport const testIds = {\n  dropdown: 'linkEditor.dropdown',\n  createAndLink: 'linkEditor.createAndLink',\n  createAndLinkWrapper: 'create-entry-button-menu-trigger',\n  linkExisting: 'linkEditor.linkExisting',\n};\n\nexport function LinkActions(props: LinkActionsProps) {\n  if (props.isFull) {\n    return null; // Don't render link actions if we reached max allowed links.\n  }\n  const defaultLabels = props.entityType === 'Entry' ? defaultEntryLabels : defaultAssetLabels;\n  const labels = {\n    ...defaultLabels,\n    ...props.actionLabels,\n  };\n\n  return (\n    <div className={styles.container}>\n      {props.canCreateEntity && (\n        <>\n          {props.entityType === 'Entry' && (\n            <CreateEntryLinkButton\n              testId={testIds.createAndLink}\n              disabled={props.isDisabled}\n              text={labels.createNew({\n                contentType:\n                  props.contentTypes.length === 1 ? props.contentTypes[0].name : undefined,\n              })}\n              contentTypes={props.contentTypes}\n              hasPlusIcon={true}\n              onSelect={(contentTypeId) => {\n                return contentTypeId\n                  ? props.onCreate(contentTypeId, props.itemsLength)\n                  : Promise.resolve();\n              }}\n            />\n          )}\n          {props.entityType === 'Asset' && (\n            <Button\n              disabled={props.isDisabled}\n              testId={testIds.createAndLink}\n              onClick={() => {\n                props.onCreate(undefined, props.itemsLength);\n              }}\n              buttonType=\"muted\"\n              icon=\"Plus\"\n              size=\"small\">\n              {labels.createNew()}\n            </Button>\n          )}\n          <span className={styles.separator} />\n        </>\n      )}\n      {props.canLinkEntity && (\n        <Button\n          disabled={props.isDisabled}\n          testId={testIds.linkExisting}\n          onClick={() => {\n            props.onLinkExisting();\n          }}\n          buttonType=\"muted\"\n          icon=\"Link\"\n          size=\"small\">\n          {labels.linkExisting({ canLinkMultiple: props.canLinkMultiple })}\n        </Button>\n      )}\n\n      {!props.canCreateEntity && !props.canLinkEntity && <NoLinkPermissionsInfo />}\n    </div>\n  );\n}\n","import * as React from 'react';\nimport {\n  Button,\n  Dropdown,\n  DropdownList,\n  DropdownListItem,\n} from '@contentful/forma-36-react-components';\nimport * as styles from './redesignStyles';\nimport { CreateEntryLinkButton } from '../CreateEntryLinkButton/CreateEntryLinkButton';\nimport { testIds as sharedTextIds, LinkActionsProps } from './LinkActions';\nimport { NoLinkPermissionsInfo } from './NoLinkPermissionsInfo';\n\nconst testIds = {\n  ...sharedTextIds,\n  actionsWrapper: 'link-actions-menu-trigger',\n};\n\n/**\n * Alternative, experimental alternative to <LinkActions /> that is planned to\n * replace the current default LinkActions in reference and media editors.\n *\n * Places both actions to create and link new, as well as link existing, behind\n * one action dropdown and introduces new copy for action labels.\n */\nexport function CombinedLinkActions(props: LinkActionsProps) {\n  if (props.isFull) {\n    return null; // Don't render link actions if we reached max allowed links.\n  }\n  // We don't want to render a spacious container in case there are are already\n  // assets linked (in case of entries, always show it) as the border wouldn't be\n  // nicely aligned with asset cards.\n  const hideEmptyCard = props.entityType === 'Asset' && !props.isEmpty;\n  return (\n    <div className={hideEmptyCard ? '' : styles.container}>\n      {!props.canCreateEntity && !props.canLinkEntity && <NoLinkPermissionsInfo />}\n      {props.entityType === 'Entry' && <CombinedEntryLinkActions {...props} />}\n      {props.entityType === 'Asset' && <CombinedAssetLinkActions {...props} />}\n    </div>\n  );\n}\n\nfunction CombinedEntryLinkActions(props: LinkActionsProps) {\n  if (props.canCreateEntity) {\n    return (\n      <CreateEntryLinkButton\n        testId={testIds.actionsWrapper}\n        disabled={props.isDisabled}\n        text={props.combinedActionsLabel || 'Add content'}\n        contentTypes={props.contentTypes}\n        hasPlusIcon={true}\n        useExperimentalStyles={true}\n        dropdownSettings={{\n          position: 'bottom-left',\n        }}\n        onSelect={(contentTypeId) => {\n          return contentTypeId ? props.onCreate(contentTypeId) : Promise.resolve();\n        }}\n        renderCustomDropdownItems={\n          props.canLinkEntity\n            ? ({ closeMenu }) => (\n                <DropdownListItem\n                  testId={testIds.linkExisting}\n                  onClick={() => {\n                    closeMenu();\n                    props.onLinkExisting();\n                  }}>\n                  Add existing content\n                </DropdownListItem>\n              )\n            : undefined\n        }\n      />\n    );\n  } else if (props.canLinkEntity) {\n    return (\n      <Button\n        disabled={props.isDisabled}\n        testId={testIds.linkExisting}\n        className={styles.action}\n        onClick={() => {\n          props.onLinkExisting();\n        }}\n        buttonType=\"muted\"\n        icon=\"Link\"\n        size=\"small\">\n        Add existing content\n      </Button>\n    );\n  }\n  return null;\n}\n\nfunction CombinedAssetLinkActions(props: LinkActionsProps) {\n  const [isOpen, setOpen] = React.useState(false);\n\n  if (!props.canLinkEntity || !props.canCreateEntity) {\n    if (props.canLinkEntity) {\n      return (\n        <Button\n          disabled={props.isDisabled}\n          testId={testIds.linkExisting}\n          className={styles.action}\n          onClick={() => {\n            props.onLinkExisting();\n          }}\n          buttonType=\"muted\"\n          icon=\"Plus\"\n          size=\"small\">\n          Add existing media\n        </Button>\n      );\n    }\n    if (props.canCreateEntity) {\n      return (\n        <Button\n          disabled={props.isDisabled}\n          testId={testIds.createAndLink}\n          className={styles.action}\n          onClick={() => {\n            props.onCreate();\n          }}\n          buttonType=\"muted\"\n          icon=\"Plus\"\n          size=\"small\">\n          Add media\n        </Button>\n      );\n    }\n    return null;\n  }\n\n  // TODO: If we fully switch to this new layout, make a more generic `CreateEntityLinkButton`\n  //  that works without content types to cover asset use-case.\n  return (\n    <Dropdown\n      isOpen={isOpen}\n      onClose={() => setOpen(false)}\n      toggleElement={\n        <>\n          <Button\n            disabled={props.isDisabled}\n            testId={testIds.actionsWrapper}\n            className={styles.action}\n            onClick={() => {\n              setOpen(!isOpen);\n            }}\n            buttonType=\"muted\"\n            icon=\"Plus\"\n            indicateDropdown\n            size=\"small\">\n            Add media\n          </Button>\n        </>\n      }>\n      <DropdownList testId={testIds.dropdown}>\n        <DropdownListItem\n          testId={testIds.linkExisting}\n          onClick={() => {\n            setOpen(false);\n            props.onLinkExisting();\n          }}>\n          Add existing media\n        </DropdownListItem>\n        <DropdownListItem\n          testId={testIds.createAndLink}\n          onClick={() => {\n            setOpen(false);\n            props.onCreate();\n          }}>\n          Add new media\n        </DropdownListItem>\n      </DropdownList>\n    </Dropdown>\n  );\n}\n","import { css } from 'emotion';\nimport tokens from '@contentful/forma-36-tokens';\n\nexport const card = css({\n  position: 'relative'\n});\n\nexport const squareCard = css({\n  display: 'flex',\n  alignItems: 'center',\n  width: '135px',\n  height: '160px',\n  textAlign: 'center'\n});\n\nexport const close = css({\n  position: 'absolute',\n  top: tokens.spacingS,\n  right: tokens.spacingS\n});\n","import React from 'react';\nimport { Card, SectionHeading, IconButton } from '@contentful/forma-36-react-components';\nimport { ContentEntityType } from '../../types';\nimport * as styles from './styles';\n\nexport function MissingEntityCard(props: {\n  entityType: ContentEntityType;\n  asSquare?: boolean;\n  isDisabled: boolean;\n  onRemove?: Function;\n}) {\n  return (\n    <Card className={styles.card}>\n      <div className={props.asSquare ? styles.squareCard : ''}>\n        <SectionHeading>\n          {props.entityType === 'Entry' && 'Entry is missing or inaccessible'}\n          {props.entityType === 'Asset' && 'Asset is missing or inaccessible'}\n        </SectionHeading>\n      </div>\n      {!props.isDisabled && props.onRemove && (\n        <IconButton\n          className={styles.close}\n          buttonType=\"muted\"\n          label=\"Delete\"\n          iconProps={{ icon: 'Close' }}\n          onClick={() => {\n            props.onRemove && props.onRemove();\n          }}\n        />\n      )}\n    </Card>\n  );\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","import { Asset, ContentType, ContentEntityType, Entry, FieldExtensionSDK } from '../../types';\nimport { EditorPermissions } from '../../common/useEditorPermissions';\n\nconst getContentTypeIds = (contentTypes: ContentType[]) => contentTypes.map((ct) => ct.sys.id);\n\nexport async function createEntity(props: {\n  sdk: FieldExtensionSDK;\n  entityType: ContentEntityType;\n  contentTypeId?: string;\n}) {\n  if (props.entityType === 'Entry') {\n    if (!props.contentTypeId) {\n      return {};\n    }\n    const { entity, slide } = await props.sdk.navigator.openNewEntry<Entry>(props.contentTypeId, {\n      slideIn: true,\n    });\n    return { entity, slide };\n  } else {\n    const { entity, slide } = await props.sdk.navigator.openNewAsset({\n      slideIn: true,\n    });\n    return { entity, slide };\n  }\n}\n\nexport async function selectSingleEntity(props: {\n  sdk: FieldExtensionSDK;\n  entityType: ContentEntityType;\n  editorPermissions: EditorPermissions;\n}) {\n  if (props.entityType === 'Entry') {\n    return await props.sdk.dialogs.selectSingleEntry<Entry>({\n      locale: props.sdk.field.locale,\n      contentTypes: getContentTypeIds(props.editorPermissions.readableContentTypes),\n    });\n  } else {\n    return props.sdk.dialogs.selectSingleAsset<Asset>({\n      locale: props.sdk.field.locale,\n      mimetypeGroups: props.editorPermissions.validations.mimetypeGroups,\n    });\n  }\n}\n\nexport async function selectMultipleEntities(props: {\n  sdk: FieldExtensionSDK;\n  entityType: ContentEntityType;\n  editorPermissions: EditorPermissions;\n}) {\n  const value = props.sdk.field.getValue();\n\n  const linkCount = Array.isArray(value) ? value.length : value ? 1 : 0;\n\n  // TODO: Why not always set `min: 1` by default? Does it make sense to enforce\n  //  user to select as many entities as the field's \"min\" requires? What if e.g.\n  // \"min\" is 4 and the user wants to insert 2 entities first, then create 2 new ones?\n  const min = Math.max(\n    (props.editorPermissions.validations.numberOfLinks?.min || 1) - linkCount,\n    1\n  );\n  // TODO: Consider same for max. If e.g. \"max\" is 4, we disable the button if the\n  //  user wants to select 5 but we show no information why the button is disabled.\n  const max = (props.editorPermissions.validations.numberOfLinks?.max || +Infinity) - linkCount;\n\n  if (props.entityType === 'Entry') {\n    return await props.sdk.dialogs.selectMultipleEntries<Entry>({\n      locale: props.sdk.field.locale,\n      contentTypes: getContentTypeIds(props.editorPermissions.readableContentTypes),\n      min,\n      max,\n    });\n  } else {\n    return props.sdk.dialogs.selectMultipleAssets<Asset>({\n      locale: props.sdk.field.locale,\n      mimetypeGroups: props.editorPermissions.validations.mimetypeGroups,\n      min,\n      max,\n    });\n  }\n}\n","import * as React from 'react';\nimport { useMemo } from 'react';\nimport {\n  Action,\n  ActionLabels,\n  ContentEntityType,\n  FieldExtensionSDK,\n  Entry,\n  Asset,\n  NavigatorSlideInfo,\n} from '../../types';\nimport { LinkActions, LinkActionsProps } from './LinkActions';\nimport { createEntity, selectMultipleEntities, selectSingleEntity } from './helpers';\nimport { EditorPermissions } from '../../common/useEditorPermissions';\n\ntype LinkEntityActionsProps = {\n  entityType: ContentEntityType;\n  canLinkMultiple: boolean;\n  sdk: FieldExtensionSDK;\n  isDisabled: boolean;\n  editorPermissions: EditorPermissions;\n  onCreate: (id: string, index?: number) => void;\n  onLink: (ids: string[], index?: number) => void;\n  onAction?: (action: Action) => void;\n  actionLabels?: Partial<ActionLabels>;\n  itemsLength?: number;\n};\n\nexport function useLinkActionsProps(props: LinkEntityActionsProps): LinkActionsProps {\n  const {\n    sdk,\n    editorPermissions,\n    entityType,\n    canLinkMultiple,\n    isDisabled,\n    actionLabels,\n    itemsLength,\n  } = props;\n\n  const maxLinksCount = editorPermissions.validations.numberOfLinks?.max;\n  const value = sdk.field.getValue();\n  const linkCount = Array.isArray(value) ? value.length : value ? 1 : 0;\n  const isFull = !!maxLinksCount && maxLinksCount <= linkCount;\n  const isEmpty = linkCount === 0;\n\n  const onCreated = React.useCallback(\n    (entity: Entry | Asset, index = itemsLength, slide?: NavigatorSlideInfo) => {\n      props.onCreate(entity.sys.id, index);\n      props.onAction &&\n        props.onAction({\n          type: 'create_and_link',\n          entity: entityType,\n          entityData: entity,\n          slide,\n          index,\n        });\n    },\n    [entityType, props.onCreate, props.onAction]\n  );\n  const onLinkedExisting = React.useCallback(\n    (entities: Array<Entry | Asset>, index = itemsLength) => {\n      props.onLink(\n        entities.map((item) => item.sys.id),\n        index\n      );\n      entities.forEach((entity, i) => {\n        props.onAction &&\n          props.onAction({\n            type: 'select_and_link',\n            entity: entityType,\n            entityData: entity,\n            index: index === undefined ? undefined : index + i,\n          });\n      });\n    },\n    [entityType, props.onLink, props.onAction]\n  );\n\n  const onCreate = React.useCallback(\n    async (contentTypeId?: string, index?: number) => {\n      const { entity, slide } = await createEntity({ sdk, entityType, contentTypeId });\n      if (!entity) {\n        return;\n      }\n\n      onCreated(entity, index, slide);\n    },\n    [sdk, entityType, onCreated]\n  );\n\n  const onLinkExisting = React.useCallback(\n    async (index?: number) => {\n      const entity = await selectSingleEntity({\n        sdk,\n        entityType,\n        editorPermissions,\n      });\n      if (!entity) {\n        return;\n      }\n\n      onLinkedExisting([entity], index);\n    },\n    [sdk, entityType, onLinkedExisting]\n  );\n\n  const onLinkSeveralExisting = React.useCallback(\n    async (index?: number) => {\n      const entities = await selectMultipleEntities({\n        sdk,\n        entityType,\n        editorPermissions,\n      });\n\n      if (!entities || entities.length === 0) {\n        return;\n      }\n      onLinkedExisting(entities, index);\n    },\n    [sdk, entityType, onLinkedExisting]\n  );\n\n  return useMemo(\n    () => ({\n      entityType,\n      canLinkMultiple,\n      isDisabled,\n      isEmpty,\n      isFull,\n      canCreateEntity: editorPermissions.canCreateEntity,\n      canLinkEntity: editorPermissions.canLinkEntity,\n      contentTypes: editorPermissions.creatableContentTypes,\n      onCreate,\n      onLinkExisting: canLinkMultiple ? onLinkSeveralExisting : onLinkExisting,\n      actionLabels,\n      onCreated,\n      onLinkedExisting,\n      itemsLength,\n    }),\n    [\n      entityType,\n      canLinkMultiple,\n      isDisabled,\n      isEmpty,\n      isFull,\n      editorPermissions.canCreateEntity,\n      editorPermissions.canLinkEntity,\n      actionLabels,\n      editorPermissions.creatableContentTypes.map((ct) => ct.sys.id).join(':'),\n      onCreate,\n      onLinkExisting,\n      onLinkSeveralExisting,\n      onCreated,\n      onLinkedExisting,\n      itemsLength,\n    ]\n  );\n}\n\nexport function LinkEntityActions({\n  renderCustomActions,\n  ...props\n}: LinkActionsProps & {\n  renderCustomActions?: (props: LinkActionsProps) => React.ReactElement;\n}) {\n  const renderLinkActions = renderCustomActions\n    ? renderCustomActions\n    : (props: LinkActionsProps) => <LinkActions {...props} />;\n\n  return renderLinkActions(props);\n}\n","// eslint-disable-next-line no-restricted-imports\nimport moment from 'moment';\n\ntype DateFormatFn = (date: Date | string, short?: boolean) => string;\n\n/**\n * @param {Date|string} date A valid constructor argument for moment()\n * @param {boolean=} short Render only Today/Tomorrow/Yesterday if valid. Defaults to false\n */\nexport const formatDate: DateFormatFn = (date, short) => {\n  switch (\n    moment()\n      .startOf('day')\n      .diff(moment(date).startOf('day'), 'days')\n  ) {\n    case 0:\n      return short ? 'Today' : `Today, ${moment(date).format('DD MMM YYYY')}`;\n    case -1:\n      return short ? 'Tomorrow' : `Tomorrow, ${moment(date).format('DD MMM YYYY')}`;\n    case 1:\n      return short ? 'Yesterday' : `Yesterday, ${moment(date).format('DD MMM YYYY')}`;\n    default:\n      return moment(date).format('ddd, DD MMM YYYY');\n  }\n};\n\n/**\n * Returns the time portion of a date in the local time in the format H:MM AM/PM\n *\n * == Examples\n * * `T15:36:45.000Z` => 3:36 PM (if in +0:00 offset)\n */\nexport const formatTime: DateFormatFn = date => {\n  return moment\n    .utc(date)\n    .local()\n    .format('h:mm A');\n};\n\nexport const formatDateAndTime: DateFormatFn = (date, short) => {\n  return `${formatDate(date, short)} at ${formatTime(date)}`;\n};\n","import React from 'react';\nimport { ScheduledAction } from '@contentful/app-sdk';\nimport { css, cx } from 'emotion';\nimport { Tag, Tooltip, Paragraph } from '@contentful/forma-36-react-components';\nimport tokens from '@contentful/forma-36-tokens';\nimport { formatDateAndTime } from './formatDateAndTime';\n\nconst styles = {\n  // @ts-expect-error\n  statusTag: css({\n    marginLeft: tokens.spacingM,\n    zIndex: '0 !important',\n  }),\n  positiveColor: css({\n    color: tokens.colorPositive,\n  }),\n  secondaryColor: css({\n    color: tokens.gray500,\n  }),\n  marginRightXS: css({\n    marginRight: tokens.spacing2Xs,\n  }),\n  paragraph: css({\n    textAlign: 'center',\n    color: tokens.gray500,\n  }),\n  time: css({\n    color: tokens.gray200,\n  }),\n};\n\nexport const ScheduleTooltipContent = ({\n  job,\n  jobsCount,\n}: {\n  job: ScheduledAction;\n  jobsCount: number;\n}) => {\n  let colorPalette = '';\n  switch (job.action.toLowerCase()) {\n    case 'publish':\n      colorPalette = styles.positiveColor;\n      break;\n    case 'unpublish':\n      colorPalette = styles.secondaryColor;\n      break;\n    default:\n      colorPalette = styles.secondaryColor;\n  }\n\n  return (\n    <>\n      <span className={styles.time} data-test-id=\"cf-scheduled-time-tootlip-content\">\n        {formatDateAndTime(job.scheduledFor.datetime)}\n      </span>\n      <Tag\n        tagType={job.action === 'publish' ? 'positive' : 'secondary'}\n        testId=\"scheduled-publish-trigger\"\n        className={cx(styles.statusTag, colorPalette)}>\n        {job.action.toUpperCase()}\n      </Tag>\n      {jobsCount > 1 && <Paragraph className={styles.paragraph}>+ {jobsCount - 1} more</Paragraph>}\n    </>\n  );\n};\n\nexport const ScheduleTooltip = ({\n  job,\n  jobsCount,\n  children,\n}: {\n  job: ScheduledAction;\n  jobsCount: number;\n  children: React.ReactElement;\n}) => {\n  return (\n    <Tooltip\n      place=\"top\"\n      testId={job.sys.id}\n      containerElement=\"div\"\n      content={<ScheduleTooltipContent job={job} jobsCount={jobsCount} />}>\n      {children}\n    </Tooltip>\n  );\n};\n","import React from 'react';\nimport { SpaceAPI, ScheduledAction } from '@contentful/app-sdk';\nimport { ScheduleTooltip } from './ScheduleTooltip';\n\ntype ScheduledIconWithTooltipProps = {\n  getEntityScheduledActions: SpaceAPI['getEntityScheduledActions'];\n  entityType: 'Entry' | 'Asset';\n  entityId: string;\n  children: React.ReactElement;\n};\n\nexport const ScheduledIconWithTooltip = ({\n  entityType,\n  entityId,\n  getEntityScheduledActions,\n  children,\n}: ScheduledIconWithTooltipProps) => {\n  const [status, setStatus] = React.useState<\n    | { type: 'loading' }\n    | { type: 'error'; error: Error }\n    | { type: 'loaded'; jobs: ScheduledAction[] }\n  >({ type: 'loading' });\n\n  React.useEffect(() => {\n    getEntityScheduledActions(entityType, entityId)\n      .then((data) => {\n        setStatus({ type: 'loaded', jobs: data });\n      })\n      .catch((e) => {\n        setStatus({ type: 'error', error: e });\n      });\n  }, []);\n\n  if (status.type === 'loading' || status.type === 'error') {\n    return null;\n  }\n\n  const jobs = status.jobs ? status.jobs : [];\n\n  if (jobs.length === 0) {\n    return null;\n  }\n\n  const mostRelevantJob = jobs[0];\n\n  return (\n    <ScheduleTooltip job={mostRelevantJob} jobsCount={jobs.length}>\n      {children}\n    </ScheduleTooltip>\n  );\n};\n","import React from 'react';\nimport { File } from '../../types';\n\ninterface AssetThumbnailProps {\n  file: File;\n}\n\nconst dimensions = { width: 70, height: 70 };\n\nexport function AssetThumbnail(props: AssetThumbnailProps) {\n  return (\n    <img\n      alt={props.file.fileName}\n      src={`${props.file.url}?w=${dimensions.width}&h=${dimensions.height}&fit=thumb`}\n      height={dimensions.height}\n      width={dimensions.width}\n    />\n  );\n}\n","import * as React from 'react';\nimport { BaseExtensionSDK, Entry, Asset, ScheduledAction } from '../types';\nimport constate from 'constate';\n\ntype EntriesMap = {\n  [key: string]: 'failed' | undefined | Entry;\n};\n\ntype AssetsMap = {\n  [key: string]: 'failed' | undefined | Asset;\n};\n\ntype ScheduledActionsMap = {\n  [key: string]: ScheduledAction[];\n};\n\ntype State = {\n  entries: EntriesMap;\n  assets: AssetsMap;\n  scheduledActions: ScheduledActionsMap;\n};\n\ntype DispatchAction =\n  | { type: 'set_entry'; id: string; entry: Entry }\n  | { type: 'set_entry_failed'; id: string }\n  | { type: 'set_asset'; id: string; asset: Asset }\n  | { type: 'set_asset_failed'; id: string }\n  | {\n      type: 'set_scheduled_actions';\n      key: string;\n      actions: ScheduledAction[] | undefined;\n    };\n\nfunction reducer(state: State, action: DispatchAction): State {\n  switch (action.type) {\n    case 'set_entry':\n      return {\n        ...state,\n        entries: {\n          ...state.entries,\n          [action.id]: action.entry,\n        },\n      };\n    case 'set_entry_failed':\n      return {\n        ...state,\n        entries: {\n          ...state.entries,\n          [action.id]: 'failed',\n        },\n      };\n    case 'set_asset':\n      return {\n        ...state,\n        assets: {\n          ...state.assets,\n          [action.id]: action.asset,\n        },\n      };\n    case 'set_asset_failed':\n      return {\n        ...state,\n        assets: {\n          ...state.assets,\n          [action.id]: 'failed',\n        },\n      };\n    default:\n      return state;\n  }\n}\n\nconst initialState: State = {\n  entries: {},\n  assets: {},\n  scheduledActions: {},\n};\n\nfunction useEntitiesStore(props: { sdk: BaseExtensionSDK }) {\n  const [state, dispatch] = React.useReducer(reducer, initialState);\n\n  const loadEntityScheduledActions = React.useCallback(\n    (entityType: 'Entry' | 'Asset', id: string) => {\n      const key = `${entityType}:${id}`;\n      if (state.scheduledActions[key]) {\n        return Promise.resolve(state.scheduledActions[key]);\n      }\n      return props.sdk.space\n        .getEntityScheduledActions(entityType, id)\n        .then((data) => {\n          dispatch({ type: 'set_scheduled_actions', key, actions: data });\n          return data;\n        })\n        .catch(() => {\n          dispatch({ type: 'set_scheduled_actions', key, actions: undefined });\n          return [];\n        });\n    },\n    [props.sdk.space, state.scheduledActions]\n  );\n\n  const loadEntry = React.useCallback(\n    (id: string) => {\n      return props.sdk.space\n        .getEntry<Entry>(id)\n        .then((entry) => {\n          dispatch({ type: 'set_entry', id, entry });\n          return entry;\n        })\n        .catch(() => {\n          dispatch({ type: 'set_entry_failed', id });\n        });\n    },\n    [props.sdk.space]\n  );\n\n  const loadAsset = React.useCallback(\n    (id: string) => {\n      return props.sdk.space\n        .getAsset(id)\n        .then((asset) => {\n          dispatch({ type: 'set_asset', id, asset });\n          return asset;\n        })\n        .catch(() => {\n          dispatch({ type: 'set_asset_failed', id });\n        });\n    },\n    [props.sdk.space]\n  );\n\n  const getOrLoadAsset = React.useCallback(\n    (id: string) => {\n      if (state.assets[id] && state.assets[id] !== 'failed') {\n        return Promise.resolve(state.assets[id]);\n      }\n      return loadAsset(id);\n    },\n    [state.assets, loadAsset]\n  );\n\n  const getOrLoadEntry = React.useCallback(\n    (id: string) => {\n      if (state.entries[id] && state.entries[id] !== 'failed') {\n        return Promise.resolve(state.entries[id]);\n      }\n      return loadEntry(id);\n    },\n    [state.entries, loadEntry]\n  );\n\n  React.useEffect(() => {\n    // @ts-expect-error\n    if (typeof props.sdk.space.onEntityChanged !== 'undefined') {\n      // @ts-expect-error\n      const onEntityChanged = props.sdk.space.onEntityChanged;\n      const listeners: Function[] = [];\n      Object.keys(state.entries).forEach((id) => {\n        if (state.entries[id] && state.entries['id'] !== 'failed') {\n          listeners.push(\n            onEntityChanged('Entry', id, (entry: Entry) =>\n              dispatch({ type: 'set_entry', id, entry })\n            )\n          );\n        }\n      });\n      Object.keys(state.assets).forEach((id) => {\n        if (state.assets[id] && state.assets['id'] !== 'failed') {\n          listeners.push(\n            onEntityChanged('Asset', id, (asset: Asset) =>\n              dispatch({ type: 'set_asset', id, asset })\n            )\n          );\n        }\n      });\n\n      return () => listeners.forEach((off) => off());\n    }\n\n    return props.sdk.navigator.onSlideInNavigation(({ oldSlideLevel, newSlideLevel }) => {\n      if (oldSlideLevel > newSlideLevel) {\n        Object.keys(state.entries).map((id) => {\n          if (state.entries[id] && state.entries[id] !== 'failed') {\n            loadEntry(id);\n          }\n        });\n        Object.keys(state.assets).map((id) => {\n          if (state.assets[id] && state.assets[id] !== 'failed') {\n            loadAsset(id);\n          }\n        });\n      }\n    }) as { (): void };\n  }, [props.sdk, state.assets, state.entries]);\n\n  return { getOrLoadEntry, getOrLoadAsset, loadEntityScheduledActions, ...state };\n}\n\nconst [EntityProvider, useEntities] = constate(useEntitiesStore);\n\nexport { EntityProvider, useEntities };\n","import * as React from 'react';\nimport deepEqual from 'deep-equal';\nimport { FieldConnector } from '@contentful/field-editor-shared';\nimport { EntityProvider } from './EntityStore';\nimport { Action, ActionLabels, FieldExtensionSDK, ViewType } from '../types';\nimport type { LinkActionsProps } from '../components';\nimport { CustomCardRenderer, RenderCustomMissingEntityCard } from './customCardTypes';\n\n// TODO: Rename common base for reference/media editors to something neutral,\n//  e.g. `LinkEditor<T>`.\n\nexport interface ReferenceEditorProps {\n  /**\n   * Whether or not the field should be disabled initially.\n   */\n  isInitiallyDisabled: boolean;\n  hasCardEditActions: boolean;\n  sdk: FieldExtensionSDK;\n  viewType: ViewType;\n  renderCustomCard?: CustomCardRenderer;\n  renderCustomActions?: (props: CustomActionProps) => React.ReactElement;\n  renderCustomMissingEntityCard?: RenderCustomMissingEntityCard;\n  getEntityUrl?: (entryId: string) => string;\n  onAction?: (action: Action) => void;\n  actionLabels?: Partial<ActionLabels>;\n  parameters: {\n    instance: {\n      showCreateEntityAction?: boolean;\n      showLinkEntityAction?: boolean;\n      bulkEditing?: boolean;\n    };\n  };\n}\n\nexport type CustomActionProps = LinkActionsProps;\n\nexport function ReferenceEditor<T>(\n  props: ReferenceEditorProps & {\n    children: FieldConnector<T>['props']['children'];\n  }\n) {\n  return (\n    <EntityProvider sdk={props.sdk}>\n      <FieldConnector<T>\n        throttle={0}\n        field={props.sdk.field}\n        isInitiallyDisabled={props.isInitiallyDisabled}\n        isEqualValues={(value1, value2) => {\n          return deepEqual(value1, value2);\n        }}>\n        {props.children}\n      </FieldConnector>\n    </EntityProvider>\n  );\n}\n\nReferenceEditor.defaultProps = {\n  isInitiallyDisabled: true,\n  hasCardEditActions: true,\n};\n","import type {\n  AccessAPI,\n  ArchiveableAction,\n  CrudAction,\n  PublishableAction,\n} from '@contentful/app-sdk';\n\ntype EntryAction = CrudAction | PublishableAction | ArchiveableAction;\n\ntype ExtendedAccessAPI = {\n  canPerformActionOnEntryOfType: (action: EntryAction, contentTypeId: string) => Promise<boolean>;\n};\n\nconst AllowActionsOnContentType: ExtendedAccessAPI['canPerformActionOnEntryOfType'] = () =>\n  Promise.resolve(true);\n\nexport function useAccessApi(accessApi: AccessAPI & Partial<ExtendedAccessAPI>) {\n  const canPerformAction = accessApi.can;\n  const canPerformActionOnEntryOfType =\n    accessApi.canPerformActionOnEntryOfType ?? AllowActionsOnContentType;\n\n  return { canPerformAction, canPerformActionOnEntryOfType };\n}\n","import { ContentType, ContentEntityType, FieldExtensionSDK } from '../types';\nimport { ReferenceEditorProps } from './ReferenceEditor';\nimport { useEffect, useMemo, useState } from 'react';\nimport { useAccessApi } from './useAccessApi';\nimport { ReferenceValidations } from '../utils/fromFieldValidations';\n\ntype ContentTypePermissionsProps = {\n  sdk: FieldExtensionSDK;\n  entityType: ContentEntityType;\n  parameters: ReferenceEditorProps['parameters'];\n  allContentTypes: ContentType[];\n  validations: ReferenceValidations;\n};\n\ntype ContentTypePermissions = {\n  creatableContentTypes: ContentType[];\n  readableContentTypes: ContentType[];\n  availableContentTypes: ContentType[];\n};\n\nasync function filter<T, S extends T>(arr: T[], predicate: (value: T) => Promise<boolean>) {\n  // intentionally parallel as we assume it's cached in the implementation of the access api\n  const fail = Symbol();\n  const results = await Promise.all(\n    arr.map(async (item) => ((await predicate(item)) ? item : fail))\n  );\n\n  return results.filter((x) => x !== fail) as S[];\n}\n\nexport function useContentTypePermissions(\n  props: ContentTypePermissionsProps\n): ContentTypePermissions {\n  const availableContentTypes = useMemo(() => {\n    if (props.entityType === 'Asset') {\n      return [];\n    }\n\n    if (props.validations.contentTypes) {\n      return props.allContentTypes.filter((ct) =>\n        props.validations.contentTypes?.includes(ct.sys.id)\n      );\n    }\n\n    return props.allContentTypes;\n  }, [props.allContentTypes, props.validations.contentTypes, props.entityType]);\n  const [creatableContentTypes, setCreatableContentTypes] = useState(availableContentTypes);\n  const [readableContentTypes, setReadableContentTypes] = useState(availableContentTypes);\n  const { canPerformActionOnEntryOfType } = useAccessApi(props.sdk.access);\n\n  useEffect(() => {\n    function getContentTypes(action: 'create' | 'read') {\n      return filter(availableContentTypes, (ct) =>\n        canPerformActionOnEntryOfType(action, ct.sys.id)\n      );\n    }\n\n    async function checkContentTypeAccess() {\n      const creatable = await getContentTypes('create');\n      const readable = await getContentTypes('read');\n      setCreatableContentTypes(creatable);\n      setReadableContentTypes(readable);\n    }\n\n    void checkContentTypeAccess();\n  }, [availableContentTypes]);\n\n  return {\n    creatableContentTypes,\n    readableContentTypes,\n    availableContentTypes,\n  };\n}\n","import isNumber from 'lodash/isNumber';\nimport { FieldAPI } from '@contentful/app-sdk';\n\ntype NumberOfLinksValidation =\n  | { type: 'min-max'; min: number; max: number }\n  | { type: 'min'; min: number; max: undefined }\n  | { type: 'max'; max: number; min: undefined };\n\nexport type ReferenceValidations = {\n  contentTypes?: string[];\n  mimetypeGroups?: string[];\n  numberOfLinks?: NumberOfLinksValidation;\n};\n\nexport function fromFieldValidations(field: FieldAPI): ReferenceValidations {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const validations: Record<string, any>[] = [\n    ...field.validations,\n    ...(field.items?.validations ?? []),\n  ];\n  const linkContentTypeValidations = validations.find((v) => 'linkContentType' in v);\n  const linkMimetypeGroupValidations = validations.find((v) => 'linkMimetypeGroup' in v);\n  const sizeValidations = validations.find((v) => 'size' in v);\n  const size = (sizeValidations && sizeValidations.size) || {};\n  const min = size.min;\n  const max = size.max;\n\n  let numberOfLinks: NumberOfLinksValidation | undefined = undefined;\n\n  if (isNumber(min) && isNumber(max)) {\n    numberOfLinks = {\n      type: 'min-max',\n      min,\n      max,\n    };\n  } else if (isNumber(min)) {\n    numberOfLinks = {\n      type: 'min',\n      min,\n      max: undefined,\n    };\n  } else if (isNumber(max)) {\n    numberOfLinks = {\n      type: 'max',\n      max,\n      min: undefined,\n    };\n  }\n\n  const result: ReferenceValidations = {\n    contentTypes: linkContentTypeValidations?.linkContentType ?? undefined,\n    mimetypeGroups: linkMimetypeGroupValidations?.linkMimetypeGroup ?? undefined,\n    numberOfLinks,\n    // todo: there are multiple BE problems that need to be solved first, for now we don't want to apply size constraints\n    // linkedFileSize: findValidation(field, 'assetFileSize', {}),\n    // linkedImageDimensions: findValidation(field, 'assetImageDimensions', {})\n  };\n\n  return result;\n}\n","import { useEffect, useMemo, useState } from 'react';\nimport { useContentTypePermissions } from './useContentTypePermissions';\nimport { ContentType, ContentEntityType, FieldExtensionSDK } from '../types';\nimport { ReferenceEditorProps } from './ReferenceEditor';\nimport { useAccessApi } from './useAccessApi';\nimport { fromFieldValidations } from '../utils/fromFieldValidations';\n\nexport type EditorPermissionsProps = {\n  sdk: FieldExtensionSDK;\n  entityType: ContentEntityType;\n  parameters: ReferenceEditorProps['parameters'];\n  allContentTypes: ContentType[];\n};\n\nexport function useEditorPermissions(props: EditorPermissionsProps) {\n  const { sdk, entityType, parameters } = props;\n  const validations = useMemo(() => fromFieldValidations(props.sdk.field), [props.sdk.field]);\n  const [canCreateEntity, setCanCreateEntity] = useState(true);\n  const [canLinkEntity, setCanLinkEntity] = useState(true);\n  const {\n    creatableContentTypes,\n    readableContentTypes,\n    availableContentTypes,\n  } = useContentTypePermissions({ ...props, validations });\n  const { canPerformAction } = useAccessApi(sdk.access);\n\n  useEffect(() => {\n    if (parameters.instance.showCreateEntityAction === false) {\n      setCanCreateEntity(false);\n      return;\n    }\n\n    async function checkCreateAccess() {\n      if (entityType === 'Asset') {\n        const canCreate = await canPerformAction('create', 'Asset');\n        setCanCreateEntity(canCreate);\n      }\n      if (entityType === 'Entry') {\n        setCanCreateEntity(creatableContentTypes.length > 0);\n      }\n    }\n\n    void checkCreateAccess();\n  }, [entityType, parameters.instance, creatableContentTypes]);\n\n  useEffect(() => {\n    if (parameters.instance.showLinkEntityAction === false) {\n      setCanLinkEntity(false);\n      return;\n    }\n\n    async function checkLinkAccess() {\n      if (entityType === 'Asset') {\n        const canRead = await canPerformAction('read', 'Asset');\n        setCanLinkEntity(canRead);\n      }\n      if (entityType === 'Entry') {\n        setCanLinkEntity(readableContentTypes.length > 0);\n      }\n    }\n\n    void checkLinkAccess();\n  }, [entityType, parameters.instance, readableContentTypes]);\n\n  return {\n    canCreateEntity,\n    canLinkEntity,\n    creatableContentTypes,\n    readableContentTypes,\n    availableContentTypes,\n    validations,\n  };\n}\n\nexport type EditorPermissions = ReturnType<typeof useEditorPermissions>;\n","import * as React from 'react';\nimport { ContentType, ContentEntityType, ReferenceValue } from '../types';\nimport { LinkEntityActions } from '../components';\nimport { ReferenceEditor, ReferenceEditorProps } from './ReferenceEditor';\nimport { useLinkActionsProps } from '../components/LinkActions/LinkEntityActions';\nimport { useCallback } from 'react';\nimport { CustomEntityCardProps } from './customCardTypes';\nimport { useEditorPermissions } from './useEditorPermissions';\n\ntype ChildProps = {\n  entityId: string;\n  entityType: ContentEntityType;\n  isDisabled: boolean;\n  setValue: (value: ReferenceValue | null | undefined) => void;\n  allContentTypes: ContentType[];\n  renderCustomCard?: ReferenceEditorProps['renderCustomCard'];\n  hasCardEditActions: boolean;\n};\n\ntype EditorProps = ReferenceEditorProps &\n  ChildProps & {\n    children: (props: ReferenceEditorProps & ChildProps) => React.ReactElement;\n  };\n\nfunction Editor(props: EditorProps) {\n  const { setValue, entityType } = props;\n  const editorPermissions = useEditorPermissions(props);\n\n  const onCreate = useCallback(\n    (id: string) => void setValue({ sys: { type: 'Link', linkType: entityType, id } }),\n    [setValue, entityType]\n  );\n  const onLink = useCallback(\n    (ids: string[]) => {\n      const [id] = ids;\n      setValue({ sys: { type: 'Link', linkType: entityType, id } });\n    },\n    [setValue, entityType]\n  );\n\n  const linkActionsProps = useLinkActionsProps({\n    ...props,\n    canLinkMultiple: false,\n    editorPermissions,\n    onCreate,\n    onLink,\n  });\n  // Inject card actions props into the given custom card renderer\n  const customCardRenderer = useCallback(\n    (cardProps: CustomEntityCardProps, _, renderDefaultCard) =>\n      props.renderCustomCard\n        ? props.renderCustomCard(cardProps, linkActionsProps, renderDefaultCard)\n        : false,\n    [linkActionsProps]\n  );\n\n  if (!props.entityId) {\n    return (\n      <LinkEntityActions renderCustomActions={props.renderCustomActions} {...linkActionsProps} />\n    );\n  }\n\n  return props.children({\n    ...props,\n    renderCustomCard: props.renderCustomCard && customCardRenderer,\n  });\n}\n\nexport function SingleReferenceEditor(\n  props: ReferenceEditorProps & {\n    entityType: ContentEntityType;\n    children: (props: ChildProps) => React.ReactElement;\n  }\n) {\n  const allContentTypes = props.sdk.space.getCachedContentTypes();\n\n  return (\n    <ReferenceEditor<ReferenceValue> {...props}>\n      {({ value, setValue, disabled, externalReset }) => {\n        return (\n          <Editor\n            {...props}\n            key={`${externalReset}-reference`}\n            entityId={value ? value.sys.id : ''}\n            isDisabled={disabled}\n            setValue={setValue}\n            allContentTypes={allContentTypes}\n          />\n        );\n      }}\n    </ReferenceEditor>\n  );\n}\n\nSingleReferenceEditor.defaultProps = {\n  hasCardEditActions: true,\n};\n","import * as React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/forma-36-tokens';\nimport { SpaceAPI } from '@contentful/app-sdk';\nimport {\n  DropdownList,\n  DropdownListItem,\n  EntryCard,\n  Icon,\n} from '@contentful/forma-36-react-components';\nimport { ContentType, Entry, File } from '../../types';\nimport { entityHelpers, isValidImage } from '@contentful/field-editor-shared';\nimport { AssetThumbnail, MissingEntityCard, ScheduledIconWithTooltip } from '../../components';\n\nconst { getEntryTitle, getEntityDescription, getEntryStatus, getEntryImage } = entityHelpers;\n\nconst styles = {\n  scheduleIcon: css({\n    marginRight: tokens.spacing2Xs,\n  }),\n};\n\nexport interface WrappedEntryCardProps {\n  getEntityScheduledActions: SpaceAPI['getEntityScheduledActions'];\n  getAsset: (assetId: string) => Promise<unknown>;\n  entryUrl?: string;\n  size: 'small' | 'default' | 'auto';\n  isDisabled: boolean;\n  isSelected?: boolean;\n  onRemove?: () => void;\n  onEdit?: () => void;\n  localeCode: string;\n  defaultLocaleCode: string;\n  contentType?: ContentType;\n  entry: Entry;\n  cardDragHandle?: React.ReactElement;\n  isClickable?: boolean;\n  hasCardEditActions: boolean;\n  onMoveTop?: () => void;\n  onMoveBottom?: () => void;\n  hasMoveOptions?: boolean;\n}\n\nconst defaultProps = {\n  isClickable: true,\n  hasCardEditActions: true,\n  hasMoveOptions: true,\n};\n\nexport function WrappedEntryCard(props: WrappedEntryCardProps) {\n  const [file, setFile] = React.useState<null | File>(null);\n\n  const { contentType } = props;\n\n  React.useEffect(() => {\n    if (props.entry) {\n      getEntryImage(\n        {\n          entry: props.entry,\n          contentType,\n          localeCode: props.localeCode,\n          defaultLocaleCode: props.defaultLocaleCode,\n        },\n        props.getAsset\n      )\n        .then((file) => {\n          setFile(file);\n        })\n        .catch(() => {\n          setFile(null);\n        });\n    }\n  }, [props.entry, props.getAsset, contentType, props.localeCode, props.defaultLocaleCode]);\n\n  const status = getEntryStatus(props.entry?.sys);\n\n  if (status === 'deleted') {\n    return (\n      <MissingEntityCard\n        entityType=\"Entry\"\n        isDisabled={props.isDisabled}\n        onRemove={props.onRemove}\n      />\n    );\n  }\n\n  const title = getEntryTitle({\n    entry: props.entry,\n    contentType,\n    localeCode: props.localeCode,\n    defaultLocaleCode: props.defaultLocaleCode,\n    defaultTitle: 'Untitled',\n  });\n\n  const description = getEntityDescription({\n    entity: props.entry,\n    contentType,\n    localeCode: props.localeCode,\n    defaultLocaleCode: props.defaultLocaleCode,\n  });\n\n  return (\n    // TODO: There should be dedicated components for each `size` with a different\n    //  set of params (e.g. `file` should only be relevant for the \"small\" size card.\n    <EntryCard\n      href={props.entryUrl}\n      title={title}\n      description={description}\n      contentType={contentType?.name}\n      size={props.size}\n      selected={props.isSelected}\n      status={status}\n      statusIcon={\n        <ScheduledIconWithTooltip\n          getEntityScheduledActions={props.getEntityScheduledActions}\n          entityType=\"Entry\"\n          entityId={props.entry.sys.id}>\n          <Icon\n            className={styles.scheduleIcon}\n            icon=\"Clock\"\n            size=\"small\"\n            color=\"muted\"\n            testId=\"schedule-icon\"\n          />\n        </ScheduledIconWithTooltip>\n      }\n      thumbnailElement={file && isValidImage(file) ? <AssetThumbnail file={file} /> : null}\n      cardDragHandleComponent={props.cardDragHandle}\n      withDragHandle={!!props.cardDragHandle}\n      dropdownListElements={\n        props.onEdit || props.onRemove ? (\n          <React.Fragment>\n            <DropdownList\n              // @ts-expect-error\n              onClick={(e) => {\n                e.stopPropagation();\n              }}>\n              {props.hasCardEditActions && props.onEdit && (\n                <DropdownListItem\n                  onClick={() => {\n                    props.onEdit && props.onEdit();\n                  }}\n                  testId=\"edit\">\n                  Edit\n                </DropdownListItem>\n              )}\n              {props.onRemove && (\n                <DropdownListItem\n                  onClick={() => {\n                    props.onRemove && props.onRemove();\n                  }}\n                  isDisabled={props.isDisabled}\n                  testId=\"delete\">\n                  Remove\n                </DropdownListItem>\n              )}\n            </DropdownList>\n            {props.hasMoveOptions ? (\n              <DropdownList\n                border=\"top\"\n                // @ts-expect-error\n                onClick={(e) => {\n                  e.stopPropagation();\n                }}>\n                <DropdownListItem\n                  onClick={() => props.onMoveTop && props.onMoveTop()}\n                  isDisabled={!props.onMoveTop}\n                  testId=\"move-top\">\n                  Move to top\n                </DropdownListItem>\n                <DropdownListItem\n                  onClick={() => props.onMoveBottom && props.onMoveBottom()}\n                  isDisabled={!props.onMoveBottom}\n                  testId=\"move-bottom\">\n                  Move to bottom\n                </DropdownListItem>\n              </DropdownList>\n            ) : (\n              <React.Fragment />\n            )}\n          </React.Fragment>\n        ) : undefined\n      }\n      onClick={(e) => {\n        e.preventDefault();\n        if (!props.isClickable) return;\n        props.onEdit && props.onEdit();\n      }}\n    />\n  );\n}\n\nWrappedEntryCard.defaultProps = defaultProps;\n","import * as React from 'react';\nimport { EntryCard } from '@contentful/forma-36-react-components';\nimport { ContentType, FieldExtensionSDK, NavigatorSlideInfo } from '../../types';\nimport { WrappedEntryCard, WrappedEntryCardProps } from './WrappedEntryCard';\nimport { MissingEntityCard } from '../../components';\nimport type { LinkActionsProps } from '../../components';\nimport { useEntities } from '../../common/EntityStore';\nimport { ReferenceEditorProps } from '../../common/ReferenceEditor';\nimport get from 'lodash/get';\nimport { CustomEntityCardProps, RenderCustomMissingEntityCard } from '../../common/customCardTypes';\n\nexport type EntryCardReferenceEditorProps = ReferenceEditorProps & {\n  entryId: string;\n  index?: number;\n  allContentTypes: ContentType[];\n  isDisabled: boolean;\n  onRemove: () => void;\n  cardDragHandle?: React.ReactElement;\n  hasCardEditActions: boolean;\n  onMoveTop?: () => void;\n  onMoveBottom?: () => void;\n  renderCustomMissingEntityCard?: RenderCustomMissingEntityCard;\n};\n\nasync function openEntry(\n  sdk: FieldExtensionSDK,\n  entryId: string,\n  options: { bulkEditing?: boolean; index?: number }\n) {\n  let slide: NavigatorSlideInfo | undefined;\n\n  if (options.bulkEditing) {\n    try {\n      const result = await sdk.navigator.openBulkEditor(sdk.entry.getSys().id, {\n        fieldId: sdk.field.id,\n        locale: sdk.field.locale,\n        index: options.index ?? 0,\n      });\n      slide = result.slide;\n      return slide;\n    } catch (e) {\n      // we don't allow to open multiple bulk editors for performance reasons\n      // proceed with a default openEntry\n    }\n  }\n\n  const result = await sdk.navigator.openEntry(entryId, {\n    slideIn: true,\n  });\n  slide = result.slide;\n\n  return slide;\n}\n\nexport function FetchingWrappedEntryCard(props: EntryCardReferenceEditorProps) {\n  const { getOrLoadEntry, getOrLoadAsset, loadEntityScheduledActions, entries } = useEntities();\n\n  React.useEffect(() => {\n    getOrLoadEntry(props.entryId);\n  }, [props.entryId]);\n\n  const size = props.viewType === 'link' ? 'small' : 'default';\n  const entry = entries[props.entryId];\n  const entityKey =\n    entry === 'failed'\n      ? 'failed'\n      : entry === undefined\n      ? 'undefined'\n      : `:${entry.sys.id}:${entry.sys.version}`;\n\n  const onEdit = async () => {\n    const slide = await openEntry(props.sdk, get(entry, 'sys.id'), {\n      bulkEditing: props.parameters.instance.bulkEditing,\n      index: props.index,\n    });\n    props.onAction &&\n      props.onAction({\n        entity: 'Entry',\n        type: 'edit',\n        id: get(entry, 'sys.id'),\n        contentTypeId: get(entry, 'sys.contentType.sys.id'),\n        slide,\n      });\n  };\n\n  const onRemoveEntry = () => {\n    props.onRemove();\n    props.onAction &&\n      props.onAction({\n        entity: 'Entry',\n        type: 'delete',\n        id: get(entry, 'sys.id'),\n        contentTypeId: get(entry, 'sys.contentType.sys.id'),\n      });\n  };\n\n  React.useEffect(() => {\n    if (entry) {\n      props.onAction && props.onAction({ type: 'rendered', entity: 'Entry' });\n    }\n  }, [entry]);\n\n  return React.useMemo(() => {\n    if (entry === 'failed') {\n      const card = (\n        <MissingEntityCard\n          entityType=\"Entry\"\n          isDisabled={props.isDisabled}\n          onRemove={onRemoveEntry}\n        />\n      );\n      if (props.renderCustomMissingEntityCard) {\n        return props.renderCustomMissingEntityCard({\n          defaultCard: card,\n          entity: {\n            id: props.entryId,\n            type: 'Entry',\n          },\n        });\n      }\n      return card;\n    }\n    if (entry === undefined) {\n      return <EntryCard size={size} loading />;\n    }\n    const sharedCardProps: CustomEntityCardProps = {\n      index: props.index,\n      entity: entry,\n      entityUrl: props.getEntityUrl && props.getEntityUrl(entry.sys.id),\n      contentType: props.allContentTypes.find(\n        (contentType) => contentType.sys.id === entry.sys.contentType.sys.id\n      ),\n      isDisabled: props.isDisabled,\n      size,\n      localeCode: props.sdk.field.locale,\n      defaultLocaleCode: props.sdk.locales.default,\n      cardDragHandle: props.cardDragHandle,\n      onEdit,\n      onRemove: onRemoveEntry,\n      onMoveTop: props.onMoveTop,\n      onMoveBottom: props.onMoveBottom,\n    };\n\n    const { hasCardEditActions } = props;\n\n    function renderDefaultCard(props?: CustomEntityCardProps) {\n      const builtinCardProps: WrappedEntryCardProps = {\n        ...sharedCardProps,\n        ...props,\n        hasCardEditActions: hasCardEditActions,\n        getAsset: getOrLoadAsset,\n        getEntityScheduledActions: loadEntityScheduledActions,\n        entry: props?.entity || sharedCardProps.entity,\n        entryUrl: props?.entityUrl || sharedCardProps.entityUrl,\n      };\n\n      return <WrappedEntryCard {...builtinCardProps} />;\n    }\n\n    if (props.renderCustomCard) {\n      // LinkActionsProps are injected higher SingleReferenceEditor/MultipleReferenceEditor\n      const renderedCustomCard = props.renderCustomCard(\n        sharedCardProps,\n        {} as LinkActionsProps,\n        renderDefaultCard\n      );\n      // Only `false` indicates to render the original card. E.g. `null` would result in no card.\n      if (renderedCustomCard !== false) {\n        return renderedCustomCard;\n      }\n    }\n\n    return renderDefaultCard();\n  }, [props, entityKey]);\n}\n","import * as React from 'react';\nimport { ReferenceEditorProps } from '../common/ReferenceEditor';\nimport { SingleReferenceEditor } from '../common/SingleReferenceEditor';\nimport { FetchingWrappedEntryCard } from './WrappedEntryCard/FetchingWrappedEntryCard';\n\nexport function SingleEntryReferenceEditor(props: ReferenceEditorProps) {\n  return (\n    <SingleReferenceEditor {...props} entityType=\"Entry\">\n      {({\n        allContentTypes,\n        isDisabled,\n        entityId,\n        setValue,\n        renderCustomCard,\n        hasCardEditActions,\n      }) => {\n        return (\n          <FetchingWrappedEntryCard\n            {...props}\n            allContentTypes={allContentTypes}\n            isDisabled={isDisabled}\n            entryId={entityId}\n            renderCustomCard={renderCustomCard}\n            hasCardEditActions={hasCardEditActions}\n            onRemove={() => {\n              setValue(null);\n            }}\n          />\n        );\n      }}\n    </SingleReferenceEditor>\n  );\n}\n\nSingleEntryReferenceEditor.defaultProps = {\n  isInitiallyDisabled: true,\n};\n","import * as React from 'react';\nimport arrayMove from 'array-move';\nimport { ReferenceValue, ContentEntityType, ContentType } from '../types';\nimport { ReferenceEditor, ReferenceEditorProps } from './ReferenceEditor';\nimport { LinkEntityActions } from '../components';\nimport { SortEndHandler, SortStartHandler } from 'react-sortable-hoc';\nimport { useLinkActionsProps } from '../components/LinkActions/LinkEntityActions';\nimport { useCallback } from 'react';\nimport { CustomEntityCardProps } from './customCardTypes';\nimport { useEditorPermissions } from './useEditorPermissions';\n\ntype ChildProps = {\n  entityType: ContentEntityType;\n  items: ReferenceValue[];\n  isDisabled: boolean;\n  setValue: (value: ReferenceValue[]) => void;\n  allContentTypes: ContentType[];\n  onSortStart: SortStartHandler;\n  onSortEnd: SortEndHandler;\n  onMove: (oldIndex: number, newIndex: number) => void;\n};\n\ntype EditorProps = ReferenceEditorProps &\n  Omit<ChildProps, 'onSortStart' | 'onSortEnd' | 'onMove'> & {\n    children: (props: ReferenceEditorProps & ChildProps) => React.ReactElement;\n  };\n\nfunction onLinkOrCreate(\n  setValue: ChildProps['setValue'],\n  entityType: ChildProps['entityType'],\n  items: ChildProps['items'],\n  ids: string[],\n  index = items.length\n): void {\n  const links: ReferenceValue[] = ids.map((id) => ({\n    sys: { type: 'Link', linkType: entityType, id },\n  }));\n  const newItems = Array.from(items);\n  newItems.splice(index, 0, ...links);\n  setValue(newItems);\n}\n\nconst emptyArray: ReferenceValue[] = [];\nconst nullableValue = { sys: { id: 'null-value' } };\n\nfunction Editor(props: EditorProps) {\n  const { setValue, entityType } = props;\n  const editorPermissions = useEditorPermissions(props);\n\n  const items = React.useMemo(() => {\n    return (\n      (props.items || [])\n        // If null values have found their way into the persisted\n        // value for the multiref field, replace them with an object\n        // that has the shape of a Link to make the missing entry/asset\n        // card render\n        .map((link) => link || nullableValue)\n    );\n  }, [props.items]);\n\n  const onSortStart: SortStartHandler = useCallback((_, event) => event.preventDefault(), []);\n  const onSortEnd: SortEndHandler = useCallback(\n    ({ oldIndex, newIndex }) => {\n      const newItems = arrayMove(items, oldIndex, newIndex);\n      setValue(newItems);\n    },\n    [items, setValue]\n  );\n  const onMove = useCallback(\n    (oldIndex, newIndex) => {\n      const newItems = arrayMove(items, oldIndex, newIndex);\n      setValue(newItems);\n    },\n    [items, setValue]\n  );\n\n  const onCreate = useCallback(\n    (id: string, index?: number) => onLinkOrCreate(setValue, entityType, items, [id], index),\n    [setValue, items, entityType]\n  );\n\n  const onLink = useCallback(\n    (ids: string[], index?: number) => onLinkOrCreate(setValue, entityType, items, ids, index),\n    [setValue, items, entityType]\n  );\n\n  const linkActionsProps = useLinkActionsProps({\n    ...props,\n    canLinkMultiple: true,\n    editorPermissions,\n    onCreate,\n    onLink,\n    itemsLength: items.length,\n  });\n\n  const customCardRenderer = useCallback(\n    (cardProps: CustomEntityCardProps, _, renderDefaultCard) =>\n      props.renderCustomCard\n        ? props.renderCustomCard(cardProps, linkActionsProps, renderDefaultCard)\n        : false,\n    [linkActionsProps]\n  );\n\n  return (\n    <>\n      {props.children({\n        ...props,\n        onSortStart: onSortStart,\n        onSortEnd: onSortEnd,\n        onMove,\n        renderCustomCard: props.renderCustomCard && customCardRenderer,\n      })}\n      <LinkEntityActions renderCustomActions={props.renderCustomActions} {...linkActionsProps} />\n    </>\n  );\n}\n\nexport function MultipleReferenceEditor(\n  props: ReferenceEditorProps & {\n    entityType: ContentEntityType;\n    children: (props: ReferenceEditorProps & ChildProps) => React.ReactElement;\n  }\n) {\n  const allContentTypes = props.sdk.space.getCachedContentTypes();\n\n  return (\n    <ReferenceEditor<ReferenceValue[]> {...props}>\n      {({ value, disabled, setValue, externalReset }) => {\n        return (\n          <Editor\n            {...props}\n            items={value || emptyArray}\n            isDisabled={disabled}\n            setValue={setValue}\n            key={`${externalReset}-list`}\n            allContentTypes={allContentTypes}\n          />\n        );\n      }}\n    </ReferenceEditor>\n  );\n}\n\nMultipleReferenceEditor.defaultProps = {\n  hasCardEditActions: true,\n};\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/forma-36-tokens';\nimport { FetchingWrappedEntryCard } from './WrappedEntryCard/FetchingWrappedEntryCard';\nimport { ContentType, ReferenceValue } from '../types';\nimport { ReferenceEditorProps } from '../common/ReferenceEditor';\nimport { SortableContainer, SortableElement, SortableHandle } from 'react-sortable-hoc';\nimport { CardDragHandle } from '@contentful/forma-36-react-components';\n\nconst styles = {\n  containter: css({\n    position: 'relative',\n  }),\n  item: css({\n    marginBottom: tokens.spacingM,\n  }),\n};\n\ntype SortableLinkListProps = ReferenceEditorProps & {\n  items: ReferenceValue[];\n  setValue: (value: ReferenceValue[]) => void;\n  isDisabled: boolean;\n  allContentTypes: ContentType[];\n  onMove: (oldIndex: number, newIndex: number) => void;\n};\n\nconst DragHandle = SortableHandle(() => <CardDragHandle>Reorder item</CardDragHandle>);\n\nconst SortableLink = SortableElement((props: { children: React.ReactElement }) => (\n  <div className={styles.item}>{props.children}</div>\n));\n\nexport const SortableLinkList = SortableContainer((props: SortableLinkListProps) => {\n  const lastIndex = props.items.length - 1;\n\n  return (\n    <div className={styles.containter}>\n      {props.items.map((item, index) => (\n        <SortableLink disabled={props.isDisabled} key={`${item.sys.id}-${index}`} index={index}>\n          <FetchingWrappedEntryCard\n            {...props}\n            key={`${item.sys.id}-${index}`}\n            index={index}\n            allContentTypes={props.allContentTypes}\n            isDisabled={props.isDisabled}\n            entryId={item.sys.id}\n            onRemove={() => {\n              props.setValue(\n                props.items.filter((_value, i) => {\n                  return i !== index;\n                })\n              );\n            }}\n            onMoveTop={index !== 0 ? () => props.onMove(index, 0) : undefined}\n            onMoveBottom={index !== lastIndex ? () => props.onMove(index, lastIndex) : undefined}\n            cardDragHandle={props.isDisabled ? undefined : <DragHandle />}\n          />\n        </SortableLink>\n      ))}\n    </div>\n  );\n});\n","import * as React from 'react';\nimport { ReferenceEditorProps } from '../common/ReferenceEditor';\nimport { MultipleReferenceEditor } from '../common/MultipleReferenceEditor';\nimport { SortableLinkList } from './SortableElements';\n\nexport function MultipleEntryReferenceEditor(props: ReferenceEditorProps) {\n  return (\n    <MultipleReferenceEditor {...props} entityType=\"Entry\">\n      {(childrenProps) => (\n        <SortableLinkList {...props} {...childrenProps} axis=\"y\" useDragHandle={true} />\n      )}\n    </MultipleReferenceEditor>\n  );\n}\n","import React from 'react';\nimport { DropdownList, DropdownListItem } from '@contentful/forma-36-react-components';\nimport { shortenStorageUnit } from '@contentful/field-editor-shared';\nimport { css } from 'emotion';\nimport { File } from '../../types';\nimport get from 'lodash/get';\n\nconst styles = {\n  cardDropdown: css({\n    width: '300px',\n  }),\n  truncated: css({\n    overflow: 'hidden',\n    whiteSpace: 'nowrap',\n    textOverflow: 'ellipsis',\n  }),\n};\n\nfunction downloadAsset(url: string) {\n  window.open(url, '_blank', 'noopener,noreferrer');\n}\n\nexport function renderAssetInfo(props: { entityFile: File }) {\n  const { entityFile } = props;\n  const fileName = get(entityFile, 'fileName');\n  const mimeType = get(entityFile, 'contentType');\n  const fileSize = get(entityFile, 'details.size');\n  const image = get(entityFile, 'details.image');\n  return (\n    <DropdownList\n      border=\"top\"\n      className={styles.cardDropdown}\n      // @ts-expect-error\n      onClick={(e) => {\n        e.stopPropagation();\n      }}>\n      <DropdownListItem isTitle>File info</DropdownListItem>\n      {fileName && (\n        <DropdownListItem>\n          <div className={styles.truncated}>{fileName}</div>\n        </DropdownListItem>\n      )}\n      {mimeType && (\n        <DropdownListItem>\n          <div>{mimeType}</div>\n        </DropdownListItem>\n      )}\n      {fileSize && <DropdownListItem>{shortenStorageUnit(fileSize, 'B')}</DropdownListItem>}\n      {image && <DropdownListItem>{`${image.width}  ${image.height}`}</DropdownListItem>}\n    </DropdownList>\n  );\n}\n\nexport function renderActions(props: {\n  onEdit?: () => void;\n  onRemove?: () => void;\n  isDisabled: boolean;\n  entityFile?: File;\n}) {\n  const { entityFile, isDisabled, onEdit, onRemove } = props;\n  return (\n    <DropdownList\n      className={styles.cardDropdown}\n      // @ts-expect-error\n      onClick={(e) => {\n        e.stopPropagation();\n      }}>\n      <DropdownListItem isTitle>Actions</DropdownListItem>\n      {onEdit && (\n        <DropdownListItem onClick={onEdit} testId=\"card-action-edit\">\n          Edit\n        </DropdownListItem>\n      )}\n      {entityFile && (\n        <DropdownListItem\n          onClick={() => {\n            if (typeof entityFile.url === 'string') {\n              downloadAsset(entityFile.url);\n            }\n          }}\n          testId=\"card-action-download\">\n          Download\n        </DropdownListItem>\n      )}\n      {onRemove && (\n        <DropdownListItem isDisabled={isDisabled} onClick={onRemove} testId=\"card-action-remove\">\n          Remove\n        </DropdownListItem>\n      )}\n    </DropdownList>\n  );\n}\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/forma-36-tokens';\nimport { SpaceAPI } from '@contentful/app-sdk';\nimport { AssetCard, Icon } from '@contentful/forma-36-react-components';\nimport { renderActions, renderAssetInfo } from './AssetCardActions';\nimport { File, Asset } from '../../types';\nimport { entityHelpers } from '@contentful/field-editor-shared';\nimport { MissingEntityCard, ScheduledIconWithTooltip } from '../../components';\n\n// @ts-expect-error\nimport mimetype from '@contentful/mimetype';\n\nconst groupToIconMap = {\n  image: 'image',\n  video: 'video',\n  audio: 'audio',\n  richtext: 'richtext',\n  presentation: 'presentation',\n  spreadsheet: 'spreadsheet',\n  pdfdocument: 'pdf',\n  archive: 'archive',\n  plaintext: 'plaintext',\n  code: 'code',\n  markup: 'markup',\n};\n\nconst styles = {\n  scheduleIcon: css({\n    marginRight: tokens.spacing2Xs,\n  }),\n};\n\nexport interface WrappedAssetCardProps {\n  getEntityScheduledActions: SpaceAPI['getEntityScheduledActions'];\n  asset: Asset;\n  localeCode: string;\n  defaultLocaleCode: string;\n  getAssetUrl?: (assetId: string) => string;\n  className?: string;\n  isSelected?: boolean;\n  isDisabled: boolean;\n  onEdit?: () => void;\n  onRemove?: () => void;\n  size: 'default' | 'small';\n  cardDragHandle?: React.ReactElement;\n  isClickable: boolean;\n}\n\nconst defaultProps = {\n  isClickable: true,\n};\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction getFileType(file?: File): any {\n  if (!file) {\n    return 'archive';\n  }\n\n  const groupName: keyof typeof groupToIconMap = mimetype.getGroupLabel({\n    type: file.contentType,\n    fallbackFileName: file.fileName,\n  });\n\n  return groupToIconMap[groupName] || 'archive';\n}\n\nexport const WrappedAssetCard = (props: WrappedAssetCardProps) => {\n  const { className, onEdit, getAssetUrl, onRemove, size, isDisabled, isSelected, isClickable } =\n    props;\n\n  const status = entityHelpers.getEntryStatus(props.asset.sys);\n\n  if (status === 'deleted') {\n    return (\n      <MissingEntityCard\n        entityType=\"Asset\"\n        asSquare\n        isDisabled={props.isDisabled}\n        onRemove={props.onRemove}\n      />\n    );\n  }\n\n  const entityTitle = entityHelpers.getAssetTitle({\n    asset: props.asset,\n    localeCode: props.localeCode,\n    defaultLocaleCode: props.defaultLocaleCode,\n    defaultTitle: 'Untitled',\n  });\n\n  const entityFile = props.asset.fields.file\n    ? props.asset.fields.file[props.localeCode] || props.asset.fields.file[props.defaultLocaleCode]\n    : undefined;\n\n  return (\n    <AssetCard\n      type={getFileType(entityFile)}\n      title={entityTitle}\n      className={className}\n      selected={isSelected}\n      href={getAssetUrl ? getAssetUrl(props.asset.sys.id) : undefined}\n      status={status}\n      statusIcon={\n        <ScheduledIconWithTooltip\n          getEntityScheduledActions={props.getEntityScheduledActions}\n          entityType=\"Asset\"\n          entityId={props.asset.sys.id}>\n          <Icon\n            className={styles.scheduleIcon}\n            icon=\"Clock\"\n            size=\"small\"\n            color=\"muted\"\n            testId=\"schedule-icon\"\n          />\n        </ScheduledIconWithTooltip>\n      }\n      src={\n        entityFile && entityFile.url\n          ? size === 'small'\n            ? `${entityFile.url}?w=150&h=150&fit=thumb`\n            : `${entityFile.url}?h=300`\n          : ''\n      }\n      // @ts-expect-error\n      onClick={(e: React.MouseEvent<HTMLElement>) => {\n        e.preventDefault();\n        if (!isClickable) return;\n        onEdit && onEdit();\n      }}\n      cardDragHandleComponent={props.cardDragHandle}\n      withDragHandle={!!props.cardDragHandle}\n      dropdownListElements={\n        <React.Fragment>\n          {renderActions({ entityFile, isDisabled: isDisabled, onEdit, onRemove })}\n          {entityFile ? renderAssetInfo({ entityFile }) : <span />}\n        </React.Fragment>\n      }\n      size={size}\n    />\n  );\n};\n\nWrappedAssetCard.defaultProps = defaultProps;\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/forma-36-tokens';\nimport { EntryCard, Icon } from '@contentful/forma-36-react-components';\nimport { renderActions, renderAssetInfo } from './AssetCardActions';\nimport { Asset } from '../../types';\nimport { entityHelpers, SpaceAPI } from '@contentful/field-editor-shared';\nimport { MissingEntityCard, ScheduledIconWithTooltip } from '../../components';\n\nconst styles = {\n  scheduleIcon: css({\n    marginRight: tokens.spacing2Xs,\n  }),\n};\n\nexport interface WrappedAssetLinkProps {\n  getEntityScheduledActions: SpaceAPI['getEntityScheduledActions'];\n  asset: Asset;\n  localeCode: string;\n  defaultLocaleCode: string;\n  href?: string;\n  className?: string;\n  isDisabled: boolean;\n  onEdit: () => void;\n  onRemove: () => void;\n  cardDragHandle?: React.ReactElement;\n}\n\nexport const WrappedAssetLink = (props: WrappedAssetLinkProps) => {\n  const { className, href, onEdit, onRemove, isDisabled } = props;\n\n  const status = entityHelpers.getEntryStatus(props.asset.sys);\n\n  if (status === 'deleted') {\n    return (\n      <MissingEntityCard\n        entityType=\"Asset\"\n        isDisabled={props.isDisabled}\n        onRemove={props.onRemove}\n      />\n    );\n  }\n\n  const entityTitle = entityHelpers.getAssetTitle({\n    asset: props.asset,\n    localeCode: props.localeCode,\n    defaultLocaleCode: props.defaultLocaleCode,\n    defaultTitle: 'Untitled',\n  });\n\n  const entityFile = props.asset.fields.file\n    ? props.asset.fields.file[props.localeCode] || props.asset.fields.file[props.defaultLocaleCode]\n    : undefined;\n\n  return (\n    <EntryCard\n      contentType=\"Asset\"\n      title={entityTitle}\n      className={className}\n      href={href}\n      size=\"small\"\n      status={status}\n      statusIcon={\n        <ScheduledIconWithTooltip\n          getEntityScheduledActions={props.getEntityScheduledActions}\n          entityType=\"Asset\"\n          entityId={props.asset.sys.id}>\n          <Icon\n            className={styles.scheduleIcon}\n            icon=\"Clock\"\n            size=\"small\"\n            color=\"muted\"\n            testId=\"schedule-icon\"\n          />\n        </ScheduledIconWithTooltip>\n      }\n      onClick={(e) => {\n        e.preventDefault();\n        onEdit();\n      }}\n      cardDragHandleComponent={props.cardDragHandle}\n      withDragHandle={!!props.cardDragHandle}\n      dropdownListElements={\n        <React.Fragment>\n          {renderActions({ entityFile, isDisabled: isDisabled, onEdit, onRemove })}\n          {entityFile ? renderAssetInfo({ entityFile }) : <span />}\n        </React.Fragment>\n      }\n    />\n  );\n};\n","import * as React from 'react';\nimport { AssetCard, EntryCard } from '@contentful/forma-36-react-components';\nimport { Action, Asset, FieldExtensionSDK, ViewType } from '../../types';\nimport { LinkActionsProps, MissingEntityCard } from '../../components';\nimport { WrappedAssetCard, WrappedAssetCardProps } from './WrappedAssetCard';\nimport { WrappedAssetLink } from './WrappedAssetLink';\nimport { useEntities } from '../../common/EntityStore';\nimport {\n  CustomEntityCardProps,\n  CustomCardRenderer,\n  RenderCustomMissingEntityCard,\n} from '../../common/customCardTypes';\n\ntype FetchingWrappedAssetCardProps = {\n  assetId: string;\n  isDisabled: boolean;\n  sdk: FieldExtensionSDK;\n  viewType: ViewType | 'big_card';\n  onRemove: () => void;\n  getEntityUrl?: (id: string) => string;\n  onAction?: (action: Action) => void;\n  cardDragHandle?: React.ReactElement;\n  renderCustomCard?: CustomCardRenderer;\n  renderCustomMissingEntityCard?: RenderCustomMissingEntityCard;\n};\n\nexport function FetchingWrappedAssetCard(props: FetchingWrappedAssetCardProps) {\n  const { getOrLoadAsset, loadEntityScheduledActions, assets } = useEntities();\n\n  React.useEffect(() => {\n    getOrLoadAsset(props.assetId);\n  }, [props.assetId]);\n\n  const asset = assets[props.assetId];\n  const entityKey =\n    asset === 'failed'\n      ? 'failed'\n      : asset === undefined\n      ? 'undefined'\n      : `:${asset.sys.id}:${asset.sys.version}`;\n\n  React.useEffect(() => {\n    if (asset) {\n      props.onAction && props.onAction({ type: 'rendered', entity: 'Asset' });\n    }\n  }, [asset]);\n\n  const onEdit = async () => {\n    const { slide } = await props.sdk.navigator.openAsset(props.assetId, { slideIn: true });\n    props.onAction &&\n      props.onAction({\n        entity: 'Asset',\n        type: 'edit',\n        id: props.assetId,\n        contentTypeId: '',\n        slide,\n      });\n  };\n\n  const onRemove = () => {\n    props.onRemove();\n    props.onAction &&\n      props.onAction({ entity: 'Asset', type: 'delete', id: props.assetId, contentTypeId: '' });\n  };\n\n  return React.useMemo(() => {\n    if (asset === 'failed') {\n      const card = (\n        <MissingEntityCard\n          entityType=\"Asset\"\n          asSquare={props.viewType !== 'link'}\n          isDisabled={props.isDisabled}\n          onRemove={onRemove}\n        />\n      );\n      if (props.renderCustomMissingEntityCard) {\n        return props.renderCustomMissingEntityCard({\n          defaultCard: card,\n          entity: {\n            id: props.assetId,\n            type: 'Asset',\n          },\n        });\n      }\n      return card;\n    }\n\n    const { getEntityUrl, sdk } = props;\n    const size = props.viewType === 'big_card' ? 'default' : 'small';\n    const commonProps = {\n      asset: asset as Asset,\n      entityUrl: getEntityUrl && getEntityUrl(props.assetId),\n      size: size as 'default' | 'small',\n      isDisabled: props.isDisabled,\n      localeCode: props.sdk.field.locale,\n      defaultLocaleCode: props.sdk.locales.default,\n      cardDragHandle: props.cardDragHandle,\n      onEdit,\n      onRemove,\n    };\n\n    if (props.viewType === 'link') {\n      if (asset === undefined) {\n        return <EntryCard size=\"small\" loading />;\n      }\n      return (\n        <WrappedAssetLink\n          {...commonProps}\n          href={commonProps.entityUrl}\n          getEntityScheduledActions={sdk.space.getEntityScheduledActions}\n        />\n      );\n    }\n\n    if (asset === undefined) {\n      return <AssetCard size={size} isLoading title=\"\" src=\"\" href=\"\" />;\n    }\n\n    function renderDefaultCard(props?: CustomEntityCardProps) {\n      // isClickable has a default value, so omit it from the props\n      const builtinCardProps: Omit<WrappedAssetCardProps, 'isClickable'> = {\n        ...commonProps,\n        ...props,\n        getEntityScheduledActions: loadEntityScheduledActions,\n        asset: (props?.entity as Asset) || commonProps.asset,\n        getAssetUrl: getEntityUrl,\n      };\n\n      return <WrappedAssetCard {...builtinCardProps} />;\n    }\n\n    if (props.renderCustomCard) {\n      const customProps: CustomEntityCardProps = {\n        ...commonProps,\n        entity: commonProps.asset,\n      };\n\n      // LinkActionsProps are injected higher SingleReferenceEditor/MultipleReferenceEditor\n      const renderedCustomCard = props.renderCustomCard(\n        customProps,\n        {} as LinkActionsProps,\n        renderDefaultCard\n      );\n      // Only `false` indicates to render the original card. E.g. `null` would result in no card.\n      if (renderedCustomCard !== false) {\n        return renderedCustomCard;\n      }\n    }\n\n    return renderDefaultCard();\n  }, [props, entityKey]);\n}\n","import * as React from 'react';\nimport { FetchingWrappedAssetCard } from './WrappedAssetCard/FetchingWrappedAssetCard';\nimport { ReferenceEditorProps } from '../common/ReferenceEditor';\nimport { SingleReferenceEditor } from '../common/SingleReferenceEditor';\n\ntype EditorProps = Omit<ReferenceEditorProps, 'hasCardEditActions'>;\n\nexport function SingleMediaEditor(props: EditorProps) {\n  return (\n    <SingleReferenceEditor {...props} entityType=\"Asset\">\n      {({ entityId, isDisabled, setValue }) => (\n        <FetchingWrappedAssetCard\n          {...props}\n          viewType=\"big_card\"\n          assetId={entityId}\n          isDisabled={isDisabled}\n          onRemove={() => {\n            setValue(null);\n          }}\n        />\n      )}\n    </SingleReferenceEditor>\n  );\n}\n\nSingleMediaEditor.defaultProps = {\n  isInitiallyDisabled: true,\n};\n","import React from 'react';\nimport { css } from 'emotion';\nimport tokens from '@contentful/forma-36-tokens';\nimport { FetchingWrappedAssetCard } from './WrappedAssetCard/FetchingWrappedAssetCard';\nimport { ReferenceValue } from '../types';\nimport { ReferenceEditorProps } from '../common/ReferenceEditor';\nimport { SortableContainer, SortableElement, SortableHandle } from 'react-sortable-hoc';\nimport { CardDragHandle } from '@contentful/forma-36-react-components';\n\nconst styles = {\n  gridContainter: css({\n    position: 'relative',\n    display: 'flex',\n    flexWrap: 'wrap',\n  }),\n  container: css({\n    position: 'relative',\n  }),\n  item: css({\n    marginBottom: tokens.spacingM,\n    marginRight: tokens.spacingM,\n  }),\n};\n\ntype SortableLinkListProps = ReferenceEditorProps & {\n  items: ReferenceValue[];\n  setValue: (value: ReferenceValue[]) => void;\n  isDisabled: boolean;\n};\n\nconst DragHandle = SortableHandle(() => <CardDragHandle>Reorder item</CardDragHandle>);\n\nconst SortableLink = SortableElement((props: { children: React.ReactElement }) => (\n  <div className={styles.item}>{props.children}</div>\n));\n\nexport const SortableLinkList = SortableContainer((props: SortableLinkListProps) => (\n  <div className={props.viewType === 'card' ? styles.gridContainter : styles.container}>\n    {props.items.map((item, index) => (\n      <SortableLink disabled={props.isDisabled} key={`${item.sys.id}-${index}`} index={index}>\n        <FetchingWrappedAssetCard\n          {...props}\n          sdk={props.sdk}\n          key={`${item.sys.id}-${index}`}\n          assetId={item.sys.id}\n          onRemove={() => {\n            props.setValue(\n              props.items.filter((_value, i) => {\n                return i !== index;\n              })\n            );\n          }}\n          cardDragHandle={props.isDisabled ? undefined : <DragHandle />}\n        />\n      </SortableLink>\n    ))}\n  </div>\n));\n","import * as React from 'react';\nimport { ReferenceEditorProps } from '../common/ReferenceEditor';\nimport { MultipleReferenceEditor } from '../common/MultipleReferenceEditor';\nimport { SortableLinkList } from './SortableElements';\n\ntype EditorProps = Omit<ReferenceEditorProps, 'hasCardEditActions'>;\n\nexport function MultipleMediaEditor(props: EditorProps) {\n  return (\n    <MultipleReferenceEditor {...props} entityType=\"Asset\">\n      {(childrenProps) => (\n        <SortableLinkList\n          {...props}\n          {...childrenProps}\n          axis={props.viewType === 'card' ? 'xy' : 'y'}\n          useDragHandle={true}\n        />\n      )}\n    </MultipleReferenceEditor>\n  );\n}\n\nMultipleMediaEditor.defaultProps = {\n  isInitiallyDisabled: true,\n};\n"],"names":["container","css","display","border","tokens","gray500","borderRadius","borderRadiusMedium","justifyContent","padding","spacingXl","action","textDecoration","fontWeight","useGlobalMouseUp","handler","useEffect","document","addEventListener","removeEventListener","MAX_ITEMS_WITHOUT_SEARCH","styles","wrapper","position","searchInput","parentHasDropdown","borderColor","undefined","borderLeft","borderRight","paddingRight","spacing2Xl","color","gray600","searchIcon","right","spacingM","top","spacingS","zIndex","Number","zIndexDefault","fill","separator","background","gray200","margin","dropdownList","CreateEntryMenuTrigger","contentTypes","suggestedContentTypeId","contentTypesLabel","onSelect","testId","dropdownSettings","renderCustomDropdownItems","children","useState","isOpen","setOpen","isSelecting","setSelecting","setSearchInput","useRef","textField","dropdownRef","dropdownWidth","setDropdownWidth","hasDropdown","length","closeMenu","setTimeout","current","querySelector","focus","handleSelect","item","res","sys","id","then","toggleMenu","mouseUpHandler","useCallback","event","contains","target","renderSearchResultsCount","resultsLength","React","DropdownListItem","isTitle","isSearchable","maxDropdownHeight","suggestedContentType","find","ct","filteredContentTypes","filter","get","toLowerCase","includes","className","ref","Dropdown","focusContainerOnOpen","isAutoalignmentEnabled","toggleElement","openMenu","getContainerRef","clientWidth","DropdownList","TextInput","placeholder","value","onChange","e","Icon","icon","width","maxHeight","onClick","map","contentType","i","key","defaultProps","standardStyles","spinnerMargin","marginRight","spacingXs","redesignStyles","CreateEntryLinkButton","text","hasPlusIcon","useExperimentalStyles","disabled","buttonText","plusIcon","Spinner","size","Button","buttonType","indicateDropdown","Boolean","marginTop","NoLinkPermissionsInfo","Paragraph","defaultEntryLabels","createNew","props","linkExisting","canLinkMultiple","defaultAssetLabels","testIds","dropdown","createAndLink","createAndLinkWrapper","LinkActions","isFull","defaultLabels","entityType","labels","actionLabels","canCreateEntity","isDisabled","name","contentTypeId","onCreate","itemsLength","Promise","resolve","canLinkEntity","onLinkExisting","sharedTextIds","actionsWrapper","CombinedLinkActions","hideEmptyCard","isEmpty","CombinedEntryLinkActions","CombinedAssetLinkActions","combinedActionsLabel","onClose","card","squareCard","alignItems","height","textAlign","close","MissingEntityCard","Card","asSquare","SectionHeading","onRemove","IconButton","label","iconProps","runtime","exports","Op","Object","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","makeInvokeMethod","tryCatch","fn","arg","type","call","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","constructor","displayName","defineIteratorMethods","forEach","method","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","__await","AsyncIterator","PromiseImpl","invoke","reject","record","result","unwrapped","error","previousPromise","enqueue","callInvokeWithMethodAndArg","async","iter","next","done","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","info","resultName","nextLoc","toString","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","keys","object","reverse","pop","iterable","iteratorMethod","isNaN","skipTempReset","prev","charAt","slice","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","Function","getContentTypeIds","createEntity","sdk","navigator","openNewEntry","slideIn","entity","slide","openNewAsset","selectSingleEntity","dialogs","selectSingleEntry","locale","field","editorPermissions","readableContentTypes","selectSingleAsset","mimetypeGroups","validations","selectMultipleEntities","getValue","linkCount","Array","isArray","min","Math","max","numberOfLinks","Infinity","selectMultipleEntries","selectMultipleAssets","useLinkActionsProps","maxLinksCount","onCreated","index","onAction","entityData","onLinkedExisting","entities","onLink","onLinkSeveralExisting","useMemo","creatableContentTypes","join","LinkEntityActions","renderCustomActions","renderLinkActions","formatDate","date","short","moment","startOf","diff","format","formatTime","utc","local","formatDateAndTime","statusTag","marginLeft","positiveColor","colorPositive","secondaryColor","marginRightXS","spacing2Xs","paragraph","time","ScheduleTooltipContent","job","jobsCount","colorPalette","scheduledFor","datetime","Tag","tagType","cx","toUpperCase","ScheduleTooltip","Tooltip","place","containerElement","content","ScheduledIconWithTooltip","entityId","getEntityScheduledActions","status","setStatus","data","jobs","mostRelevantJob","dimensions","AssetThumbnail","alt","file","fileName","src","url","reducer","entries","assets","asset","initialState","scheduledActions","useEntitiesStore","dispatch","loadEntityScheduledActions","space","actions","loadEntry","getEntry","loadAsset","getAsset","getOrLoadAsset","getOrLoadEntry","onEntityChanged","listeners","off","onSlideInNavigation","oldSlideLevel","newSlideLevel","constate","EntityProvider","useEntities","ReferenceEditor","FieldConnector","throttle","isInitiallyDisabled","isEqualValues","value1","value2","deepEqual","hasCardEditActions","AllowActionsOnContentType","useAccessApi","accessApi","canPerformAction","can","canPerformActionOnEntryOfType","arr","predicate","fail","all","results","x","useContentTypePermissions","availableContentTypes","allContentTypes","setCreatableContentTypes","setReadableContentTypes","access","getContentTypes","checkContentTypeAccess","creatable","readable","fromFieldValidations","items","linkContentTypeValidations","v","linkMimetypeGroupValidations","sizeValidations","isNumber","linkContentType","linkMimetypeGroup","useEditorPermissions","parameters","setCanCreateEntity","setCanLinkEntity","instance","showCreateEntityAction","checkCreateAccess","canCreate","showLinkEntityAction","checkLinkAccess","canRead","Editor","setValue","linkType","ids","linkActionsProps","customCardRenderer","cardProps","_","renderDefaultCard","renderCustomCard","SingleReferenceEditor","getCachedContentTypes","externalReset","getEntryTitle","entityHelpers","getEntityDescription","getEntryStatus","getEntryImage","scheduleIcon","isClickable","hasMoveOptions","WrappedEntryCard","setFile","localeCode","defaultLocaleCode","title","defaultTitle","description","EntryCard","href","entryUrl","selected","isSelected","statusIcon","thumbnailElement","isValidImage","cardDragHandleComponent","cardDragHandle","withDragHandle","dropdownListElements","onEdit","stopPropagation","onMoveTop","onMoveBottom","preventDefault","openEntry","entryId","options","bulkEditing","openBulkEditor","getSys","fieldId","FetchingWrappedEntryCard","viewType","entityKey","version","onRemoveEntry","renderCustomMissingEntityCard","defaultCard","loading","sharedCardProps","entityUrl","getEntityUrl","locales","builtinCardProps","renderedCustomCard","SingleEntryReferenceEditor","onLinkOrCreate","links","newItems","from","splice","emptyArray","nullableValue","link","onSortStart","onSortEnd","oldIndex","newIndex","arrayMove","onMove","MultipleReferenceEditor","containter","marginBottom","DragHandle","SortableHandle","CardDragHandle","SortableLink","SortableElement","SortableLinkList","SortableContainer","lastIndex","_value","MultipleEntryReferenceEditor","childrenProps","axis","useDragHandle","cardDropdown","truncated","overflow","whiteSpace","textOverflow","downloadAsset","window","open","renderAssetInfo","entityFile","mimeType","fileSize","image","shortenStorageUnit","renderActions","groupToIconMap","video","audio","richtext","presentation","spreadsheet","pdfdocument","archive","plaintext","code","markup","getFileType","groupName","mimetype","getGroupLabel","fallbackFileName","WrappedAssetCard","getAssetUrl","entityTitle","getAssetTitle","fields","AssetCard","Fragment","WrappedAssetLink","FetchingWrappedAssetCard","assetId","openAsset","commonProps","isLoading","customProps","SingleMediaEditor","gridContainter","flexWrap","MultipleMediaEditor"],"mappings":"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"}