{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable valid-jsdoc */\n\n/* eslint-disable jsdoc/require-param */\n\n/* eslint-disable @typescript-eslint/no-inferrable-types */\n\n\nimport { Property, Complex, ChildProperty } from '@syncfusion/ej2-base';\nimport { measureText, Rect, TextOption, Size, PathOption } from '@syncfusion/ej2-svg-base';\nimport { Font, Border, Margin, ContainerPadding } from '../model/base';\nimport { Theme } from '../model/theme';\nimport { subtractThickness, Thickness, drawSymbol, ChartLocation, titlePositionX, getTitle, textTrim, getTextAnchor } from '../utils/helper';\nimport { RectOption, textElement, stringToNumber } from '../utils/helper';\nimport { removeElement, showTooltip, getElement, appendChildElement } from '../utils/helper';\n/**\n * Configures the location for the legend.\n */\n\nvar Location =\n/** @class */\nfunction (_super) {\n  __extends(Location, _super);\n\n  function Location() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  __decorate([Property(0)], Location.prototype, \"x\", void 0);\n\n  __decorate([Property(0)], Location.prototype, \"y\", void 0);\n\n  return Location;\n}(ChildProperty);\n\nexport { Location };\n/**\n * Configures the legends in charts.\n */\n\nvar LegendSettings =\n/** @class */\nfunction (_super) {\n  __extends(LegendSettings, _super);\n\n  function LegendSettings() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  __decorate([Property(true)], LegendSettings.prototype, \"visible\", void 0);\n\n  __decorate([Property(null)], LegendSettings.prototype, \"height\", void 0);\n\n  __decorate([Property(null)], LegendSettings.prototype, \"width\", void 0);\n\n  __decorate([Complex({\n    x: 0,\n    y: 0\n  }, Location)], LegendSettings.prototype, \"location\", void 0);\n\n  __decorate([Property('Auto')], LegendSettings.prototype, \"position\", void 0);\n\n  __decorate([Property('Series')], LegendSettings.prototype, \"mode\", void 0);\n\n  __decorate([Property(8)], LegendSettings.prototype, \"padding\", void 0);\n\n  __decorate([Property('Center')], LegendSettings.prototype, \"alignment\", void 0);\n\n  __decorate([Complex(Theme.legendLabelFont, Font)], LegendSettings.prototype, \"textStyle\", void 0);\n\n  __decorate([Property(10)], LegendSettings.prototype, \"shapeHeight\", void 0);\n\n  __decorate([Property(10)], LegendSettings.prototype, \"shapeWidth\", void 0);\n\n  __decorate([Complex({}, Border)], LegendSettings.prototype, \"border\", void 0);\n\n  __decorate([Complex({\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0\n  }, Margin)], LegendSettings.prototype, \"margin\", void 0);\n\n  __decorate([Complex({\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0\n  }, ContainerPadding)], LegendSettings.prototype, \"containerPadding\", void 0);\n\n  __decorate([Property(5)], LegendSettings.prototype, \"shapePadding\", void 0);\n\n  __decorate([Property('transparent')], LegendSettings.prototype, \"background\", void 0);\n\n  __decorate([Property(1)], LegendSettings.prototype, \"opacity\", void 0);\n\n  __decorate([Property(true)], LegendSettings.prototype, \"toggleVisibility\", void 0);\n\n  __decorate([Property(null)], LegendSettings.prototype, \"description\", void 0);\n\n  __decorate([Property(3)], LegendSettings.prototype, \"tabIndex\", void 0);\n\n  __decorate([Property(null)], LegendSettings.prototype, \"title\", void 0);\n\n  __decorate([Complex(Theme.legendTitleFont, Font)], LegendSettings.prototype, \"titleStyle\", void 0);\n\n  __decorate([Property('Top')], LegendSettings.prototype, \"titlePosition\", void 0);\n\n  __decorate([Property(100)], LegendSettings.prototype, \"maximumTitleWidth\", void 0);\n\n  __decorate([Property(true)], LegendSettings.prototype, \"enablePages\", void 0);\n\n  __decorate([Property(false)], LegendSettings.prototype, \"isInversed\", void 0);\n\n  __decorate([Property(false)], LegendSettings.prototype, \"reverse\", void 0);\n\n  return LegendSettings;\n}(ChildProperty);\n\nexport { LegendSettings };\n/**\n * Legend base class for Chart and Accumulation chart.\n *\n * @private\n */\n\nvar BaseLegend =\n/** @class */\nfunction () {\n  /**\n   * Constructor for the dateTime module.\n   *\n   * @private\n   */\n  function BaseLegend(chart) {\n    this.pageXCollections = []; // pages of x locations\n\n    this.legendTitleCollections = [];\n    this.legendRegions = [];\n    this.pagingRegions = [];\n    this.chart = chart;\n    this.legend = chart.legendSettings;\n    this.legendID = chart.element.id + '_chart_legend';\n    this.isChartControl = chart.getModuleName() === 'chart';\n    this.isBulletChartControl = chart.getModuleName() === 'bulletChart';\n    this.isStockChartControl = chart.getModuleName() === 'stockChart';\n    this.bulletChart = this.chart;\n    this.fivePixel = 5;\n    this.rowCount = 0;\n    this.pageButtonSize = 8;\n    this.maxColumns = 0;\n    this.maxWidth = 0;\n    this.currentPage = 1;\n    this.backwardArrowOpacity = 0;\n    this.forwardArrowOpacity = 1;\n    this.arrowWidth = 2 * (this.fivePixel + this.pageButtonSize + this.fivePixel);\n    this.arrowHeight = this.arrowWidth;\n    this.isTop = false;\n    this.isTitle = false;\n    this.currentPageNumber = 1;\n  }\n  /**\n   * Calculate the bounds for the legends.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  BaseLegend.prototype.calculateLegendBounds = function (rect, availableSize, maxLabelSize) {\n    var legend = this.legend;\n    var defaultValue = this.isBulletChartControl ? '40%' : '20%';\n    this.getPosition(legend.position, availableSize);\n    this.legendBounds = new Rect(rect.x, rect.y, 0, 0);\n    this.isVertical = this.position === 'Left' || this.position === 'Right';\n\n    if (this.isVertical) {\n      this.legendBounds.height = stringToNumber(legend.height, availableSize.height - (rect.y - this.chart.margin.top)) || rect.height;\n      this.legendBounds.width = stringToNumber(legend.width || defaultValue, availableSize.width);\n    } else {\n      this.legendBounds.width = stringToNumber(legend.width, availableSize.width) || rect.width;\n      this.legendBounds.height = stringToNumber(legend.height || defaultValue, availableSize.height);\n    }\n\n    this.library.getLegendBounds(availableSize, this.legendBounds, legend);\n\n    if (!this.isBulletChartControl) {\n      this.legendBounds.width += this.legend.containerPadding.left + this.legend.containerPadding.right;\n      this.legendBounds.height += this.legend.containerPadding.top + this.legend.containerPadding.bottom;\n    }\n\n    this.getLocation(this.position, legend.alignment, this.legendBounds, rect, availableSize, maxLabelSize);\n  };\n  /**\n   * To find legend position based on available size for chart and accumulation chart\n   *\n   * @param position\n   * @param availableSize\n   * @param position\n   * @param availableSize\n   * @returns {void}\n   */\n\n\n  BaseLegend.prototype.getPosition = function (position, availableSize) {\n    var chart = this.chart;\n    var accumulation = this.chart;\n\n    if (this.isChartControl || this.isBulletChartControl || this.isStockChartControl) {\n      this.position = position !== 'Auto' ? position : 'Bottom';\n    } else {\n      if (position === 'Auto' && ((chart || accumulation).visibleSeries && (chart || accumulation).visibleSeries[0].type === 'Funnel' || (chart || accumulation).visibleSeries[0].type === 'Pyramid')) {\n        position = 'Top';\n      }\n\n      this.position = position !== 'Auto' ? position : availableSize.width > availableSize.height ? 'Right' : 'Bottom';\n    }\n  };\n  /**\n   * To set bounds for chart and accumulation chart\n   *\n   * @param computedWidth\n   * @param computedHeight\n   * @param legend\n   * @param legendBounds\n   * @param computedWidth\n   * @param computedHeight\n   * @param legend\n   * @param legendBounds\n   * @param computedWidth\n   * @param computedHeight\n   * @param legend\n   * @param legendBounds\n   * @param computedWidth\n   * @param computedHeight\n   * @param legend\n   * @param legendBounds\n   * @returns {void}\n   */\n\n\n  BaseLegend.prototype.setBounds = function (computedWidth, computedHeight, legend, legendBounds) {\n    var titleHeight = legend.title && legend.titlePosition === 'Top' ? this.legendTitleSize.height + this.fivePixel : 0;\n\n    if (this.isVertical && this.isPaging && !legend.enablePages && !this.isBulletChartControl) {\n      titleHeight = legend.title && legend.titlePosition === 'Top' ? this.legendTitleSize.height + this.fivePixel : 0;\n      titleHeight += this.pageButtonSize + this.fivePixel;\n    }\n\n    computedWidth = Math.min(computedWidth, legendBounds.width);\n    computedHeight = Math.min(computedHeight, legendBounds.height);\n\n    if (legend.mode === 'Gradient') {\n      legendBounds.width = legend.width ? legendBounds.width : this.isVertical ? computedWidth : 0.75 * legendBounds.width;\n      legendBounds.height = legend.height ? legendBounds.height : this.isVertical ? 0.75 * legendBounds.height : computedHeight;\n    } else {\n      legendBounds.width = !legend.width ? computedWidth : legendBounds.width;\n      legendBounds.height = !legend.height ? computedHeight : legendBounds.height;\n    }\n\n    if (!this.isBulletChartControl) {\n      if (this.isTop && legend.titleStyle.textOverflow !== 'None') {\n        this.calculateLegendTitle(legend, legendBounds);\n        legendBounds.height += legend.titleStyle.textOverflow === 'Wrap' && this.legendTitleCollections.length > 1 ? this.legendTitleSize.height - this.legendTitleSize.height / this.legendTitleCollections.length : 0;\n      }\n    }\n\n    this.rowCount = Math.max(1, Math.ceil((legendBounds.height - legend.padding - titleHeight) / (this.maxItemHeight + legend.padding)));\n  };\n  /**\n   * To find legend location based on position, alignment for chart and accumulation chart\n   *\n   * @param position\n   * @param alignment\n   * @param legendBounds\n   * @param rect\n   * @param availableSize\n   * @param maxLabelSize\n   * @param position\n   * @param alignment\n   * @param legendBounds\n   * @param rect\n   * @param availableSize\n   * @param maxLabelSize\n   * @param position\n   * @param alignment\n   * @param legendBounds\n   * @param rect\n   * @param availableSize\n   * @param maxLabelSize\n   * @param position\n   * @param alignment\n   * @param legendBounds\n   * @param rect\n   * @param availableSize\n   * @param maxLabelSize\n   * @param position\n   * @param alignment\n   * @param legendBounds\n   * @param rect\n   * @param availableSize\n   * @param maxLabelSize\n   * @param position\n   * @param alignment\n   * @param legendBounds\n   * @param rect\n   * @param availableSize\n   * @param maxLabelSize\n   */\n\n\n  BaseLegend.prototype.getLocation = function (position, alignment, legendBounds, rect, availableSize, maxLabelSize) {\n    var padding = this.legend.border.width;\n    var isBulletChart = this.isBulletChartControl;\n    var bulletChart = this.bulletChart;\n    var labelIns = bulletChart.labelPosition === 'Inside';\n    var ticklIns = bulletChart.tickPosition === 'Inside';\n    var isVertical = bulletChart.orientation === 'Vertical';\n    var categoryFieldValue = isBulletChart && bulletChart.categoryField !== '' ? maxLabelSize.width + this.chart.border.width + padding * 3 : 0;\n    var marginBottom = this.chart.margin.bottom;\n    var legendHeight = legendBounds.height + padding + this.legend.margin.top + this.legend.margin.bottom;\n    var legendWidth = legendBounds.width + padding + this.legend.margin.left + this.legend.margin.right;\n\n    if (position === 'Bottom') {\n      legendBounds.x = this.alignLegend(legendBounds.x, availableSize.width, legendBounds.width, alignment);\n      legendBounds.y = rect.y + (rect.height - legendHeight) + padding + this.legend.margin.top;\n      legendBounds.y += isBulletChart && !bulletChart.opposedPosition && !labelIns && !ticklIns && !isVertical ? bulletChart.majorTickLines.height + marginBottom + this.legend.border.width + padding * 2 : isVertical && bulletChart.categoryField !== '' ? maxLabelSize.height + padding * 2 : 0;\n      subtractThickness(rect, new Thickness(0, 0, 0, legendHeight));\n    } else if (position === 'Top') {\n      legendBounds.x = this.alignLegend(legendBounds.x, availableSize.width, legendBounds.width, alignment);\n      legendBounds.y = rect.y + padding + this.legend.margin.top;\n      legendBounds.y -= isBulletChart && bulletChart.opposedPosition && !labelIns && !ticklIns && !isVertical ? bulletChart.majorTickLines.height + this.chart.margin.top : 0;\n      legendHeight -= isBulletChart ? -padding * 2 : 0;\n      subtractThickness(rect, new Thickness(0, 0, legendHeight, 0));\n    } else if (position === 'Right') {\n      legendBounds.x = rect.x + (rect.width - legendBounds.width) - this.legend.margin.right;\n      legendBounds.y = rect.y + this.alignLegend(0, availableSize.height - (rect.y + marginBottom), legendBounds.height, alignment);\n      legendWidth += isBulletChart && bulletChart.opposedPosition && !labelIns && !ticklIns && isVertical ? this.chart.margin.left + this.chart.margin.right + bulletChart.majorTickLines.height : 0;\n      subtractThickness(rect, new Thickness(0, legendWidth, 0, 0));\n    } else if (position === 'Left') {\n      legendBounds.x = legendBounds.x + this.legend.margin.left;\n      legendBounds.y = rect.y + this.alignLegend(0, availableSize.height - (rect.y + marginBottom), legendBounds.height, alignment);\n      legendWidth += isBulletChart && !bulletChart.opposedPosition && !labelIns && !ticklIns && isVertical ? legendBounds.x - this.chart.margin.left + padding + bulletChart.majorTickLines.height : bulletChart.orientation !== 'Vertical' && bulletChart.categoryField !== '' ? categoryFieldValue : 0;\n      subtractThickness(rect, new Thickness(legendWidth, 0, 0, 0));\n    } else {\n      legendBounds.x = this.legend.location.x;\n      legendBounds.y = this.legend.location.y;\n      subtractThickness(rect, new Thickness(0, 0, 0, 0));\n    }\n  };\n  /**\n   * To find legend alignment for chart and accumulation chart\n   *\n   * @param start\n   * @param size\n   * @param legendSize\n   * @param alignment\n   * @param start\n   * @param size\n   * @param legendSize\n   * @param alignment\n   * @param start\n   * @param size\n   * @param legendSize\n   * @param alignment\n   * @param start\n   * @param size\n   * @param legendSize\n   * @param alignment\n   */\n\n\n  BaseLegend.prototype.alignLegend = function (start, size, legendSize, alignment) {\n    switch (alignment) {\n      case 'Far':\n        start = size - legendSize - start;\n        break;\n\n      case 'Center':\n        start = (size - legendSize) / 2;\n        break;\n    }\n\n    return start;\n  };\n  /**\n   * Renders the legend.\n   *\n   * @param chart\n   * @param legend\n   * @param legendBounds\n   * @param redraw\n   * @param chart\n   * @param legend\n   * @param legendBounds\n   * @param redraw\n   * @param chart\n   * @param legend\n   * @param legendBounds\n   * @param redraw\n   * @param chart\n   * @param legend\n   * @param legendBounds\n   * @param redraw\n   * @returns {void}\n   * @private\n   */\n\n\n  BaseLegend.prototype.renderLegend = function (chart, legend, legendBounds, redraw) {\n    var titleHeight = 0;\n    var titlePlusArrowWidth = 0;\n    var pagingLegendBounds = new Rect(0, 0, 0, 0);\n    var requireLegendBounds = new Rect(0, 0, 0, 0);\n    var firstLegend = this.findFirstLegendPosition(this.legendCollections);\n    var padding = legend.padding;\n    var isPaging = legend.enablePages;\n    var titlePosition = legend.titlePosition;\n    var upArrowHeight = this.isPaging && !legend.enablePages && this.isVertical ? this.pageButtonSize : 0;\n    var legendGroup = chart.renderer.createGroup({\n      id: this.legendID + '_g'\n    });\n    var legendTranslateGroup = this.createLegendElements(chart, legendBounds, legendGroup, legend, this.legendID, redraw);\n    this.legendRegions = [];\n    var maxHeight = 0;\n\n    for (var i = 0; i < this.legendCollections.length; i++) {\n      if (this.legendCollections[i].text !== '') {\n        maxHeight = Math.max(this.legendCollections[i].textSize.height, maxHeight);\n        break;\n      } else {\n        continue;\n      }\n    }\n\n    this.maxItemHeight = Math.max(maxHeight, legend.shapeHeight); // For new legend navigation\n\n    if (!isPaging && this.isPaging && !this.isVertical) {\n      titlePlusArrowWidth = !this.isTitle ? 0 : titlePosition === 'Left' ? this.legendTitleSize.width : 0;\n      titlePlusArrowWidth += this.pageButtonSize + 2 * this.fivePixel;\n    } else if (this.isTitle && !this.isPaging && !this.isVertical) {\n      titlePlusArrowWidth = titlePosition === (!this.isRtlEnable ? 'Left' : 'Right') ? this.fivePixel + this.legendTitleSize.width : 0;\n    }\n\n    titleHeight = !this.isTitle ? 0 : this.isTop || this.isVertical ? this.legendTitleSize.height : 0;\n\n    if (chart.legendSettings.mode === 'Gradient' && this.legendCollections.length > 1) {\n      this.getLinearLegend(legendBounds, chart, legend, legendTranslateGroup);\n      this.totalPages = 1;\n    } else if (firstLegend !== this.legendCollections.length) {\n      var legendSeriesGroup = void 0; // legendItem group for each series group element\n\n      var count = 0;\n      var previousLegend = this.legendCollections[firstLegend]; // starting shape center x,y position && to resolve lint error used new line for declaration\n\n      var startPadding = this.isBulletChartControl ? 0 : titlePlusArrowWidth + padding + legend.shapeWidth / 2 + legend.containerPadding.left;\n      var x_Location = this.isBulletChartControl ? legendBounds.x + titlePlusArrowWidth + padding + legend.shapeWidth / 2 : !this.isRtlEnable ? legendBounds.x + startPadding : legendBounds.x + (this.chart.getModuleName() === 'accumulationchart' && this.isVertical ? this.maxWidth : legendBounds.width) - startPadding;\n      var start = new ChartLocation(x_Location, this.isBulletChartControl ? legendBounds.y + titleHeight + upArrowHeight + padding + this.maxItemHeight / 2 : legendBounds.y + titleHeight + upArrowHeight + padding + this.maxItemHeight / 2 + legend.containerPadding.top);\n      var anchor = chart.isRtlEnabled || chart.enableRtl ? 'end' : 'start';\n      var textOptions = new TextOption('', start.x, start.y, anchor);\n      var textPadding = legend.shapePadding + padding + legend.shapeWidth; //  initialization for totalPages legend click totalpage again calculate\n\n      this.totalPages = this.totalPages = this.isChartControl || this.isBulletChartControl || this.isStockChartControl ? this.totalPages : 0;\n      this.pageXCollections = [];\n      this.legendCollections[firstLegend].location = start;\n      var legendIndex = void 0;\n\n      if (!legend.enablePages && this.isPaging) {\n        var x = start.x - this.fivePixel;\n        var y = start.y - this.fivePixel;\n        var leftSpace = this.isTitle && !this.isVertical && titlePosition === 'Left' ? this.legendTitleSize.width + this.fivePixel : 0;\n        var bottomSapce = this.isVertical ? this.pageButtonSize + Math.abs(y - legendBounds.y) : 0;\n        var rightSpace = this.isTitle && !this.isVertical && titlePosition === 'Right' ? this.legendTitleSize.width + this.fivePixel : 0;\n        rightSpace += this.isVertical ? 0 : this.fivePixel + this.pageButtonSize + this.fivePixel;\n        pagingLegendBounds = new Rect(x, y, legendBounds.width - rightSpace - leftSpace, legendBounds.height - bottomSapce);\n        requireLegendBounds = pagingLegendBounds;\n      } else {\n        requireLegendBounds = legendBounds;\n      }\n\n      for (var _i = 0, _a = this.legendCollections; _i < _a.length; _i++) {\n        var legendOption = _a[_i];\n        legendIndex = !this.isReverse ? count : this.legendCollections.length - 1 - count;\n\n        if (this.chart.getModuleName() === 'accumulationchart') {\n          // eslint-disable-next-line max-len\n          legendOption.fill = (this.chart || this.chart || this.chart).visibleSeries[0].points[legendOption.pointIndex].color;\n        }\n\n        if (this.chart.getModuleName() === 'stockChart') {\n          legendOption.type = this.chart.visibleSeries[count].type;\n        }\n\n        this.accessbilityText = this.isBulletChartControl ? 'Legend of bullet chart' + '' + legendOption.text : 'Click to show or hide the ' + legendOption.text + ' series';\n\n        if (legendOption.render && legendOption.text !== '') {\n          legendSeriesGroup = chart.renderer.createGroup({\n            id: this.legendID + this.generateId(legendOption, '_g_', legendIndex)\n          });\n\n          if (legendSeriesGroup) {\n            legendSeriesGroup.setAttribute('tabindex', legend.tabIndex.toString());\n            legendSeriesGroup.setAttribute('aria-label', legend.description || this.accessbilityText);\n          }\n\n          this.library.getRenderPoint(legendOption, start, textPadding, previousLegend, requireLegendBounds, count, firstLegend);\n          this.renderSymbol(legendOption, legendSeriesGroup, legendIndex);\n          this.renderText(chart, legendOption, legendSeriesGroup, textOptions, count, legendIndex);\n\n          if (legendSeriesGroup) {\n            legendSeriesGroup.setAttribute('style', 'outline: none; cursor: ' + (!legend.toggleVisibility && (chart.selectionMode === 'None' || chart.highlightMode === 'None' || chart.selectionMode === 'None') || this.isBulletChartControl ? 'auto' : 'pointer'));\n          }\n\n          if (legendTranslateGroup) {\n            legendTranslateGroup.appendChild(legendSeriesGroup);\n          }\n\n          previousLegend = legendOption;\n        }\n\n        count++;\n      }\n\n      if (this.isPaging) {\n        this.renderPagingElements(chart, legendBounds, textOptions, legendGroup);\n      } else {\n        this.totalPages = 1;\n      }\n    }\n\n    appendChildElement(chart.enableCanvas, chart.svgObject, legendGroup, redraw);\n  };\n  /** @private */\n\n\n  BaseLegend.prototype.getLinearLegend = function (legendBounds, chart, legend, legendTranslateGroup) {\n    var xmlns = 'http://www.w3.org/2000/svg';\n    var previousLegend = this.legendCollections[0];\n    var nextLegend = this.legendCollections[1];\n    var defElement = this.chart.renderer.createDefs();\n    var gradientLegendCount = 0;\n    var linerGradientEle = document.createElementNS(xmlns, 'linearGradient');\n    var opacity = 1;\n    var fillColors = [];\n    var numberItems = [];\n\n    if (legend.title) {\n      if (!this.isVertical) {\n        if (legend.titlePosition === 'Left') {\n          legendBounds.x += this.legendTitleSize.width;\n          legendBounds.width -= this.legendTitleSize.width;\n        } else if (legend.titlePosition === 'Right') {\n          legendBounds.width -= this.legendTitleSize.width;\n        } else if (legend.titlePosition === 'Top') {\n          legendBounds.y += this.legendTitleSize.height;\n          legendBounds.height -= this.legendTitleSize.height;\n        }\n      } else {\n        legendBounds.y += this.legendTitleSize.height;\n        legendBounds.height -= this.legendTitleSize.height;\n      }\n    }\n\n    for (var _i = 0, _a = this.chart.rangeColorSettings; _i < _a.length; _i++) {\n      var colorMap = _a[_i];\n\n      if (numberItems.indexOf(colorMap.start) < 0) {\n        numberItems.push(colorMap.start);\n      }\n\n      if (colorMap.colors.length > 2) {\n        var diffValue = colorMap.end - colorMap.start;\n        var colorsLength = colorMap.colors.length - 1;\n\n        if (diffValue > 0) {\n          diffValue = diffValue / colorsLength;\n\n          for (var index = 1; index < colorsLength; index++) {\n            var calculatedValue = colorMap.start + diffValue * index;\n            numberItems.push(calculatedValue);\n          }\n        } else {\n          for (var index = 1; index < colorsLength; index++) {\n            numberItems.push(colorMap.start);\n          }\n        }\n      }\n\n      if (numberItems.indexOf(colorMap.end) < 0) {\n        numberItems.push(colorMap.end);\n      }\n\n      for (var _b = 0, _c = colorMap.colors; _b < _c.length; _b++) {\n        var fillColor = _c[_b];\n\n        if (fillColors.indexOf(fillColor) < 0) {\n          fillColors.push(fillColor);\n        }\n      }\n\n      if (colorMap.colors.length > 0 && colorMap.colors.length < 2) {\n        fillColors.push(colorMap.colors[0]);\n      }\n    }\n\n    var x1 = this.isRtlEnable && !this.isVertical ? '100%' : '0%';\n    var x2 = this.isVertical || this.isRtlEnable ? '0%' : '100%';\n    var y2 = this.isVertical ? '100%' : '0%';\n    linerGradientEle.setAttribute('id', this.generateId(previousLegend, 'linearGradient', gradientLegendCount));\n    linerGradientEle.setAttribute('x1', x1);\n    linerGradientEle.setAttribute('y1', '0%');\n    linerGradientEle.setAttribute('x2', x2);\n    linerGradientEle.setAttribute('y2', y2);\n    var full = numberItems[numberItems.length - 1] - numberItems[0];\n\n    for (var b = 0; b < fillColors.length; b++) {\n      var offsetValue = numberItems[b] - numberItems[0];\n      offsetValue = offsetValue / full;\n      var stopEle = document.createElementNS(xmlns, 'stop');\n      stopEle.setAttribute('offset', offsetValue.toString());\n      stopEle.setAttribute('stop-color', fillColors[b]);\n      stopEle.setAttribute('stop-opacity', opacity.toString());\n      linerGradientEle.appendChild(stopEle);\n    }\n\n    var startLabel = previousLegend.text.toString();\n    var endLabel = nextLegend.text.toString();\n    var startTextSize = measureText(startLabel, legend.textStyle);\n    var endTextSize = measureText(endLabel, legend.textStyle);\n    var textWidth = startTextSize.width > endTextSize.width ? startTextSize.width : endTextSize.width;\n    var textHeight = startTextSize.height > endTextSize.height ? startTextSize.height : endTextSize.height;\n    var otherSpaces = 2 * textWidth + 4 * legend.padding;\n    var linearBarWidth = legendBounds.width;\n    var linearBarHeight = legendBounds.height;\n    var xValue = legendBounds.x + textWidth + 2 * legend.padding;\n    var yValue = legendBounds.y + legend.padding;\n    var startLabelY;\n    var endLabelY;\n    var startLabelX;\n    var endLabelX;\n\n    if (this.isVertical) {\n      otherSpaces = 2 * textHeight + 4 * legend.padding;\n      linearBarWidth = legendBounds.width - 2 * legend.padding;\n      linearBarHeight = legendBounds.height - otherSpaces;\n      xValue = legendBounds.x + legend.padding;\n      yValue = legendBounds.y + textHeight + 2 * legend.padding;\n      startLabelY = legendBounds.y + legend.padding + textHeight;\n      endLabelY = yValue + linearBarHeight + textHeight;\n      startLabelX = legendBounds.x + legendBounds.width * 0.5 - textWidth * 0.5;\n      endLabelX = startLabelX;\n\n      if (linearBarWidth > 30) {\n        var diffWidth = linearBarWidth - 30;\n        linearBarWidth = 30;\n        xValue = xValue + diffWidth / 2;\n      }\n    } else {\n      linearBarWidth = legendBounds.width - otherSpaces;\n      linearBarHeight = legendBounds.height - 2 * legend.padding;\n      startLabelX = legendBounds.x + (!this.isRtlEnable ? legend.padding + (textWidth - startTextSize.width) : linearBarWidth + 3 * legend.padding + textWidth);\n      endLabelX = legendBounds.x + (!this.isRtlEnable ? linearBarWidth + 3 * legend.padding + textWidth : legend.padding + (textWidth - endTextSize.width));\n      startLabelY = legendBounds.y + legendBounds.height * 0.5 + textHeight * 0.25;\n      endLabelY = startLabelY;\n\n      if (linearBarHeight > 30) {\n        var diffHeight = linearBarHeight - 30;\n        linearBarHeight = 30;\n        yValue = yValue + diffHeight / 2;\n      }\n    }\n\n    var anchor = chart.enableRtl ? 'end' : '';\n    var textOptions = new TextOption('', startLabelX, startLabelY, anchor, startLabel);\n    var hiddenColor = '#D3D3D3';\n    textOptions.id = this.legendID + this.generateId(previousLegend, '_text_', 1);\n    var fontcolor = previousLegend.visible ? legend.textStyle.color || chart.themeStyle.legendLabel : hiddenColor;\n    var isCanvas = this.isStockChartControl ? false : this.chart.enableCanvas;\n    textElement(chart.renderer, textOptions, legend.textStyle, fontcolor, legendTranslateGroup, false, false, false, false, // tslint:disable-next-line:align\n    null, this.currentPageNumber && isCanvas ? new Rect(0, -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber), 0, 0) : null);\n    textOptions = new TextOption('', endLabelX, endLabelY, anchor, endLabel);\n    textOptions.id = this.legendID + this.generateId(previousLegend, '_text_', 2);\n    textElement(chart.renderer, textOptions, legend.textStyle, fontcolor, legendTranslateGroup, false, false, false, false, // tslint:disable-next-line:align\n    null, this.currentPageNumber && isCanvas ? new Rect(0, -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber), 0, 0) : null);\n    var gradientLegend = chart.renderer.drawRectangle({\n      width: linearBarWidth,\n      height: linearBarHeight,\n      x: xValue,\n      y: yValue,\n      fill: 'url(#' + this.generateId(previousLegend, 'linearGradient', gradientLegendCount) + ')'\n    });\n    defElement.appendChild(linerGradientEle);\n    legendTranslateGroup.appendChild(defElement);\n    legendTranslateGroup.appendChild(gradientLegend);\n  };\n  /**\n   * To find first valid legend text index for chart and accumulation chart\n   *\n   * @param legendCollection\n   * @returns {number}\n   * @private\n   */\n\n\n  BaseLegend.prototype.findFirstLegendPosition = function (legendCollection) {\n    var count = 0;\n\n    for (var _i = 0, legendCollection_1 = legendCollection; _i < legendCollection_1.length; _i++) {\n      var legend = legendCollection_1[_i];\n\n      if (legend.render && legend.text !== '') {\n        break;\n      }\n\n      count++;\n    }\n\n    return count;\n  };\n  /**\n   * To get the legend title text width and height.\n   *\n   * @param legend\n   * @param legendBounds\n   */\n\n\n  BaseLegend.prototype.calculateLegendTitle = function (legend, legendBounds) {\n    if (legend.title) {\n      this.isTop = legend.titlePosition === 'Top';\n      var padding = legend.titleStyle.textOverflow === 'Trim' ? 2 * legend.padding : 0;\n\n      if (this.isTop || this.isVertical) {\n        this.legendTitleCollections = getTitle(legend.title, legend.titleStyle, legendBounds.width - padding);\n      } else {\n        this.legendTitleCollections[0] = textTrim(legend.maximumTitleWidth, legend.title, legend.titleStyle);\n      }\n\n      var text = this.isTop ? legend.title : this.legendTitleCollections[0];\n      this.legendTitleSize = measureText(text, legend.titleStyle);\n      this.legendTitleSize.height *= this.legendTitleCollections.length;\n    } else {\n      this.legendTitleSize = new Size(0, 0);\n    }\n  };\n  /**\n   * Render the legend title\n   *\n   * @param chart\n   * @param legend\n   * @param legendBounds\n   * @param legendGroup\n   */\n\n\n  BaseLegend.prototype.renderLegendTitle = function (chart, legend, legendBounds, legendGroup) {\n    var padding = legend.padding;\n    var alignment = legend.titleStyle.textAlignment;\n    this.isTop = legend.titlePosition === 'Top';\n    var anchor = getTextAnchor(legend.titleStyle.textAlignment, chart.enableRtl);\n    var x = titlePositionX(legendBounds, legend.titleStyle);\n    anchor = this.isTop || this.isVertical ? anchor : chart.enableRtl ? 'end' : '';\n    x = alignment === 'Near' ? x + padding : alignment === 'Far' ? x - padding : x;\n    x = this.isTop || this.isVertical ? x : legendBounds.x + (legend.titlePosition === 'Left' ? 5 : legendBounds.width - this.legendTitleSize.width - 5);\n    var topPadding = legendBounds.height / 2 + this.legendTitleSize.height / 4;\n    var y = legendBounds.y + (!this.isTop && !this.isVertical ? topPadding : this.legendTitleSize.height / this.legendTitleCollections.length);\n    var legendTitleTextOptions = new TextOption(this.legendID + '_title', x, y, anchor, this.legendTitleCollections);\n    textElement(chart.renderer, legendTitleTextOptions, legend.titleStyle, legend.titleStyle.color, legendGroup);\n  };\n  /**\n   * To create legend rendering elements for chart and accumulation chart\n   *\n   * @param chart\n   * @param legendBounds\n   * @param legendGroup\n   * @param legend\n   * @param id\n   * @param redraw\n   */\n\n\n  BaseLegend.prototype.createLegendElements = function (chart, legendBounds, legendGroup, legend, id, redraw) {\n    var padding = legend.padding;\n    var options = new RectOption(id + '_element', legend.background, legend.border, legend.opacity, legendBounds);\n    var legendItemsGroup = chart.renderer.createGroup({\n      id: id + '_collections'\n    });\n    var isCanvas = this.isStockChartControl ? false : chart.enableCanvas;\n    var clippath = chart.renderer.createClipPath({\n      id: id + '_clipPath'\n    });\n    options.width = this.isRtlEnable && this.chart.getModuleName() === 'accumulationchart' && this.isVertical ? this.maxWidth : legendBounds.width;\n\n    if (legendGroup) {\n      legendGroup.appendChild(chart.renderer.drawRectangle(options));\n    } else {\n      chart.renderer.drawRectangle(options);\n    }\n\n    if (legend.title) {\n      this.renderLegendTitle(chart, legend, legendBounds, legendGroup);\n    }\n\n    if (!isCanvas) {\n      legendGroup.appendChild(legendItemsGroup);\n    }\n\n    this.legendTranslateGroup = chart.renderer.createGroup({\n      id: id + '_translate_g'\n    });\n\n    if (!isCanvas) {\n      legendItemsGroup.appendChild(this.legendTranslateGroup);\n    }\n\n    options.y += padding + (this.isTop ? this.legendTitleSize.height : 0);\n    options.id += '_clipPath_rect';\n    options.width = !this.isChartControl && chart.getModuleName() !== 'bulletChart' && !this.isStockChartControl && this.isVertical ? this.maxWidth - padding + legend.containerPadding.left + legend.containerPadding.right : legendBounds.width;\n\n    if (!isCanvas) {\n      this.clipRect = chart.renderer.drawRectangle(options);\n      clippath.appendChild(this.clipRect);\n    } else {\n      this.pagingClipRect = options;\n    }\n\n    appendChildElement(isCanvas, chart.svgObject, clippath, redraw);\n\n    if (!isCanvas) {\n      legendItemsGroup['style'] = 'clip-path:url(#' + clippath.id + ')';\n    }\n\n    return this.legendTranslateGroup;\n  };\n  /**\n   * To render legend symbols for chart and accumulation chart\n   *\n   * @param legendOption\n   * @param group\n   * @param i\n   * @param legendOption\n   * @param group\n   * @param i\n   * @param legendOption\n   * @param group\n   * @param i\n   */\n\n\n  BaseLegend.prototype.renderSymbol = function (legendOption, group, legendIndex) {\n    var control = this.isBulletChartControl ? this.chart : null;\n    var symbolColor = legendOption.visible ? legendOption.fill : '#D3D3D3';\n    var isStrokeWidth = (this.chart.getModuleName() === 'chart' || this.chart.getModuleName() === 'stockChart') && legendOption.shape === 'SeriesType' && legendOption.type.toLowerCase().indexOf('line') > -1 && legendOption.type.toLowerCase().indexOf('area') === -1;\n    var isCustomBorder = (this.chart.getModuleName() === 'chart' || this.chart.getModuleName() === 'stockChart') && (legendOption.type === 'Scatter' || legendOption.type === 'Bubble');\n    var isCanvas = this.isStockChartControl ? false : this.chart.enableCanvas;\n    var borderColor;\n    var shape = legendOption.shape === 'SeriesType' ? legendOption.type : legendOption.shape;\n    var strokewidth = isStrokeWidth ? this.legend.mode === 'Series' ? this.chart.visibleSeries[legendIndex].width : this.chart.visibleSeries[0].width : this.isBulletChartControl && legendOption.shape === 'Multiply' ? 4 : 1;\n    var regionPadding;\n    shape = shape === 'Scatter' ? legendOption.markerShape : shape;\n\n    if (isCustomBorder && legendIndex < this.chart.visibleSeries.length) {\n      var seriesBorder = this.chart.visibleSeries[legendIndex].border;\n      borderColor = seriesBorder.color ? seriesBorder.color : symbolColor;\n      strokewidth = seriesBorder.width ? seriesBorder.width : 1;\n    }\n\n    var symbolOption = new PathOption(this.legendID + this.generateId(legendOption, '_shape_', legendIndex), symbolColor, strokewidth, isCustomBorder ? borderColor : symbolColor, 1, '', '');\n    var textSize = measureText(legendOption.text, this.legend.textStyle);\n    var x = this.legend.isInversed && !this.isRtlEnable ? legendOption.location.x + textSize.width + this.legend.shapePadding : legendOption.location.x;\n    var y = legendOption.location.y;\n\n    if (!isCanvas) {\n      group.appendChild(drawSymbol({\n        x: x,\n        y: y\n      }, shape, new Size(this.legend.shapeWidth, this.legend.shapeHeight), legendOption.url, symbolOption, this.accessbilityText, this.chart.renderer, null, this.isBulletChartControl, control));\n    } else {\n      regionPadding = -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber);\n      drawSymbol({\n        x: x,\n        y: y\n      }, shape, new Size(this.legend.shapeWidth, this.legend.shapeHeight), '', symbolOption, this.accessbilityText, this.chart.renderer, this.currentPageNumber ? new Rect(0, regionPadding, 0, 0) : null, this.isBulletChartControl, control);\n      this.legendRegions.push({\n        rect: new Rect(legendOption.location.x, legendOption.location.y, this.legend.shapeWidth, this.legend.shapeHeight + regionPadding),\n        index: legendIndex\n      });\n    }\n\n    if (shape === 'Line' && legendOption.markerVisibility && legendOption.markerShape !== 'Image' || legendOption.type === 'Doughnut' && shape === 'Doughnut') {\n      symbolOption.id = this.legendID + this.generateId(legendOption, '_shape_marker_', legendIndex);\n      shape = legendOption.type === 'Doughnut' ? 'Circle' : legendOption.markerShape;\n      symbolOption.fill = legendOption.type === 'Doughnut' ? '#FFFFFF' : symbolOption.fill;\n\n      if (!isCanvas) {\n        // eslint-disable-next-line max-len\n        group.appendChild(drawSymbol({\n          x: x,\n          y: y\n        }, shape, new Size(this.legend.shapeWidth / 2, this.legend.shapeHeight / 2), '', symbolOption, this.accessbilityText, null, null, this.isBulletChartControl, control));\n      } else {\n        drawSymbol({\n          x: x,\n          y: y\n        }, shape, new Size(this.legend.shapeWidth / 2, this.legend.shapeHeight / 2), '', symbolOption, this.accessbilityText, this.chart.renderer, this.currentPageNumber ? new Rect(0, -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber), 0, 0) : null, this.isBulletChartControl, control);\n      }\n    }\n  };\n  /**\n   * To render legend text for chart and accumulation chart\n   *\n   * @param chart\n   * @param legendOption\n   * @param group\n   * @param textOptions\n   * @param i\n   * @param chart\n   * @param legendOption\n   * @param group\n   * @param textOptions\n   * @param i\n   * @param chart\n   * @param legendOption\n   * @param group\n   * @param textOptions\n   * @param i\n   * @param chart\n   * @param legendOption\n   * @param group\n   * @param textOptions\n   * @param i\n   * @param chart\n   * @param legendOption\n   * @param group\n   * @param textOptions\n   * @param i\n   */\n\n\n  BaseLegend.prototype.renderText = function (chart, legendOption, group, textOptions, i, legendIndex) {\n    var legend = chart.legendSettings;\n    var hiddenColor = '#D3D3D3';\n    var fontcolor = legendOption.visible ? legend.textStyle.color || chart.themeStyle.legendLabel : hiddenColor;\n    var isCanvas = this.isStockChartControl ? false : this.chart.enableCanvas;\n    textOptions.id = this.legendID + this.generateId(legendOption, '_text_', legendIndex);\n    textOptions.text = legendOption.text;\n\n    if (legend.isInversed && !this.isRtlEnable) {\n      textOptions.x = legendOption.location.x - legend.shapeWidth / 2;\n    } else if (this.isRtlEnable) {\n      textOptions.x = legendOption.location.x - (measureText(legendOption.text, legend.textStyle).width + legend.shapeWidth / 2 + legend.shapePadding);\n    } else {\n      textOptions.x = legendOption.location.x + legend.shapeWidth / 2 + legend.shapePadding;\n    }\n\n    textOptions.y = legendOption.location.y + this.maxItemHeight / 4;\n    var element = textElement(chart.renderer, textOptions, legend.textStyle, fontcolor, group, false, false, false, false, null, this.currentPageNumber && isCanvas ? new Rect(0, -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber), 0, 0) : null);\n\n    if (element) {\n      element.setAttribute('aria-label', legend.description || this.accessbilityText);\n    }\n\n    if (isCanvas) {\n      var textSize = measureText(textOptions.text, legend.textStyle);\n      this.legendRegions[i].rect.y = textOptions.y < this.legendRegions[i].rect.y ? textOptions.y : this.legendRegions[i].rect.y;\n      this.legendRegions[i].rect.width += textSize.width;\n      this.legendRegions[i].rect.height = textSize.height;\n      this.legendRegions[i].rect.y -= textSize.height * 0.5;\n      this.legendRegions[i].rect.x -= this.isRtlEnable ? this.legendRegions[i].rect.width : 0;\n    }\n  };\n  /**\n   * To render legend paging elements for chart and accumulation chart\n   *\n   * @param chart\n   * @param bounds\n   * @param textOption\n   * @param legendGroup\n   * @param chart\n   * @param bounds\n   * @param textOption\n   * @param legendGroup\n   * @param chart\n   * @param bounds\n   * @param textOption\n   * @param legendGroup\n   * @param chart\n   * @param bounds\n   * @param textOption\n   * @param legendGroup\n   */\n  // tslint:disable-next-line:max-func-body-length\n\n\n  BaseLegend.prototype.renderPagingElements = function (chart, bounds, textOption, legendGroup) {\n    var paginggroup = chart.renderer.createGroup({\n      id: this.legendID + '_navigation'\n    });\n    var isCanvas = this.isStockChartControl ? false : chart.enableCanvas;\n    var titleHeight = this.isBulletChartControl ? 0 : this.legendTitleSize.height;\n    var grayColor = this.chart.theme.indexOf('Dark') > -1 ? '#FFFFFF' : '#545454';\n    var legend = chart.legendSettings; // to solve parameter lint error, legend declaration is here\n\n    var padding = 8; // const padding for paging elements\n\n    var pageUp = this.legendID + (!this.isRtlEnable ? '_pageup' : '_pagedown');\n    var pageDown = this.legendID + (!this.isRtlEnable ? '_pagedown' : '_pageup');\n    var symbolOption = new PathOption(pageUp, 'transparent', 5, grayColor, 1, '', '');\n    var iconSize = this.pageButtonSize; // Page left arrow drawing calculation started here\n\n    var rowCount = !legend.enablePages && this.isPaging && !this.isVertical && !this.isBulletChartControl ? 1 : this.rowCount - 1;\n    var titleWidth = this.isTitle && legend.titlePosition === 'Left' ? this.legendTitleSize.width : 0;\n    this.pagingRegions = [];\n    this.backwardArrowOpacity = this.currentPage !== 1 ? 1 : 0;\n    this.forwardArrowOpacity = this.currentPage === this.totalPages ? 0 : 1;\n\n    if (!isCanvas) {\n      legendGroup.appendChild(paginggroup);\n    }\n\n    if (this.isChartControl || this.isBulletChartControl || this.isStockChartControl || !this.isVertical) {\n      this.totalPages = Math.ceil(this.totalPages / Math.max(1, this.rowCount - 1));\n    } else {\n      this.totalPages = Math.ceil(this.totalPages / this.maxColumns);\n    }\n\n    if (paginggroup) {\n      paginggroup.setAttribute('style', 'cursor: pointer');\n    }\n\n    this.clipPathHeight = rowCount * (this.maxItemHeight + legend.padding);\n\n    if (!isCanvas) {\n      this.clipRect.setAttribute('height', this.clipPathHeight.toString());\n    } else {\n      //paging clipRect only for canvas mode\n      this.pagingClipRect.height = this.legendBounds.height - this.clipPathHeight - (this.pagingClipRect.y - this.legendBounds.y) - legend.border.width;\n      this.pagingClipRect.y = this.pagingClipRect.y + this.clipPathHeight;\n      this.pagingClipRect.x += legend.border.width;\n      this.pagingClipRect.width -= legend.border.width + legend.border.width / 2;\n      this.chart.renderer.clearRect(new Rect(this.pagingClipRect.x, this.pagingClipRect.y, this.pagingClipRect.width, this.pagingClipRect.height));\n    }\n\n    var pageTextElement;\n    var x = bounds.x + iconSize / 2;\n    var y = bounds.y + this.clipPathHeight + (titleHeight + bounds.height - this.clipPathHeight) / 2;\n\n    if (this.isPaging && !legend.enablePages && !this.isVertical && !this.isBulletChartControl) {\n      x = bounds.x + this.fivePixel + this.pageButtonSize + titleWidth;\n      y = legend.title && this.isTop ? bounds.y + padding + titleHeight + iconSize / 1 + 0.5 : bounds.y + padding + iconSize + 0.5;\n    }\n\n    var size = measureText(this.totalPages + '/' + this.totalPages, legend.textStyle);\n    var translateX = this.isRtlEnable ? legend.border.width + iconSize / 2 : bounds.width - (2 * (iconSize + padding) + padding + size.width);\n\n    if (!isCanvas) {\n      if (this.isVertical && !legend.enablePages && !this.isBulletChartControl) {\n        x = bounds.x + bounds.width / 2;\n        y = bounds.y + iconSize / 2 + padding + titleHeight;\n        symbolOption.opacity = this.backwardArrowOpacity;\n        paginggroup.appendChild(drawSymbol({\n          x: x,\n          y: y\n        }, 'UpArrow', new Size(iconSize, iconSize), '', symbolOption, 'UpArrow'));\n      } else {\n        symbolOption.opacity = this.isBulletChartControl ? symbolOption.opacity : legend.enablePages ? 1 : !this.isRtlEnable ? this.backwardArrowOpacity : this.forwardArrowOpacity;\n        paginggroup.appendChild(drawSymbol({\n          x: x,\n          y: y\n        }, 'LeftArrow', new Size(iconSize, iconSize), '', symbolOption, 'LeftArrow'));\n      }\n    } else {\n      drawSymbol({\n        x: x,\n        y: y\n      }, 'LeftArrow', new Size(iconSize, iconSize), '', symbolOption, 'LeftArrow', this.chart.renderer, new Rect(translateX, 0, 0, 0));\n    }\n\n    this.pagingRegions.push(new Rect(!this.isRtlEnable ? x + bounds.width - (2 * (iconSize + padding) + padding + size.width) - iconSize * 0.5 : x, y - iconSize * 0.5, iconSize, iconSize)); // Page numbering rendering calculation started here\n\n    textOption.x = x + iconSize / 2 + padding;\n    textOption.y = y + size.height / 4;\n    textOption.id = this.legendID + '_pagenumber';\n    textOption.text = !this.isRtlEnable ? '1/' + this.totalPages : this.totalPages + '/1';\n    var color = this.chart.theme.indexOf('Dark') > -1 ? '#FFFFFF' : legend.textStyle.color;\n\n    if (isCanvas && this.totalNoOfPages) {\n      textOption.text = !this.isRtlEnable ? this.currentPageNumber + '/' + this.totalNoOfPages : this.totalNoOfPages + '/' + this.currentPageNumber;\n    }\n\n    if (legend.enablePages || this.isBulletChartControl) {\n      pageTextElement = textElement(chart.renderer, textOption, legend.textStyle, color, paginggroup, false, false, false, false, null, new Rect(translateX, 0, 0, 0));\n    } // Page right arrow rendering calculation started here\n\n\n    x = textOption.x + padding + iconSize / 2 + size.width;\n\n    if (this.isPaging && !legend.enablePages && !this.isVertical) {\n      x = bounds.x + bounds.width - this.fivePixel - this.pageButtonSize - (legend.title && legend.titlePosition === 'Right' ? this.legendTitleSize.width + this.fivePixel : 0);\n    }\n\n    symbolOption.id = pageDown;\n    symbolOption.opacity = !legend.enablePages ? !this.isRtlEnable ? this.forwardArrowOpacity : this.backwardArrowOpacity : 1;\n\n    if (!isCanvas) {\n      if (this.isVertical && !legend.enablePages && !this.isBulletChartControl) {\n        x = bounds.x + bounds.width / 2;\n        y = bounds.y + bounds.height - iconSize / 2 - padding;\n        paginggroup.appendChild(drawSymbol({\n          x: x,\n          y: y\n        }, 'DownArrow', new Size(iconSize, iconSize), '', symbolOption, 'DownArrow'));\n      } else {\n        paginggroup.appendChild(drawSymbol({\n          x: x,\n          y: y\n        }, 'RightArrow', new Size(iconSize, iconSize), '', symbolOption, 'RightArrow'));\n      }\n    } else {\n      drawSymbol({\n        x: x,\n        y: y\n      }, 'RightArrow', new Size(iconSize, iconSize), '', symbolOption, 'RightArrow', this.chart.renderer, new Rect(translateX, 0, 0, 0));\n    }\n\n    this.pagingRegions.push(new Rect(!this.isRtlEnable ? x + (bounds.width - (2 * (iconSize + padding) + padding + size.width) - iconSize * 0.5) : x, y - iconSize * 0.5, iconSize, iconSize));\n\n    if (!isCanvas && (legend.enablePages || this.isBulletChartControl)) {\n      //placing the navigation buttons and page numbering in legend right corner\n      paginggroup.setAttribute('transform', 'translate(' + translateX + ', ' + 0 + ')');\n    } else {\n      if (this.currentPageNumber === 1 && this.calTotalPage && (legend.enablePages || this.isBulletChartControl)) {\n        this.totalNoOfPages = this.totalPages;\n        this.calTotalPage = false;\n      }\n\n      if (!legend.enablePages && !this.isBulletChartControl) {\n        // For new legend page navigation\n        this.translatePage(null, this.currentPage - 1, this.currentPage, legend);\n      }\n    }\n\n    if (legend.enablePages || this.isBulletChartControl) {\n      this.translatePage(pageTextElement, this.currentPage - 1, this.currentPage, legend);\n    }\n  };\n  /**\n   * To translate legend pages for chart and accumulation chart\n   *\n   * @param pagingText\n   * @param page\n   * @param pageNumber\n   * @param legend\n   * @param pagingText\n   * @param page\n   * @param pageNumber\n   * @param legend\n   * @param pagingText\n   * @param page\n   * @param pageNumber\n   * @param legend\n   * @param pagingText\n   * @param page\n   * @param pageNumber\n   * @param legend\n   */\n\n\n  BaseLegend.prototype.translatePage = function (pagingText, page, pageNumber, legend) {\n    var size = this.clipPathHeight * page;\n    var translate = 'translate(0,-' + size + ')';\n\n    if (!this.isChartControl && !this.isBulletChartControl && !this.isStockChartControl && this.isVertical) {\n      var pageX = this.pageXCollections[page * this.maxColumns];\n      size = !this.isRtlEnable ? pageX - this.legendBounds.x : this.legendBounds.x + this.maxWidth - pageX;\n      size = size < 0 ? 0 : size; // to avoid small pixel variation\n\n      translate = (!this.isRtlEnable ? 'translate(-' : 'translate(') + size + ',0)';\n    }\n\n    if (!this.chart.enableCanvas) {\n      this.legendTranslateGroup.setAttribute('transform', translate);\n    }\n\n    if (!this.chart.enableCanvas && (legend.enablePages || this.isBulletChartControl)) {\n      pagingText.textContent = !this.isRtlEnable ? pageNumber + '/' + this.totalPages : this.totalPages + '/' + pageNumber;\n    }\n\n    this.currentPage = pageNumber;\n    return size;\n  };\n  /**\n   * To change legend pages for chart and accumulation chart\n   *\n   * @param event\n   * @param pageUp\n   * @param event\n   * @param pageUp\n   */\n\n\n  BaseLegend.prototype.changePage = function (event, pageUp) {\n    var legend = this.chart.legendSettings;\n    var backwardArrow = document.getElementById(this.legendID + '_pageup');\n    var forwardArrow = document.getElementById(this.legendID + '_pagedown');\n    var pageText = legend.enablePages || this.isBulletChartControl ? document.getElementById(this.legendID + '_pagenumber') : null;\n    var page = legend.enablePages || this.isBulletChartControl ? parseInt(pageText.textContent.split('/')[!this.isRtlEnable ? 0 : 1], 10) : this.currentPage;\n\n    if (pageUp && page > 1) {\n      this.translatePage(pageText, page - 2, page - 1, legend);\n    } else if (!pageUp && page < this.totalPages) {\n      this.translatePage(pageText, page, page + 1, legend);\n    }\n\n    if (this.isPaging && !legend.enablePages && !this.isBulletChartControl) {\n      // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n      this.currentPage === this.totalPages ? this.hideArrow(forwardArrow) : this.showArrow(forwardArrow); // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n\n      this.currentPage === 1 ? this.hideArrow(backwardArrow) : this.showArrow(backwardArrow);\n    }\n  };\n  /**\n   * To hide the backward and forward arrow\n   *\n   * @param arrowElement\n   */\n\n\n  BaseLegend.prototype.hideArrow = function (arrowElement) {\n    arrowElement.setAttribute('opacity', '0');\n  };\n  /**\n   * To show the  backward and forward arrow\n   *\n   * @param arrowElement\n   */\n\n\n  BaseLegend.prototype.showArrow = function (arrowElement) {\n    arrowElement.setAttribute('opacity', '1');\n  };\n  /**\n   * To find legend elements id based on chart or accumulation chart\n   *\n   * @param option\n   * @param prefix\n   * @param count\n   * @param option\n   * @param prefix\n   * @param count\n   * @param option\n   * @param prefix\n   * @param count\n   * @private\n   */\n\n\n  BaseLegend.prototype.generateId = function (option, prefix, count) {\n    if (this.isChartControl || this.isStockChartControl) {\n      return prefix + count;\n    } else {\n      return prefix + option.pointIndex;\n    }\n  };\n  /**\n   * To show or hide trimmed text tooltip for legend.\n   *\n   * @param event\n   * @returns {void}\n   * @private\n   */\n\n\n  BaseLegend.prototype.move = function (event) {\n    var _this = this;\n\n    var x = this.chart.mouseX;\n    var y = this.chart.mouseY;\n\n    if (event.target.textContent.indexOf('...') > -1) {\n      var targetId = event.target.id.split(this.legendID + '_text_');\n\n      if (targetId.length === 2) {\n        var index = parseInt(targetId[1], 10);\n        var element = this.chart.element;\n\n        if (!isNaN(index)) {\n          if (this.chart.isTouch) {\n            removeElement(this.chart.element.id + '_EJ2_Legend_Tooltip');\n          }\n\n          if (this.isChartControl) {\n            showTooltip(this.chart.series[index].name, x, y, element.offsetWidth, element.id + '_EJ2_Legend_Tooltip', getElement(this.chart.element.id + '_Secondary_Element'));\n          } else {\n            showTooltip(this.chart.visibleSeries[0].points[index].x.toString(), x + 10, y + 10, element.offsetWidth, element.id + '_EJ2_Legend_Tooltip', getElement(this.chart.element.id + '_Secondary_Element'));\n          }\n        }\n      }\n    } else {\n      removeElement(this.chart.element.id + '_EJ2_Legend_Tooltip');\n    }\n\n    if (this.chart.isTouch) {\n      clearTimeout(this.clearTooltip);\n      this.clearTooltip = +setTimeout(function () {\n        removeElement(_this.chart.element.id + '_EJ2_Legend_Tooltip');\n      }, 1000);\n    }\n  };\n\n  return BaseLegend;\n}();\n\nexport { BaseLegend };\n/**\n * Class for legend options\n *\n * @private\n */\n\nvar LegendOptions =\n/** @class */\nfunction () {\n  function LegendOptions(text, fill, shape, visible, type, url, markerShape, markerVisibility, pointIndex, seriesIndex) {\n    this.location = {\n      x: 0,\n      y: 0\n    };\n    this.text = text;\n    this.fill = fill;\n    this.shape = shape;\n    this.url = url;\n    this.visible = visible;\n    this.type = type;\n    this.markerVisibility = markerVisibility;\n    this.markerShape = markerShape;\n    this.pointIndex = pointIndex;\n    this.seriesIndex = seriesIndex;\n  }\n\n  return LegendOptions;\n}();\n\nexport { LegendOptions };","map":{"version":3,"sources":["C:/Users/chamald/Desktop/Chamal/react/react-app/node_modules/@syncfusion/ej2-charts/src/common/legend/legend.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","Property","Complex","ChildProperty","measureText","Rect","TextOption","Size","PathOption","Font","Border","Margin","ContainerPadding","Theme","subtractThickness","Thickness","drawSymbol","ChartLocation","titlePositionX","getTitle","textTrim","getTextAnchor","RectOption","textElement","stringToNumber","removeElement","showTooltip","getElement","appendChildElement","Location","_super","apply","LegendSettings","x","y","legendLabelFont","left","right","top","bottom","legendTitleFont","BaseLegend","chart","pageXCollections","legendTitleCollections","legendRegions","pagingRegions","legend","legendSettings","legendID","element","id","isChartControl","getModuleName","isBulletChartControl","isStockChartControl","bulletChart","fivePixel","rowCount","pageButtonSize","maxColumns","maxWidth","currentPage","backwardArrowOpacity","forwardArrowOpacity","arrowWidth","arrowHeight","isTop","isTitle","currentPageNumber","calculateLegendBounds","rect","availableSize","maxLabelSize","defaultValue","getPosition","position","legendBounds","isVertical","height","margin","width","library","getLegendBounds","containerPadding","getLocation","alignment","accumulation","visibleSeries","type","setBounds","computedWidth","computedHeight","titleHeight","title","titlePosition","legendTitleSize","isPaging","enablePages","Math","min","mode","titleStyle","textOverflow","calculateLegendTitle","max","ceil","padding","maxItemHeight","border","isBulletChart","labelIns","labelPosition","ticklIns","tickPosition","orientation","categoryFieldValue","categoryField","marginBottom","legendHeight","legendWidth","alignLegend","opposedPosition","majorTickLines","location","start","size","legendSize","renderLegend","redraw","titlePlusArrowWidth","pagingLegendBounds","requireLegendBounds","firstLegend","findFirstLegendPosition","legendCollections","upArrowHeight","legendGroup","renderer","createGroup","legendTranslateGroup","createLegendElements","maxHeight","text","textSize","shapeHeight","isRtlEnable","getLinearLegend","totalPages","legendSeriesGroup","count","previousLegend","startPadding","shapeWidth","x_Location","anchor","isRtlEnabled","enableRtl","textOptions","textPadding","shapePadding","legendIndex","leftSpace","bottomSapce","abs","rightSpace","_i","_a","legendOption","isReverse","fill","points","pointIndex","color","accessbilityText","render","generateId","setAttribute","tabIndex","toString","description","getRenderPoint","renderSymbol","renderText","toggleVisibility","selectionMode","highlightMode","appendChild","renderPagingElements","enableCanvas","svgObject","xmlns","nextLegend","defElement","createDefs","gradientLegendCount","linerGradientEle","document","createElementNS","opacity","fillColors","numberItems","rangeColorSettings","colorMap","indexOf","push","colors","diffValue","end","colorsLength","index","calculatedValue","_b","_c","fillColor","x1","x2","y2","full","offsetValue","stopEle","startLabel","endLabel","startTextSize","textStyle","endTextSize","textWidth","textHeight","otherSpaces","linearBarWidth","linearBarHeight","xValue","yValue","startLabelY","endLabelY","startLabelX","endLabelX","diffWidth","diffHeight","hiddenColor","fontcolor","visible","themeStyle","legendLabel","isCanvas","translatePage","gradientLegend","drawRectangle","legendCollection","legendCollection_1","maximumTitleWidth","renderLegendTitle","textAlignment","topPadding","legendTitleTextOptions","options","background","legendItemsGroup","clippath","createClipPath","clipRect","pagingClipRect","group","control","symbolColor","isStrokeWidth","shape","toLowerCase","isCustomBorder","borderColor","strokewidth","regionPadding","markerShape","seriesBorder","symbolOption","isInversed","url","markerVisibility","bounds","textOption","paginggroup","grayColor","theme","pageUp","pageDown","iconSize","titleWidth","clipPathHeight","clearRect","pageTextElement","translateX","totalNoOfPages","calTotalPage","pagingText","page","pageNumber","translate","pageX","textContent","changePage","event","backwardArrow","getElementById","forwardArrow","pageText","parseInt","split","hideArrow","showArrow","arrowElement","option","prefix","move","_this","mouseX","mouseY","targetId","isNaN","isTouch","series","name","offsetWidth","clearTimeout","clearTooltip","setTimeout","LegendOptions","seriesIndex"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable valid-jsdoc */\n/* eslint-disable jsdoc/require-param */\n/* eslint-disable @typescript-eslint/no-inferrable-types */\nimport { Property, Complex, ChildProperty } from '@syncfusion/ej2-base';\nimport { measureText, Rect, TextOption, Size, PathOption } from '@syncfusion/ej2-svg-base';\nimport { Font, Border, Margin, ContainerPadding } from '../model/base';\nimport { Theme } from '../model/theme';\nimport { subtractThickness, Thickness, drawSymbol, ChartLocation, titlePositionX, getTitle, textTrim, getTextAnchor } from '../utils/helper';\nimport { RectOption, textElement, stringToNumber } from '../utils/helper';\nimport { removeElement, showTooltip, getElement, appendChildElement } from '../utils/helper';\n/**\n * Configures the location for the legend.\n */\nvar Location = /** @class */ (function (_super) {\n    __extends(Location, _super);\n    function Location() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], Location.prototype, \"x\", void 0);\n    __decorate([\n        Property(0)\n    ], Location.prototype, \"y\", void 0);\n    return Location;\n}(ChildProperty));\nexport { Location };\n/**\n * Configures the legends in charts.\n */\nvar LegendSettings = /** @class */ (function (_super) {\n    __extends(LegendSettings, _super);\n    function LegendSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(true)\n    ], LegendSettings.prototype, \"visible\", void 0);\n    __decorate([\n        Property(null)\n    ], LegendSettings.prototype, \"height\", void 0);\n    __decorate([\n        Property(null)\n    ], LegendSettings.prototype, \"width\", void 0);\n    __decorate([\n        Complex({ x: 0, y: 0 }, Location)\n    ], LegendSettings.prototype, \"location\", void 0);\n    __decorate([\n        Property('Auto')\n    ], LegendSettings.prototype, \"position\", void 0);\n    __decorate([\n        Property('Series')\n    ], LegendSettings.prototype, \"mode\", void 0);\n    __decorate([\n        Property(8)\n    ], LegendSettings.prototype, \"padding\", void 0);\n    __decorate([\n        Property('Center')\n    ], LegendSettings.prototype, \"alignment\", void 0);\n    __decorate([\n        Complex(Theme.legendLabelFont, Font)\n    ], LegendSettings.prototype, \"textStyle\", void 0);\n    __decorate([\n        Property(10)\n    ], LegendSettings.prototype, \"shapeHeight\", void 0);\n    __decorate([\n        Property(10)\n    ], LegendSettings.prototype, \"shapeWidth\", void 0);\n    __decorate([\n        Complex({}, Border)\n    ], LegendSettings.prototype, \"border\", void 0);\n    __decorate([\n        Complex({ left: 0, right: 0, top: 0, bottom: 0 }, Margin)\n    ], LegendSettings.prototype, \"margin\", void 0);\n    __decorate([\n        Complex({ left: 0, right: 0, top: 0, bottom: 0 }, ContainerPadding)\n    ], LegendSettings.prototype, \"containerPadding\", void 0);\n    __decorate([\n        Property(5)\n    ], LegendSettings.prototype, \"shapePadding\", void 0);\n    __decorate([\n        Property('transparent')\n    ], LegendSettings.prototype, \"background\", void 0);\n    __decorate([\n        Property(1)\n    ], LegendSettings.prototype, \"opacity\", void 0);\n    __decorate([\n        Property(true)\n    ], LegendSettings.prototype, \"toggleVisibility\", void 0);\n    __decorate([\n        Property(null)\n    ], LegendSettings.prototype, \"description\", void 0);\n    __decorate([\n        Property(3)\n    ], LegendSettings.prototype, \"tabIndex\", void 0);\n    __decorate([\n        Property(null)\n    ], LegendSettings.prototype, \"title\", void 0);\n    __decorate([\n        Complex(Theme.legendTitleFont, Font)\n    ], LegendSettings.prototype, \"titleStyle\", void 0);\n    __decorate([\n        Property('Top')\n    ], LegendSettings.prototype, \"titlePosition\", void 0);\n    __decorate([\n        Property(100)\n    ], LegendSettings.prototype, \"maximumTitleWidth\", void 0);\n    __decorate([\n        Property(true)\n    ], LegendSettings.prototype, \"enablePages\", void 0);\n    __decorate([\n        Property(false)\n    ], LegendSettings.prototype, \"isInversed\", void 0);\n    __decorate([\n        Property(false)\n    ], LegendSettings.prototype, \"reverse\", void 0);\n    return LegendSettings;\n}(ChildProperty));\nexport { LegendSettings };\n/**\n * Legend base class for Chart and Accumulation chart.\n *\n * @private\n */\nvar BaseLegend = /** @class */ (function () {\n    /**\n     * Constructor for the dateTime module.\n     *\n     * @private\n     */\n    function BaseLegend(chart) {\n        this.pageXCollections = []; // pages of x locations\n        this.legendTitleCollections = [];\n        this.legendRegions = [];\n        this.pagingRegions = [];\n        this.chart = chart;\n        this.legend = chart.legendSettings;\n        this.legendID = chart.element.id + '_chart_legend';\n        this.isChartControl = (chart.getModuleName() === 'chart');\n        this.isBulletChartControl = (chart.getModuleName() === 'bulletChart');\n        this.isStockChartControl = (chart.getModuleName() === 'stockChart');\n        this.bulletChart = this.chart;\n        this.fivePixel = 5;\n        this.rowCount = 0;\n        this.pageButtonSize = 8;\n        this.maxColumns = 0;\n        this.maxWidth = 0;\n        this.currentPage = 1;\n        this.backwardArrowOpacity = 0;\n        this.forwardArrowOpacity = 1;\n        this.arrowWidth = (2 * (this.fivePixel + this.pageButtonSize + this.fivePixel));\n        this.arrowHeight = this.arrowWidth;\n        this.isTop = false;\n        this.isTitle = false;\n        this.currentPageNumber = 1;\n    }\n    /**\n     * Calculate the bounds for the legends.\n     *\n     * @returns {void}\n     * @private\n     */\n    BaseLegend.prototype.calculateLegendBounds = function (rect, availableSize, maxLabelSize) {\n        var legend = this.legend;\n        var defaultValue = (this.isBulletChartControl) ? '40%' : '20%';\n        this.getPosition(legend.position, availableSize);\n        this.legendBounds = new Rect(rect.x, rect.y, 0, 0);\n        this.isVertical = (this.position === 'Left' || this.position === 'Right');\n        if (this.isVertical) {\n            this.legendBounds.height = stringToNumber(legend.height, availableSize.height - (rect.y - this.chart.margin.top)) || rect.height;\n            this.legendBounds.width = stringToNumber(legend.width || defaultValue, availableSize.width);\n        }\n        else {\n            this.legendBounds.width = stringToNumber(legend.width, availableSize.width) || rect.width;\n            this.legendBounds.height = stringToNumber(legend.height || defaultValue, availableSize.height);\n        }\n        this.library.getLegendBounds(availableSize, this.legendBounds, legend);\n        if (!this.isBulletChartControl) {\n            this.legendBounds.width += (this.legend.containerPadding.left + this.legend.containerPadding.right);\n            this.legendBounds.height += (this.legend.containerPadding.top + this.legend.containerPadding.bottom);\n        }\n        this.getLocation(this.position, legend.alignment, this.legendBounds, rect, availableSize, maxLabelSize);\n    };\n    /**\n     * To find legend position based on available size for chart and accumulation chart\n     *\n     * @param position\n     * @param availableSize\n     * @param position\n     * @param availableSize\n     * @returns {void}\n     */\n    BaseLegend.prototype.getPosition = function (position, availableSize) {\n        var chart = this.chart;\n        var accumulation = this.chart;\n        if (this.isChartControl || this.isBulletChartControl || this.isStockChartControl) {\n            this.position = (position !== 'Auto') ? position : 'Bottom';\n        }\n        else {\n            if (position === 'Auto' && ((chart || accumulation).visibleSeries && (chart || accumulation).visibleSeries[0].type === 'Funnel' || (chart || accumulation).visibleSeries[0].type === 'Pyramid')) {\n                position = 'Top';\n            }\n            this.position = (position !== 'Auto') ? position :\n                (availableSize.width > availableSize.height ? 'Right' : 'Bottom');\n        }\n    };\n    /**\n     * To set bounds for chart and accumulation chart\n     *\n     * @param computedWidth\n     * @param computedHeight\n     * @param legend\n     * @param legendBounds\n     * @param computedWidth\n     * @param computedHeight\n     * @param legend\n     * @param legendBounds\n     * @param computedWidth\n     * @param computedHeight\n     * @param legend\n     * @param legendBounds\n     * @param computedWidth\n     * @param computedHeight\n     * @param legend\n     * @param legendBounds\n     * @returns {void}\n     */\n    BaseLegend.prototype.setBounds = function (computedWidth, computedHeight, legend, legendBounds) {\n        var titleHeight = legend.title && legend.titlePosition === 'Top' ? this.legendTitleSize.height + this.fivePixel : 0;\n        if (this.isVertical && this.isPaging && !legend.enablePages && !this.isBulletChartControl) {\n            titleHeight = legend.title && legend.titlePosition === 'Top' ? this.legendTitleSize.height + this.fivePixel : 0;\n            titleHeight += (this.pageButtonSize + this.fivePixel);\n        }\n        computedWidth = Math.min(computedWidth, legendBounds.width);\n        computedHeight = Math.min(computedHeight, legendBounds.height);\n        if (legend.mode === 'Gradient') {\n            legendBounds.width = legend.width ? legendBounds.width : this.isVertical ? computedWidth : 0.75 * legendBounds.width;\n            legendBounds.height = legend.height ? legendBounds.height : this.isVertical ? 0.75 * legendBounds.height : computedHeight;\n        }\n        else {\n            legendBounds.width = !legend.width ? computedWidth : legendBounds.width;\n            legendBounds.height = !legend.height ? computedHeight : legendBounds.height;\n        }\n        if (!this.isBulletChartControl) {\n            if (this.isTop && legend.titleStyle.textOverflow !== 'None') {\n                this.calculateLegendTitle(legend, legendBounds);\n                legendBounds.height += legend.titleStyle.textOverflow === 'Wrap' && this.legendTitleCollections.length > 1 ?\n                    (this.legendTitleSize.height - (this.legendTitleSize.height / this.legendTitleCollections.length)) : 0;\n            }\n        }\n        this.rowCount = Math.max(1, Math.ceil((legendBounds.height - legend.padding - titleHeight) /\n            (this.maxItemHeight + legend.padding)));\n    };\n    /**\n     * To find legend location based on position, alignment for chart and accumulation chart\n     *\n     * @param position\n     * @param alignment\n     * @param legendBounds\n     * @param rect\n     * @param availableSize\n     * @param maxLabelSize\n     * @param position\n     * @param alignment\n     * @param legendBounds\n     * @param rect\n     * @param availableSize\n     * @param maxLabelSize\n     * @param position\n     * @param alignment\n     * @param legendBounds\n     * @param rect\n     * @param availableSize\n     * @param maxLabelSize\n     * @param position\n     * @param alignment\n     * @param legendBounds\n     * @param rect\n     * @param availableSize\n     * @param maxLabelSize\n     * @param position\n     * @param alignment\n     * @param legendBounds\n     * @param rect\n     * @param availableSize\n     * @param maxLabelSize\n     * @param position\n     * @param alignment\n     * @param legendBounds\n     * @param rect\n     * @param availableSize\n     * @param maxLabelSize\n     */\n    BaseLegend.prototype.getLocation = function (position, alignment, legendBounds, rect, availableSize, maxLabelSize) {\n        var padding = this.legend.border.width;\n        var isBulletChart = this.isBulletChartControl;\n        var bulletChart = this.bulletChart;\n        var labelIns = bulletChart.labelPosition === 'Inside';\n        var ticklIns = bulletChart.tickPosition === 'Inside';\n        var isVertical = bulletChart.orientation === 'Vertical';\n        var categoryFieldValue = (isBulletChart && bulletChart.categoryField !== '') ?\n            maxLabelSize.width + this.chart.border.width + padding * 3 : 0;\n        var marginBottom = this.chart.margin.bottom;\n        var legendHeight = legendBounds.height + padding + this.legend.margin.top + this.legend.margin.bottom;\n        var legendWidth = legendBounds.width + padding + this.legend.margin.left + this.legend.margin.right;\n        if (position === 'Bottom') {\n            legendBounds.x = this.alignLegend(legendBounds.x, availableSize.width, legendBounds.width, alignment);\n            legendBounds.y = rect.y + (rect.height - legendHeight) + padding + this.legend.margin.top;\n            legendBounds.y += (isBulletChart && !bulletChart.opposedPosition && !labelIns && !ticklIns\n                && !isVertical) ? bulletChart.majorTickLines.height + marginBottom + this.legend.border.width + padding * 2 :\n                (isVertical && bulletChart.categoryField !== '') ? maxLabelSize.height + padding * 2 : 0;\n            subtractThickness(rect, new Thickness(0, 0, 0, legendHeight));\n        }\n        else if (position === 'Top') {\n            legendBounds.x = this.alignLegend(legendBounds.x, availableSize.width, legendBounds.width, alignment);\n            legendBounds.y = rect.y + padding + this.legend.margin.top;\n            legendBounds.y -= (isBulletChart && bulletChart.opposedPosition && !labelIns && !ticklIns &&\n                !isVertical) ? bulletChart.majorTickLines.height + this.chart.margin.top : 0;\n            legendHeight -= (isBulletChart) ? -padding * 2 : 0;\n            subtractThickness(rect, new Thickness(0, 0, legendHeight, 0));\n        }\n        else if (position === 'Right') {\n            legendBounds.x = rect.x + (rect.width - legendBounds.width) - this.legend.margin.right;\n            legendBounds.y = rect.y + this.alignLegend(0, availableSize.height - (rect.y + marginBottom), legendBounds.height, alignment);\n            legendWidth += (isBulletChart && bulletChart.opposedPosition && !labelIns && !ticklIns &&\n                isVertical) ? (this.chart.margin.left + this.chart.margin.right + bulletChart.majorTickLines.height) : 0;\n            subtractThickness(rect, new Thickness(0, legendWidth, 0, 0));\n        }\n        else if (position === 'Left') {\n            legendBounds.x = legendBounds.x + this.legend.margin.left;\n            legendBounds.y = rect.y + this.alignLegend(0, availableSize.height - (rect.y + marginBottom), legendBounds.height, alignment);\n            legendWidth += (isBulletChart && !bulletChart.opposedPosition && !labelIns && !ticklIns &&\n                isVertical) ? (legendBounds.x - this.chart.margin.left + padding + bulletChart.majorTickLines.height) :\n                (bulletChart.orientation !== 'Vertical' && bulletChart.categoryField !== '') ? categoryFieldValue : 0;\n            subtractThickness(rect, new Thickness(legendWidth, 0, 0, 0));\n        }\n        else {\n            legendBounds.x = this.legend.location.x;\n            legendBounds.y = this.legend.location.y;\n            subtractThickness(rect, new Thickness(0, 0, 0, 0));\n        }\n    };\n    /**\n     * To find legend alignment for chart and accumulation chart\n     *\n     * @param start\n     * @param size\n     * @param legendSize\n     * @param alignment\n     * @param start\n     * @param size\n     * @param legendSize\n     * @param alignment\n     * @param start\n     * @param size\n     * @param legendSize\n     * @param alignment\n     * @param start\n     * @param size\n     * @param legendSize\n     * @param alignment\n     */\n    BaseLegend.prototype.alignLegend = function (start, size, legendSize, alignment) {\n        switch (alignment) {\n            case 'Far':\n                start = (size - legendSize) - start;\n                break;\n            case 'Center':\n                start = ((size - legendSize) / 2);\n                break;\n        }\n        return start;\n    };\n    /**\n     * Renders the legend.\n     *\n     * @param chart\n     * @param legend\n     * @param legendBounds\n     * @param redraw\n     * @param chart\n     * @param legend\n     * @param legendBounds\n     * @param redraw\n     * @param chart\n     * @param legend\n     * @param legendBounds\n     * @param redraw\n     * @param chart\n     * @param legend\n     * @param legendBounds\n     * @param redraw\n     * @returns {void}\n     * @private\n     */\n    BaseLegend.prototype.renderLegend = function (chart, legend, legendBounds, redraw) {\n        var titleHeight = 0;\n        var titlePlusArrowWidth = 0;\n        var pagingLegendBounds = new Rect(0, 0, 0, 0);\n        var requireLegendBounds = new Rect(0, 0, 0, 0);\n        var firstLegend = this.findFirstLegendPosition(this.legendCollections);\n        var padding = legend.padding;\n        var isPaging = legend.enablePages;\n        var titlePosition = legend.titlePosition;\n        var upArrowHeight = this.isPaging && !legend.enablePages && this.isVertical ? this.pageButtonSize : 0;\n        var legendGroup = chart.renderer.createGroup({ id: this.legendID + '_g' });\n        var legendTranslateGroup = this.createLegendElements(chart, legendBounds, legendGroup, legend, this.legendID, redraw);\n        this.legendRegions = [];\n        var maxHeight = 0;\n        for (var i = 0; i < this.legendCollections.length; i++) {\n            if (this.legendCollections[i].text !== '') {\n                maxHeight = Math.max(this.legendCollections[i].textSize.height, maxHeight);\n                break;\n            }\n            else {\n                continue;\n            }\n        }\n        this.maxItemHeight = Math.max(maxHeight, legend.shapeHeight);\n        // For new legend navigation\n        if (!isPaging && this.isPaging && !this.isVertical) {\n            titlePlusArrowWidth = !this.isTitle ? 0 : titlePosition === 'Left' ? this.legendTitleSize.width : 0;\n            titlePlusArrowWidth += (this.pageButtonSize + (2 * this.fivePixel));\n        }\n        else if (this.isTitle && !this.isPaging && !this.isVertical) {\n            titlePlusArrowWidth = titlePosition === ((!this.isRtlEnable) ? 'Left' : 'Right') ? (this.fivePixel + this.legendTitleSize.width) : 0;\n        }\n        titleHeight = !this.isTitle ? 0 : (this.isTop || this.isVertical ? this.legendTitleSize.height : 0);\n        if (chart.legendSettings.mode === 'Gradient' && this.legendCollections.length > 1) {\n            this.getLinearLegend(legendBounds, chart, legend, legendTranslateGroup);\n            this.totalPages = 1;\n        }\n        else if (firstLegend !== this.legendCollections.length) {\n            var legendSeriesGroup = void 0; // legendItem group for each series group element\n            var count = 0;\n            var previousLegend = this.legendCollections[firstLegend];\n            // starting shape center x,y position && to resolve lint error used new line for declaration\n            var startPadding = this.isBulletChartControl ? 0 : titlePlusArrowWidth + padding + (legend.shapeWidth / 2) + legend.containerPadding.left;\n            var x_Location = this.isBulletChartControl ? legendBounds.x + titlePlusArrowWidth + padding + (legend.shapeWidth / 2) :\n                (!this.isRtlEnable) ? legendBounds.x + startPadding : legendBounds.x + ((this.chart.getModuleName() === 'accumulationchart' && this.isVertical) ? this.maxWidth : legendBounds.width) - startPadding;\n            var start = new ChartLocation(x_Location, this.isBulletChartControl ? legendBounds.y + titleHeight + upArrowHeight + padding + (this.maxItemHeight / 2) :\n                legendBounds.y + titleHeight + upArrowHeight + padding + (this.maxItemHeight / 2) + legend.containerPadding.top);\n            var anchor = chart.isRtlEnabled || chart.enableRtl ? 'end' : 'start';\n            var textOptions = new TextOption('', start.x, start.y, anchor);\n            var textPadding = legend.shapePadding + padding + legend.shapeWidth;\n            //  initialization for totalPages legend click totalpage again calculate\n            this.totalPages = this.totalPages = (this.isChartControl || this.isBulletChartControl || this.isStockChartControl) ? this.totalPages : 0;\n            this.pageXCollections = [];\n            this.legendCollections[firstLegend].location = start;\n            var legendIndex = void 0;\n            if (!legend.enablePages && this.isPaging) {\n                var x = start.x - this.fivePixel;\n                var y = start.y - this.fivePixel;\n                var leftSpace = this.isTitle && !this.isVertical && titlePosition === 'Left' ?\n                    this.legendTitleSize.width + this.fivePixel : 0;\n                var bottomSapce = this.isVertical ? (this.pageButtonSize) + Math.abs(y - legendBounds.y) : 0;\n                var rightSpace = this.isTitle && !this.isVertical && titlePosition === 'Right' ?\n                    this.legendTitleSize.width + this.fivePixel : 0;\n                rightSpace += this.isVertical ? 0 : (this.fivePixel + this.pageButtonSize + this.fivePixel);\n                pagingLegendBounds = new Rect(x, y, legendBounds.width - rightSpace - leftSpace, legendBounds.height - bottomSapce);\n                requireLegendBounds = pagingLegendBounds;\n            }\n            else {\n                requireLegendBounds = legendBounds;\n            }\n            for (var _i = 0, _a = this.legendCollections; _i < _a.length; _i++) {\n                var legendOption = _a[_i];\n                legendIndex = !this.isReverse ? count : (this.legendCollections.length - 1) - count;\n                if (this.chart.getModuleName() === 'accumulationchart') {\n                    // eslint-disable-next-line max-len\n                    legendOption.fill = (this.chart || this.chart || this.chart).visibleSeries[0].points[legendOption.pointIndex].color;\n                }\n                if (this.chart.getModuleName() === 'stockChart') {\n                    legendOption.type = this.chart.visibleSeries[count].type;\n                }\n                this.accessbilityText = (this.isBulletChartControl) ? 'Legend of bullet chart' + '' + legendOption.text\n                    : 'Click to show or hide the ' + legendOption.text + ' series';\n                if (legendOption.render && legendOption.text !== '') {\n                    legendSeriesGroup = chart.renderer.createGroup({\n                        id: this.legendID + this.generateId(legendOption, '_g_', legendIndex)\n                    });\n                    if (legendSeriesGroup) {\n                        legendSeriesGroup.setAttribute('tabindex', legend.tabIndex.toString());\n                        legendSeriesGroup.setAttribute('aria-label', legend.description ||\n                            this.accessbilityText);\n                    }\n                    this.library.getRenderPoint(legendOption, start, textPadding, previousLegend, requireLegendBounds, count, firstLegend);\n                    this.renderSymbol(legendOption, legendSeriesGroup, legendIndex);\n                    this.renderText(chart, legendOption, legendSeriesGroup, textOptions, count, legendIndex);\n                    if (legendSeriesGroup) {\n                        legendSeriesGroup.setAttribute('style', 'outline: none; cursor: ' + ((!legend.toggleVisibility && (chart.selectionMode === 'None' ||\n                            chart.highlightMode === 'None' ||\n                            chart.selectionMode === 'None') || this.isBulletChartControl) ? 'auto' : 'pointer'));\n                    }\n                    if (legendTranslateGroup) {\n                        legendTranslateGroup.appendChild(legendSeriesGroup);\n                    }\n                    previousLegend = legendOption;\n                }\n                count++;\n            }\n            if (this.isPaging) {\n                this.renderPagingElements(chart, legendBounds, textOptions, legendGroup);\n            }\n            else {\n                this.totalPages = 1;\n            }\n        }\n        appendChildElement(chart.enableCanvas, chart.svgObject, legendGroup, redraw);\n    };\n    /** @private */\n    BaseLegend.prototype.getLinearLegend = function (legendBounds, chart, legend, legendTranslateGroup) {\n        var xmlns = 'http://www.w3.org/2000/svg';\n        var previousLegend = this.legendCollections[0];\n        var nextLegend = this.legendCollections[1];\n        var defElement = this.chart.renderer.createDefs();\n        var gradientLegendCount = 0;\n        var linerGradientEle = document.createElementNS(xmlns, 'linearGradient');\n        var opacity = 1;\n        var fillColors = [];\n        var numberItems = [];\n        if (legend.title) {\n            if (!this.isVertical) {\n                if (legend.titlePosition === 'Left') {\n                    legendBounds.x += this.legendTitleSize.width;\n                    legendBounds.width -= this.legendTitleSize.width;\n                }\n                else if (legend.titlePosition === 'Right') {\n                    legendBounds.width -= this.legendTitleSize.width;\n                }\n                else if (legend.titlePosition === 'Top') {\n                    legendBounds.y += this.legendTitleSize.height;\n                    legendBounds.height -= this.legendTitleSize.height;\n                }\n            }\n            else {\n                legendBounds.y += this.legendTitleSize.height;\n                legendBounds.height -= this.legendTitleSize.height;\n            }\n        }\n        for (var _i = 0, _a = this.chart.rangeColorSettings; _i < _a.length; _i++) {\n            var colorMap = _a[_i];\n            if (numberItems.indexOf(colorMap.start) < 0) {\n                numberItems.push(colorMap.start);\n            }\n            if (colorMap.colors.length > 2) {\n                var diffValue = (colorMap.end - colorMap.start);\n                var colorsLength = colorMap.colors.length - 1;\n                if (diffValue > 0) {\n                    diffValue = diffValue / colorsLength;\n                    for (var index = 1; index < colorsLength; index++) {\n                        var calculatedValue = colorMap.start + (diffValue * index);\n                        numberItems.push(calculatedValue);\n                    }\n                }\n                else {\n                    for (var index = 1; index < colorsLength; index++) {\n                        numberItems.push(colorMap.start);\n                    }\n                }\n            }\n            if (numberItems.indexOf(colorMap.end) < 0) {\n                numberItems.push(colorMap.end);\n            }\n            for (var _b = 0, _c = colorMap.colors; _b < _c.length; _b++) {\n                var fillColor = _c[_b];\n                if (fillColors.indexOf(fillColor) < 0) {\n                    fillColors.push(fillColor);\n                }\n            }\n            if (colorMap.colors.length > 0 && colorMap.colors.length < 2) {\n                fillColors.push(colorMap.colors[0]);\n            }\n        }\n        var x1 = this.isRtlEnable && !this.isVertical ? '100%' : '0%';\n        var x2 = this.isVertical || this.isRtlEnable ? '0%' : '100%';\n        var y2 = this.isVertical ? '100%' : '0%';\n        linerGradientEle.setAttribute('id', this.generateId(previousLegend, 'linearGradient', gradientLegendCount));\n        linerGradientEle.setAttribute('x1', x1);\n        linerGradientEle.setAttribute('y1', '0%');\n        linerGradientEle.setAttribute('x2', x2);\n        linerGradientEle.setAttribute('y2', y2);\n        var full = numberItems[numberItems.length - 1] - numberItems[0];\n        for (var b = 0; b < fillColors.length; b++) {\n            var offsetValue = numberItems[b] - numberItems[0];\n            offsetValue = offsetValue / full;\n            var stopEle = document.createElementNS(xmlns, 'stop');\n            stopEle.setAttribute('offset', offsetValue.toString());\n            stopEle.setAttribute('stop-color', fillColors[b]);\n            stopEle.setAttribute('stop-opacity', opacity.toString());\n            linerGradientEle.appendChild(stopEle);\n        }\n        var startLabel = previousLegend.text.toString();\n        var endLabel = nextLegend.text.toString();\n        var startTextSize = measureText(startLabel, legend.textStyle);\n        var endTextSize = measureText(endLabel, legend.textStyle);\n        var textWidth = startTextSize.width > endTextSize.width ? startTextSize.width : endTextSize.width;\n        var textHeight = startTextSize.height > endTextSize.height ? startTextSize.height : endTextSize.height;\n        var otherSpaces = (2 * textWidth) + (4 * legend.padding);\n        var linearBarWidth = legendBounds.width;\n        var linearBarHeight = legendBounds.height;\n        var xValue = legendBounds.x + textWidth + (2 * legend.padding);\n        var yValue = legendBounds.y + legend.padding;\n        var startLabelY;\n        var endLabelY;\n        var startLabelX;\n        var endLabelX;\n        if (this.isVertical) {\n            otherSpaces = (2 * textHeight) + (4 * legend.padding);\n            linearBarWidth = legendBounds.width - (2 * legend.padding);\n            linearBarHeight = legendBounds.height - otherSpaces;\n            xValue = legendBounds.x + legend.padding;\n            yValue = legendBounds.y + textHeight + (2 * legend.padding);\n            startLabelY = legendBounds.y + legend.padding + textHeight;\n            endLabelY = yValue + linearBarHeight + textHeight;\n            startLabelX = (legendBounds.x + (legendBounds.width * 0.5)) - (textWidth * 0.5);\n            endLabelX = startLabelX;\n            if (linearBarWidth > 30) {\n                var diffWidth = linearBarWidth - 30;\n                linearBarWidth = 30;\n                xValue = xValue + (diffWidth / 2);\n            }\n        }\n        else {\n            linearBarWidth = legendBounds.width - otherSpaces;\n            linearBarHeight = legendBounds.height - (2 * legend.padding);\n            startLabelX = legendBounds.x + ((!this.isRtlEnable) ? legend.padding + (textWidth - startTextSize.width) :\n                linearBarWidth + (3 * legend.padding) + textWidth);\n            endLabelX = legendBounds.x + ((!this.isRtlEnable) ? linearBarWidth + (3 * legend.padding) + textWidth :\n                legend.padding + (textWidth - endTextSize.width));\n            startLabelY = legendBounds.y + (legendBounds.height * 0.5) + (textHeight * 0.25);\n            endLabelY = startLabelY;\n            if (linearBarHeight > 30) {\n                var diffHeight = linearBarHeight - 30;\n                linearBarHeight = 30;\n                yValue = yValue + (diffHeight / 2);\n            }\n        }\n        var anchor = chart.enableRtl ? 'end' : '';\n        var textOptions = new TextOption('', startLabelX, startLabelY, anchor, startLabel);\n        var hiddenColor = '#D3D3D3';\n        textOptions.id = this.legendID + this.generateId(previousLegend, '_text_', 1);\n        var fontcolor = previousLegend.visible ? legend.textStyle.color || chart.themeStyle.legendLabel : hiddenColor;\n        var isCanvas = this.isStockChartControl ? false : this.chart.enableCanvas;\n        textElement(chart.renderer, textOptions, legend.textStyle, fontcolor, legendTranslateGroup, false, false, false, false, \n        // tslint:disable-next-line:align\n        null, this.currentPageNumber && isCanvas ?\n            new Rect(0, -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber), 0, 0) : null);\n        textOptions = new TextOption('', endLabelX, endLabelY, anchor, endLabel);\n        textOptions.id = this.legendID + this.generateId(previousLegend, '_text_', 2);\n        textElement(chart.renderer, textOptions, legend.textStyle, fontcolor, legendTranslateGroup, false, false, false, false, \n        // tslint:disable-next-line:align\n        null, this.currentPageNumber && isCanvas ?\n            new Rect(0, -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber), 0, 0) : null);\n        var gradientLegend = chart.renderer.drawRectangle({\n            width: linearBarWidth,\n            height: linearBarHeight,\n            x: xValue,\n            y: yValue,\n            fill: 'url(#' + this.generateId(previousLegend, 'linearGradient', gradientLegendCount) + ')'\n        });\n        defElement.appendChild(linerGradientEle);\n        legendTranslateGroup.appendChild(defElement);\n        legendTranslateGroup.appendChild(gradientLegend);\n    };\n    /**\n     * To find first valid legend text index for chart and accumulation chart\n     *\n     * @param legendCollection\n     * @returns {number}\n     * @private\n     */\n    BaseLegend.prototype.findFirstLegendPosition = function (legendCollection) {\n        var count = 0;\n        for (var _i = 0, legendCollection_1 = legendCollection; _i < legendCollection_1.length; _i++) {\n            var legend = legendCollection_1[_i];\n            if (legend.render && legend.text !== '') {\n                break;\n            }\n            count++;\n        }\n        return count;\n    };\n    /**\n     * To get the legend title text width and height.\n     *\n     * @param legend\n     * @param legendBounds\n     */\n    BaseLegend.prototype.calculateLegendTitle = function (legend, legendBounds) {\n        if (legend.title) {\n            this.isTop = legend.titlePosition === 'Top';\n            var padding = legend.titleStyle.textOverflow === 'Trim' ? 2 * legend.padding : 0;\n            if (this.isTop || this.isVertical) {\n                this.legendTitleCollections = getTitle(legend.title, legend.titleStyle, (legendBounds.width - padding));\n            }\n            else {\n                this.legendTitleCollections[0] = textTrim(legend.maximumTitleWidth, legend.title, legend.titleStyle);\n            }\n            var text = this.isTop ? legend.title : this.legendTitleCollections[0];\n            this.legendTitleSize = measureText(text, legend.titleStyle);\n            this.legendTitleSize.height *= this.legendTitleCollections.length;\n        }\n        else {\n            this.legendTitleSize = new Size(0, 0);\n        }\n    };\n    /**\n     * Render the legend title\n     *\n     * @param chart\n     * @param legend\n     * @param legendBounds\n     * @param legendGroup\n     */\n    BaseLegend.prototype.renderLegendTitle = function (chart, legend, legendBounds, legendGroup) {\n        var padding = legend.padding;\n        var alignment = legend.titleStyle.textAlignment;\n        this.isTop = legend.titlePosition === 'Top';\n        var anchor = getTextAnchor(legend.titleStyle.textAlignment, chart.enableRtl);\n        var x = titlePositionX(legendBounds, legend.titleStyle);\n        anchor = this.isTop || this.isVertical ? anchor : (chart.enableRtl) ? 'end' : '';\n        x = alignment === 'Near' ? (x + padding) : alignment === 'Far' ? (x - padding) : x;\n        x = (this.isTop || this.isVertical) ? x : ((legendBounds.x) + (legend.titlePosition === 'Left' ? 5 :\n            (legendBounds.width - this.legendTitleSize.width - 5)));\n        var topPadding = (legendBounds.height / 2) + (this.legendTitleSize.height / 4);\n        var y = legendBounds.y + (!this.isTop && !this.isVertical ? topPadding :\n            (this.legendTitleSize.height / this.legendTitleCollections.length));\n        var legendTitleTextOptions = new TextOption(this.legendID + '_title', x, y, anchor, this.legendTitleCollections);\n        textElement(chart.renderer, legendTitleTextOptions, legend.titleStyle, legend.titleStyle.color, legendGroup);\n    };\n    /**\n     * To create legend rendering elements for chart and accumulation chart\n     *\n     * @param chart\n     * @param legendBounds\n     * @param legendGroup\n     * @param legend\n     * @param id\n     * @param redraw\n     */\n    BaseLegend.prototype.createLegendElements = function (chart, legendBounds, legendGroup, legend, id, redraw) {\n        var padding = legend.padding;\n        var options = new RectOption(id + '_element', legend.background, legend.border, legend.opacity, legendBounds);\n        var legendItemsGroup = chart.renderer.createGroup({ id: id + '_collections' });\n        var isCanvas = this.isStockChartControl ? false : chart.enableCanvas;\n        var clippath = chart.renderer.createClipPath({ id: id + '_clipPath' });\n        options.width = (this.isRtlEnable && this.chart.getModuleName() === 'accumulationchart' && this.isVertical) ? this.maxWidth : legendBounds.width;\n        if (legendGroup) {\n            legendGroup.appendChild(chart.renderer.drawRectangle(options));\n        }\n        else {\n            chart.renderer.drawRectangle(options);\n        }\n        if (legend.title) {\n            this.renderLegendTitle(chart, legend, legendBounds, legendGroup);\n        }\n        if (!isCanvas) {\n            legendGroup.appendChild(legendItemsGroup);\n        }\n        this.legendTranslateGroup = chart.renderer.createGroup({ id: id + '_translate_g' });\n        if (!isCanvas) {\n            legendItemsGroup.appendChild(this.legendTranslateGroup);\n        }\n        options.y += padding + (this.isTop ? this.legendTitleSize.height : 0);\n        options.id += '_clipPath_rect';\n        options.width = ((!this.isChartControl && chart.getModuleName() !== 'bulletChart' && !this.isStockChartControl) && this.isVertical) ? this.maxWidth - padding + legend.containerPadding.left + legend.containerPadding.right\n            : legendBounds.width;\n        if (!isCanvas) {\n            this.clipRect = chart.renderer.drawRectangle(options);\n            clippath.appendChild(this.clipRect);\n        }\n        else {\n            this.pagingClipRect = options;\n        }\n        appendChildElement(isCanvas, chart.svgObject, clippath, redraw);\n        if (!isCanvas) {\n            legendItemsGroup['style'] = 'clip-path:url(#' + clippath.id + ')';\n        }\n        return this.legendTranslateGroup;\n    };\n    /**\n     * To render legend symbols for chart and accumulation chart\n     *\n     * @param legendOption\n     * @param group\n     * @param i\n     * @param legendOption\n     * @param group\n     * @param i\n     * @param legendOption\n     * @param group\n     * @param i\n     */\n    BaseLegend.prototype.renderSymbol = function (legendOption, group, legendIndex) {\n        var control = this.isBulletChartControl ? this.chart : null;\n        var symbolColor = legendOption.visible ? legendOption.fill : '#D3D3D3';\n        var isStrokeWidth = ((this.chart.getModuleName() === 'chart' || this.chart.getModuleName() === 'stockChart') && (legendOption.shape === 'SeriesType') &&\n            (legendOption.type.toLowerCase().indexOf('line') > -1) && (legendOption.type.toLowerCase().indexOf('area') === -1));\n        var isCustomBorder = (this.chart.getModuleName() === 'chart' || this.chart.getModuleName() === 'stockChart') &&\n            (legendOption.type === 'Scatter' || legendOption.type === 'Bubble');\n        var isCanvas = this.isStockChartControl ? false : this.chart.enableCanvas;\n        var borderColor;\n        var shape = (legendOption.shape === 'SeriesType') ? legendOption.type : legendOption.shape;\n        var strokewidth = isStrokeWidth ? (this.legend.mode === 'Series' ?\n            this.chart.visibleSeries[legendIndex].width : this.chart.visibleSeries[0].width) :\n            (this.isBulletChartControl && legendOption.shape === 'Multiply') ? 4 : 1;\n        var regionPadding;\n        shape = shape === 'Scatter' ? legendOption.markerShape : shape;\n        if (isCustomBorder && legendIndex < this.chart.visibleSeries.length) {\n            var seriesBorder = this.chart.visibleSeries[legendIndex].border;\n            borderColor = seriesBorder.color ? seriesBorder.color : symbolColor;\n            strokewidth = seriesBorder.width ? seriesBorder.width : 1;\n        }\n        var symbolOption = new PathOption(this.legendID + this.generateId(legendOption, '_shape_', legendIndex), symbolColor, strokewidth, (isCustomBorder ? borderColor : symbolColor), 1, '', '');\n        var textSize = measureText(legendOption.text, this.legend.textStyle);\n        var x = this.legend.isInversed && !this.isRtlEnable ? legendOption.location.x + textSize.width + this.legend.shapePadding\n            : legendOption.location.x;\n        var y = legendOption.location.y;\n        if (!isCanvas) {\n            group.appendChild(drawSymbol({ x: x, y: y }, shape, new Size(this.legend.shapeWidth, this.legend.shapeHeight), legendOption.url, symbolOption, this.accessbilityText, this.chart.renderer, null, this.isBulletChartControl, control));\n        }\n        else {\n            regionPadding = -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber);\n            drawSymbol({ x: x, y: y }, shape, new Size(this.legend.shapeWidth, this.legend.shapeHeight), '', symbolOption, this.accessbilityText, this.chart.renderer, this.currentPageNumber ? new Rect(0, regionPadding, 0, 0) : null, this.isBulletChartControl, control);\n            this.legendRegions.push({\n                rect: new Rect(legendOption.location.x, legendOption.location.y, this.legend.shapeWidth, this.legend.shapeHeight + regionPadding), index: legendIndex\n            });\n        }\n        if (shape === 'Line' && legendOption.markerVisibility && legendOption.markerShape !== 'Image' ||\n            (legendOption.type === 'Doughnut' && shape === 'Doughnut')) {\n            symbolOption.id = this.legendID + this.generateId(legendOption, '_shape_marker_', legendIndex);\n            shape = legendOption.type === 'Doughnut' ? 'Circle' : legendOption.markerShape;\n            symbolOption.fill = legendOption.type === 'Doughnut' ? '#FFFFFF' : symbolOption.fill;\n            if (!isCanvas) {\n                // eslint-disable-next-line max-len\n                group.appendChild(drawSymbol({ x: x, y: y }, shape, new Size(this.legend.shapeWidth / 2, this.legend.shapeHeight / 2), '', symbolOption, this.accessbilityText, null, null, this.isBulletChartControl, control));\n            }\n            else {\n                drawSymbol({ x: x, y: y }, shape, new Size(this.legend.shapeWidth / 2, this.legend.shapeHeight / 2), '', symbolOption, this.accessbilityText, this.chart.renderer, this.currentPageNumber ?\n                    new Rect(0, -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber), 0, 0) : null, this.isBulletChartControl, control);\n            }\n        }\n    };\n    /**\n     * To render legend text for chart and accumulation chart\n     *\n     * @param chart\n     * @param legendOption\n     * @param group\n     * @param textOptions\n     * @param i\n     * @param chart\n     * @param legendOption\n     * @param group\n     * @param textOptions\n     * @param i\n     * @param chart\n     * @param legendOption\n     * @param group\n     * @param textOptions\n     * @param i\n     * @param chart\n     * @param legendOption\n     * @param group\n     * @param textOptions\n     * @param i\n     * @param chart\n     * @param legendOption\n     * @param group\n     * @param textOptions\n     * @param i\n     */\n    BaseLegend.prototype.renderText = function (chart, legendOption, group, textOptions, i, legendIndex) {\n        var legend = chart.legendSettings;\n        var hiddenColor = '#D3D3D3';\n        var fontcolor = legendOption.visible ? legend.textStyle.color || chart.themeStyle.legendLabel : hiddenColor;\n        var isCanvas = this.isStockChartControl ? false : this.chart.enableCanvas;\n        textOptions.id = this.legendID + this.generateId(legendOption, '_text_', legendIndex);\n        textOptions.text = legendOption.text;\n        if (legend.isInversed && !this.isRtlEnable) {\n            textOptions.x = legendOption.location.x - (legend.shapeWidth / 2);\n        }\n        else if (this.isRtlEnable) {\n            textOptions.x = legendOption.location.x - (measureText(legendOption.text, legend.textStyle).width + legend.shapeWidth / 2 + legend.shapePadding);\n        }\n        else {\n            textOptions.x = legendOption.location.x + (legend.shapeWidth / 2) + legend.shapePadding;\n        }\n        textOptions.y = legendOption.location.y + this.maxItemHeight / 4;\n        var element = textElement(chart.renderer, textOptions, legend.textStyle, fontcolor, group, false, false, false, false, null, this.currentPageNumber && isCanvas ?\n            new Rect(0, -this.translatePage(null, this.currentPageNumber - 1, this.currentPageNumber), 0, 0) : null);\n        if (element) {\n            element.setAttribute('aria-label', legend.description || this.accessbilityText);\n        }\n        if (isCanvas) {\n            var textSize = measureText(textOptions.text, legend.textStyle);\n            this.legendRegions[i].rect.y = textOptions.y < this.legendRegions[i].rect.y ? textOptions.y : this.legendRegions[i].rect.y;\n            this.legendRegions[i].rect.width += textSize.width;\n            this.legendRegions[i].rect.height = textSize.height;\n            this.legendRegions[i].rect.y -= textSize.height * 0.5;\n            this.legendRegions[i].rect.x -= (this.isRtlEnable) ? this.legendRegions[i].rect.width : 0;\n        }\n    };\n    /**\n     * To render legend paging elements for chart and accumulation chart\n     *\n     * @param chart\n     * @param bounds\n     * @param textOption\n     * @param legendGroup\n     * @param chart\n     * @param bounds\n     * @param textOption\n     * @param legendGroup\n     * @param chart\n     * @param bounds\n     * @param textOption\n     * @param legendGroup\n     * @param chart\n     * @param bounds\n     * @param textOption\n     * @param legendGroup\n     */\n    // tslint:disable-next-line:max-func-body-length\n    BaseLegend.prototype.renderPagingElements = function (chart, bounds, textOption, legendGroup) {\n        var paginggroup = chart.renderer.createGroup({ id: this.legendID + '_navigation' });\n        var isCanvas = this.isStockChartControl ? false : chart.enableCanvas;\n        var titleHeight = this.isBulletChartControl ? 0 : this.legendTitleSize.height;\n        var grayColor = this.chart.theme.indexOf('Dark') > -1 ? '#FFFFFF' : '#545454';\n        var legend = chart.legendSettings; // to solve parameter lint error, legend declaration is here\n        var padding = 8; // const padding for paging elements\n        var pageUp = this.legendID + (!this.isRtlEnable ? '_pageup' : '_pagedown');\n        var pageDown = this.legendID + (!this.isRtlEnable ? '_pagedown' : '_pageup');\n        var symbolOption = new PathOption(pageUp, 'transparent', 5, grayColor, 1, '', '');\n        var iconSize = this.pageButtonSize;\n        // Page left arrow drawing calculation started here\n        var rowCount = !legend.enablePages && this.isPaging && !this.isVertical && !this.isBulletChartControl ? 1 :\n            (this.rowCount - 1);\n        var titleWidth = this.isTitle && legend.titlePosition === 'Left' ? this.legendTitleSize.width : 0;\n        this.pagingRegions = [];\n        this.backwardArrowOpacity = this.currentPage !== 1 ? 1 : 0;\n        this.forwardArrowOpacity = this.currentPage === this.totalPages ? 0 : 1;\n        if (!isCanvas) {\n            legendGroup.appendChild(paginggroup);\n        }\n        if (this.isChartControl || this.isBulletChartControl || this.isStockChartControl || !this.isVertical) {\n            this.totalPages = Math.ceil(this.totalPages / Math.max(1, this.rowCount - 1));\n        }\n        else {\n            this.totalPages = Math.ceil(this.totalPages / this.maxColumns);\n        }\n        if (paginggroup) {\n            paginggroup.setAttribute('style', 'cursor: pointer');\n        }\n        this.clipPathHeight = rowCount * (this.maxItemHeight + legend.padding);\n        if (!isCanvas) {\n            this.clipRect.setAttribute('height', this.clipPathHeight.toString());\n        }\n        else {\n            //paging clipRect only for canvas mode\n            this.pagingClipRect.height = this.legendBounds.height - this.clipPathHeight -\n                (this.pagingClipRect.y - this.legendBounds.y) - legend.border.width;\n            this.pagingClipRect.y = this.pagingClipRect.y + this.clipPathHeight;\n            this.pagingClipRect.x += legend.border.width;\n            this.pagingClipRect.width -= (legend.border.width + legend.border.width / 2);\n            this.chart.renderer.clearRect(new Rect(this.pagingClipRect.x, this.pagingClipRect.y, this.pagingClipRect.width, this.pagingClipRect.height));\n        }\n        var pageTextElement;\n        var x = (bounds.x + iconSize / 2);\n        var y = bounds.y + this.clipPathHeight + ((titleHeight + bounds.height - this.clipPathHeight) / 2);\n        if (this.isPaging && !legend.enablePages && !this.isVertical && !this.isBulletChartControl) {\n            x = (bounds.x + this.fivePixel + this.pageButtonSize + titleWidth);\n            y = legend.title && this.isTop ? (bounds.y + padding + titleHeight + (iconSize / 1) + 0.5) :\n                (bounds.y + padding + iconSize + 0.5);\n        }\n        var size = measureText(this.totalPages + '/' + this.totalPages, legend.textStyle);\n        var translateX = (this.isRtlEnable) ? legend.border.width + (iconSize / 2) : bounds.width - (2 * (iconSize + padding) + padding + size.width);\n        if (!isCanvas) {\n            if (this.isVertical && !legend.enablePages && !this.isBulletChartControl) {\n                x = bounds.x + (bounds.width / 2);\n                y = bounds.y + (iconSize / 2) + padding + titleHeight;\n                symbolOption.opacity = this.backwardArrowOpacity;\n                paginggroup.appendChild(drawSymbol({ x: x, y: y }, 'UpArrow', new Size(iconSize, iconSize), '', symbolOption, 'UpArrow'));\n            }\n            else {\n                symbolOption.opacity = this.isBulletChartControl ? symbolOption.opacity :\n                    (legend.enablePages ? 1 : !this.isRtlEnable ? this.backwardArrowOpacity : this.forwardArrowOpacity);\n                paginggroup.appendChild(drawSymbol({ x: x, y: y }, 'LeftArrow', new Size(iconSize, iconSize), '', symbolOption, 'LeftArrow'));\n            }\n        }\n        else {\n            drawSymbol({ x: x, y: y }, 'LeftArrow', new Size(iconSize, iconSize), '', symbolOption, 'LeftArrow', this.chart.renderer, new Rect(translateX, 0, 0, 0));\n        }\n        this.pagingRegions.push(new Rect(!this.isRtlEnable ? x + bounds.width - (2 * (iconSize + padding) + padding + size.width) - iconSize * 0.5 : x, y - iconSize * 0.5, iconSize, iconSize));\n        // Page numbering rendering calculation started here\n        textOption.x = x + (iconSize / 2) + padding;\n        textOption.y = y + (size.height / 4);\n        textOption.id = this.legendID + '_pagenumber';\n        textOption.text = !this.isRtlEnable ? '1/' + this.totalPages : this.totalPages + '/1';\n        var color = this.chart.theme.indexOf('Dark') > -1 ? '#FFFFFF' : legend.textStyle.color;\n        if (isCanvas && this.totalNoOfPages) {\n            textOption.text = !this.isRtlEnable ? this.currentPageNumber + '/' + this.totalNoOfPages : this.totalNoOfPages + '/' + this.currentPageNumber;\n        }\n        if (legend.enablePages || this.isBulletChartControl) {\n            pageTextElement = textElement(chart.renderer, textOption, legend.textStyle, color, paginggroup, false, false, false, false, null, new Rect(translateX, 0, 0, 0));\n        }\n        // Page right arrow rendering calculation started here\n        x = textOption.x + padding + (iconSize / 2) + size.width;\n        if (this.isPaging && !legend.enablePages && !this.isVertical) {\n            x = (bounds.x + bounds.width - this.fivePixel - this.pageButtonSize - (legend.title && legend.titlePosition === 'Right' ?\n                this.legendTitleSize.width + this.fivePixel : 0));\n        }\n        symbolOption.id = pageDown;\n        symbolOption.opacity = !legend.enablePages ? !this.isRtlEnable ? this.forwardArrowOpacity : this.backwardArrowOpacity : 1;\n        if (!isCanvas) {\n            if (this.isVertical && !legend.enablePages && !this.isBulletChartControl) {\n                x = bounds.x + (bounds.width / 2);\n                y = bounds.y + bounds.height - (iconSize / 2) - padding;\n                paginggroup.appendChild(drawSymbol({ x: x, y: y }, 'DownArrow', new Size(iconSize, iconSize), '', symbolOption, 'DownArrow'));\n            }\n            else {\n                paginggroup.appendChild(drawSymbol({ x: x, y: y }, 'RightArrow', new Size(iconSize, iconSize), '', symbolOption, 'RightArrow'));\n            }\n        }\n        else {\n            drawSymbol({ x: x, y: y }, 'RightArrow', new Size(iconSize, iconSize), '', symbolOption, 'RightArrow', this.chart.renderer, new Rect(translateX, 0, 0, 0));\n        }\n        this.pagingRegions.push(new Rect(!this.isRtlEnable ? x + (bounds.width - (2 * (iconSize + padding) + padding + size.width) - iconSize * 0.5) : x, y - iconSize * 0.5, iconSize, iconSize));\n        if (!isCanvas && (legend.enablePages || this.isBulletChartControl)) {\n            //placing the navigation buttons and page numbering in legend right corner\n            paginggroup.setAttribute('transform', 'translate(' + translateX + ', ' + 0 + ')');\n        }\n        else {\n            if (this.currentPageNumber === 1 && this.calTotalPage && (legend.enablePages || this.isBulletChartControl)) {\n                this.totalNoOfPages = this.totalPages;\n                this.calTotalPage = false;\n            }\n            if (!legend.enablePages && !this.isBulletChartControl) { // For new legend page navigation\n                this.translatePage(null, this.currentPage - 1, this.currentPage, legend);\n            }\n        }\n        if (legend.enablePages || this.isBulletChartControl) {\n            this.translatePage(pageTextElement, this.currentPage - 1, this.currentPage, legend);\n        }\n    };\n    /**\n     * To translate legend pages for chart and accumulation chart\n     *\n     * @param pagingText\n     * @param page\n     * @param pageNumber\n     * @param legend\n     * @param pagingText\n     * @param page\n     * @param pageNumber\n     * @param legend\n     * @param pagingText\n     * @param page\n     * @param pageNumber\n     * @param legend\n     * @param pagingText\n     * @param page\n     * @param pageNumber\n     * @param legend\n     */\n    BaseLegend.prototype.translatePage = function (pagingText, page, pageNumber, legend) {\n        var size = (this.clipPathHeight) * page;\n        var translate = 'translate(0,-' + size + ')';\n        if (!this.isChartControl && !this.isBulletChartControl && !this.isStockChartControl && this.isVertical) {\n            var pageX = this.pageXCollections[page * this.maxColumns];\n            size = (!this.isRtlEnable) ? pageX - this.legendBounds.x : (this.legendBounds.x + this.maxWidth) - pageX;\n            size = size < 0 ? 0 : size; // to avoid small pixel variation\n            translate = ((!this.isRtlEnable) ? 'translate(-' : 'translate(') + size + ',0)';\n        }\n        if (!this.chart.enableCanvas) {\n            this.legendTranslateGroup.setAttribute('transform', translate);\n        }\n        if (!this.chart.enableCanvas && (legend.enablePages || this.isBulletChartControl)) {\n            pagingText.textContent = !this.isRtlEnable ? (pageNumber) + '/' + this.totalPages : this.totalPages + '/' + pageNumber;\n        }\n        this.currentPage = pageNumber;\n        return size;\n    };\n    /**\n     * To change legend pages for chart and accumulation chart\n     *\n     * @param event\n     * @param pageUp\n     * @param event\n     * @param pageUp\n     */\n    BaseLegend.prototype.changePage = function (event, pageUp) {\n        var legend = this.chart.legendSettings;\n        var backwardArrow = document.getElementById(this.legendID + '_pageup');\n        var forwardArrow = document.getElementById(this.legendID + '_pagedown');\n        var pageText = (legend.enablePages || this.isBulletChartControl) ?\n            document.getElementById(this.legendID + '_pagenumber') : null;\n        var page = (legend.enablePages || this.isBulletChartControl) ? parseInt(pageText.textContent.split('/')[!this.isRtlEnable ? 0 : 1], 10) :\n            this.currentPage;\n        if (pageUp && page > 1) {\n            this.translatePage(pageText, (page - 2), (page - 1), legend);\n        }\n        else if (!pageUp && page < this.totalPages) {\n            this.translatePage(pageText, page, (page + 1), legend);\n        }\n        if (this.isPaging && !legend.enablePages && !this.isBulletChartControl) {\n            // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n            this.currentPage === this.totalPages ? this.hideArrow(forwardArrow) : this.showArrow(forwardArrow);\n            // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n            this.currentPage === 1 ? this.hideArrow(backwardArrow) : this.showArrow(backwardArrow);\n        }\n    };\n    /**\n     * To hide the backward and forward arrow\n     *\n     * @param arrowElement\n     */\n    BaseLegend.prototype.hideArrow = function (arrowElement) {\n        arrowElement.setAttribute('opacity', '0');\n    };\n    /**\n     * To show the  backward and forward arrow\n     *\n     * @param arrowElement\n     */\n    BaseLegend.prototype.showArrow = function (arrowElement) {\n        arrowElement.setAttribute('opacity', '1');\n    };\n    /**\n     * To find legend elements id based on chart or accumulation chart\n     *\n     * @param option\n     * @param prefix\n     * @param count\n     * @param option\n     * @param prefix\n     * @param count\n     * @param option\n     * @param prefix\n     * @param count\n     * @private\n     */\n    BaseLegend.prototype.generateId = function (option, prefix, count) {\n        if (this.isChartControl || this.isStockChartControl) {\n            return prefix + count;\n        }\n        else {\n            return prefix + option.pointIndex;\n        }\n    };\n    /**\n     * To show or hide trimmed text tooltip for legend.\n     *\n     * @param event\n     * @returns {void}\n     * @private\n     */\n    BaseLegend.prototype.move = function (event) {\n        var _this = this;\n        var x = this.chart.mouseX;\n        var y = this.chart.mouseY;\n        if (event.target.textContent.indexOf('...') > -1) {\n            var targetId = event.target.id.split(this.legendID + '_text_');\n            if (targetId.length === 2) {\n                var index = parseInt(targetId[1], 10);\n                var element = this.chart.element;\n                if (!isNaN(index)) {\n                    if (this.chart.isTouch) {\n                        removeElement(this.chart.element.id + '_EJ2_Legend_Tooltip');\n                    }\n                    if (this.isChartControl) {\n                        showTooltip(this.chart.series[index].name, x, y, element.offsetWidth, element.id + '_EJ2_Legend_Tooltip', getElement(this.chart.element.id + '_Secondary_Element'));\n                    }\n                    else {\n                        showTooltip(this.chart.visibleSeries[0].points[index].x.toString(), x + 10, y + 10, element.offsetWidth, element.id + '_EJ2_Legend_Tooltip', getElement(this.chart.element.id + '_Secondary_Element'));\n                    }\n                }\n            }\n        }\n        else {\n            removeElement(this.chart.element.id + '_EJ2_Legend_Tooltip');\n        }\n        if (this.chart.isTouch) {\n            clearTimeout(this.clearTooltip);\n            this.clearTooltip = +setTimeout(function () { removeElement(_this.chart.element.id + '_EJ2_Legend_Tooltip'); }, 1000);\n        }\n    };\n    return BaseLegend;\n}());\nexport { BaseLegend };\n/**\n * Class for legend options\n *\n * @private\n */\nvar LegendOptions = /** @class */ (function () {\n    function LegendOptions(text, fill, shape, visible, type, url, markerShape, markerVisibility, pointIndex, seriesIndex) {\n        this.location = { x: 0, y: 0 };\n        this.text = text;\n        this.fill = fill;\n        this.shape = shape;\n        this.url = url;\n        this.visible = visible;\n        this.type = type;\n        this.markerVisibility = markerVisibility;\n        this.markerShape = markerShape;\n        this.pointIndex = pointIndex;\n        this.seriesIndex = seriesIndex;\n    }\n    return LegendOptions;\n}());\nexport { LegendOptions };\n"]},"metadata":{},"sourceType":"module"}